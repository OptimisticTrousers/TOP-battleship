(()=>{var e={653:(e,t,o)=>{const r=o(585);e.exports=()=>{const e={hasBeenHit:!1,isShip:!1,offLimits:!1},t=()=>{const t=Array(10).fill().map((()=>Array(10).fill()));for(let o=0;o<10;o++)for(let r=0;r<10;r++)t[o][r]={...e,column:o,row:r};return t};let o=t();const i=[r(5,"Carrier"),r(4,"Battleship"),r(3,"Destroyer"),r(3,"Submarine"),r(2,"Patrol Boat")],n=(e,t)=>o?.[e]?.[t],a=(t,r,i=(()=>Object.assign(e,{offLimits:!0}))())=>{if(void 0===o?.[t]?.[r])return!0;const n=o[t][r];return o[t][r]={...n,...i},!0},l=(e,t)=>{a(e-1,t-1),a(e,t-1)},c=(e,t,o,r)=>{if("vertical"===o)for(let o=0;o<r;o++){const r=n(e,t+o);if(r&&!0===r.isShip&&!0===r.offLimits)return!1}if("horizontal"===o)for(let o=0;o<r;o++){const r=n(e+o,t);if(r&&!0===r.isShip&&!0===r.offLimits)return!1}return!1},s=(e,t,r,i)=>{const s=i.getLength();if(c(n(e,t)))return!1;if("vertical"===r){if(((e,t)=>e>=0&&e+t-1<o.length)(t,s)){for(let o=0;o<s;o+=1)a(e,t+o,{...i,position:o}),a(e+1,t+o),a(e-1,t+o);return((e,t,o)=>{l(e,t),a(e,t+o),a(e+1,t+o),a(e-1,t+o),a(e+1,t-1)})(e,t,s),!0}}else if("horizontal"===r&&((e,t)=>e>=0&&e+t-1<o.length)(e,s)){for(let o=0;o<s;o+=1)a(e+o,t,{...i,position:o}),a(e+o,t+1),a(e+o,t-1);return((e,t,o)=>{l(e,t),a(e+o,t),a(e-1,t+1),a(e+o,t+1),a(e+o,t-1)})(e,t,s),!0}return!1},h=()=>{const e=0===Math.floor(2*Math.random())?"vertical":"horizontal",t=Math.floor(100*Math.random()),r=(()=>{const e=[...o.flat()];return e.forEach((e=>{!0===e.hasBeenHit?e.availability=!1:e.availability=!0})),e})()[t];return!1===r.availability?h():{elementColumn:r.column,elementRow:r.row,randomDirection:e}};return{clearBoard:()=>{o=t()},checkIfLocationIsAShipOrOffLimits:c,checkIfOffLimitZoneWasCorrectlyImplemented:e=>o.flat().filter((e=>!0===e.offLimits)).length===e+2,getLocation:n,receiveAttack:(e,t)=>{o[e][t].hasBeenHit=!0},checkIfAllShipsHaveSunk:()=>{let e=!0;for(let t=0;t<10;t++)for(let o=0;o<10;o++){const r=n(t,o);if(!1!==r.isShip&&r.isShip&&!1===r.isSunk()){e=!1;break}}return e},placeShip:s,randomlyPlaceShips:()=>{const e=[];for(let t=0;t<i.length;t+=1){const o=i[t],{randomColumn:r,randomRow:n,randomDirection:a}=h(o.getLength());s(r,n,a,o)?e.push({randomColumn:r,randomRow:n,randomDirection:a}):t-=1}return e},makeRandomCoordinates:h}}},61:e=>{e.exports=(e="player")=>({getName:()=>e,attack:(e,t,{getLocation:o,receiveAttack:r})=>{const i=o(e,t);return!1===i.hasBeenHit||i.isShip&&!1===i.getStatus().includes("unhit")?(r(e,t),i.hit?(i.hit(i.position),"You hit a ship!"):"It's a hit!"):"You have already hit this spot!"}})},585:e=>{e.exports=(e,t="ship")=>{const o=Array(e).fill("unhit");return{getName:()=>t,getLength:()=>o.length,isSunk:()=>o.every((e=>"hit"===e)),hit:t=>{t<e&&(o[t]="hit")},getStatus:()=>o,hasBeenHit:!1,offLimits:!0,isShip:!0}}}},t={};function o(r){var i=t[r];if(void 0!==i)return i.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,o),n.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=o(653),t=o.n(e),r=o(585),i=o.n(r);const n=(e,t,o,r)=>{const i=document.querySelector(`.${e}-board > .cell[column='${t}'][row='${o}']`);r.getLocation(t,o).isShip?i.classList.add("hit"):i.classList.add("miss")},a=(e,t,o,r)=>r.attack(e,t,o),l=(e,t,o)=>{const r=((e,t,o)=>{const r=o.getLocation(e+1,t),i=o.getLocation(e-1,t),n=o.getLocation(e,t+1),a=o.getLocation(e,t-1),l=[];return r&&!r.hasBeenHit&&l.push(r),i&&!i.hasBeenHit&&l.push(i),n&&!n.hasBeenHit&&l.push(n),a&&!a.hasBeenHit&&l.push(a),l})(e,t,o),i=Math.floor(Math.random()*r.length);return r[i]?r[i]:l(e,t,o)},c=(e,t,o)=>{const r={location(){return o.getLocation(this.column,this.row)}},i=Object.assign(Object.create(r),{column:e,row:t-1}),n=Object.assign(Object.create(r),{column:e,row:t+1}),a=Object.assign(Object.create(r),{column:e+1,row:t}),l=Object.assign(Object.create(r),{column:e-1,row:t}),c=[];return c.push(i),c.push(n),c.push(a),c.push(l),c},s=(e,t,o,r,i)=>{const h=e.getLocation(o,r);if("You hit a ship!"===a(o,r,e,t)){const n=l(o,r,e),a=n.column,u=c(o,r,e).filter((e=>void 0!==e.column&&void 0!==e.row)),p=n.row;if(h.isShip&&!1===h.isSunk())switch(Math.floor(Math.random()*u.length)){case 0:s(e,t,u[0].column,u[0].row,h);break;case 1:s(e,t,u[1].column,u[1].row,h);break;case 2:s(e,t,u[2].column,u[2].row,h);break;case 3:s(e,t,u[3].column,u[3].row,h)}setTimeout((()=>{s(e,t,a,p,i)}),700)}else if(h&&!1===h.isShip&&i&&!0===i.isShip){let n,a;i.getLength(),i.column>o&&(a=i.column-(i.column-o)),i.column<o&&(a=i.column+(o-i.column)),i.row>r&&(n=i.row-(i.row-r)),i.row<r&&(n=i.row+(r-i.row)),setTimeout((()=>{!1===i.isSunk()&&s(e,t,a,n,i)}),700)}setTimeout((()=>{n("player",o,r,e)}),700)},h=({getLocation:e})=>{const t=document.querySelector("div.player-board");for(let o=0;o<10;o+=1)for(let r=0;r<10;r+=1){const i=t.querySelector(`.cell:nth-child(${10*r+o+1})`);i.setAttribute("column",o),i.setAttribute("row",r);const n=e(o,r);n.isShip&&(i.classList.add("ship"),i.setAttribute("ship-name",n.getName()))}},u=e=>{switch(e.clearBoard(),document.querySelectorAll(".player-board > .cell").forEach((e=>{e.classList.remove("ship"),e.classList.remove("hit"),e.classList.remove("miss")})),Math.floor(4*Math.random())){case 0:e.placeShip(9,1,"vertical",i()(5)),e.placeShip(0,3,"horizontal",i()(3)),e.placeShip(3,6,"horizontal",i()(2)),e.placeShip(6,5,"horizontal",i()(3)),e.placeShip(3,9,"horizontal",i()(4));break;case 1:e.placeShip(0,2,"horizontal",i()(5)),e.placeShip(4,5,"horizontal",i()(3)),e.placeShip(8,7,"horizontal",i()(2)),e.placeShip(5,9,"horizontal",i()(3)),e.placeShip(6,3,"horizontal",i()(4));break;case 2:e.placeShip(5,1,"horizontal",i()(5)),e.placeShip(3,3,"vertical",i()(3)),e.placeShip(0,0,"vertical",i()(2)),e.placeShip(6,5,"horizontal",i()(3)),e.placeShip(5,9,"horizontal",i()(4));break;default:e.placeShip(0,0,"horizontal",i()(5)),e.placeShip(3,4,"horizontal",i()(3)),e.placeShip(6,7,"horizontal",i()(2)),e.placeShip(9,1,"vertical",i()(3)),e.placeShip(5,9,"horizontal",i()(4))}h(e)};var p=o(61),m=o.n(p);const d=t()(),f=t()(),S=m()(),y=m()();document.querySelector("button.randomize").addEventListener("click",(()=>{u(d)})),u(d),f.placeShip(0,0,"horizontal",i()(5)),f.placeShip(3,4,"horizontal",i()(3)),f.placeShip(6,7,"horizontal",i()(2)),f.placeShip(9,1,"vertical",i()(3)),f.placeShip(5,9,"horizontal",i()(4));const b=(()=>{const e={};return{publish:function(t,o){Array.isArray(e[t])&&e[t].forEach((e=>{e(o)}))},subscribe:function t(o,r){Array.isArray(t[o])||(e[o]=[]),e[o].push(r);const i=e[o].length-1;return{unsubscribe(){e[o].splice(i,1)}}}}})();((e,t,o,r,i)=>{const n=document.querySelector("div.enemy-board");for(let a=0;a<10;a+=1)for(let l=0;l<10;l+=1){const c=n.querySelector(`.cell:nth-child(${10*l+a+1})`);c.setAttribute("column",a),c.setAttribute("row",l),c.addEventListener("click",(()=>{i.publish("click",{cell:c,column:a,row:l,playerBoard:e,enemyBoard:t,player:o,enemy:r})}),{once:!0})}})(d,f,S,y,b),b.subscribe("click",(({cell:e,column:t,row:o,playerBoard:r,enemyBoard:i,player:l,enemy:c})=>{((e,t,o,r)=>{a(e,t,o,r),n("enemy",e,t,o)})(t,o,i,l);const{elementColumn:h,elementRow:u}=r.makeRandomCoordinates();s(r,c,h,u),((e,t)=>{if(e.checkIfAllShipsHaveSunk()){const e=document.querySelector(".modal"),t=document.querySelector(".modal-content > p"),o=document.querySelector(".modal-content > button");e.style.display="block",o.addEventListener("click",(()=>{location.reload()})),t.textContent="You lose!"}if(t.checkIfAllShipsHaveSunk()){const e=document.querySelector(".modal"),t=document.querySelector(".modal-content > p"),o=document.querySelector(".modal-content > button");e.style.display="block",t.textContent="You win!",o.addEventListener("click",(()=>{location.reload()}))}})(r,i)})),h(d)})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNQyxRQUFVLFFBQ3RCRixFQUFnQm5CLGlCQUFpQixTQUFTLEtBQ3RDbEgsU0FBU3dJLFlBR2JKLEVBQVlLLFlBQWMsWUFFOUIsR0FBSWpFLEVBQVd4QywwQkFBMkIsQ0FDdEMsTUFBTW1HLEVBQVF6RCxTQUFTQyxjQUFjLFVBQy9CeUQsRUFBYzFELFNBQVNDLGNBQWMsc0JBQ3JDMEQsRUFBa0IzRCxTQUFTQyxjQUM3QiwyQkFHSndELEVBQU1HLE1BQU1DLFFBQVUsUUFDdEJILEVBQVlLLFlBQWMsV0FDMUJKLEVBQWdCbkIsaUJBQWlCLFNBQVMsS0FDdENsSCxTQUFTd0ksY0FrSGpCRSxDQUFnQjFELEVBQWFSLE1DM2NqQ21DLEVBQWtCM0IsSSIsInNvdXJjZXMiOlsid2VicGFjazovL3RvcC1iYXR0bGVzaGlwLy4vc3JjL2dhbWVib2FyZC9nYW1lYm9hcmQuanMiLCJ3ZWJwYWNrOi8vdG9wLWJhdHRsZXNoaXAvLi9zcmMvcGxheWVyL3BsYXllci5qcyIsIndlYnBhY2s6Ly90b3AtYmF0dGxlc2hpcC8uL3NyYy9zaGlwL3NoaXAuanMiLCJ3ZWJwYWNrOi8vdG9wLWJhdHRsZXNoaXAvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vdG9wLWJhdHRsZXNoaXAvd2VicGFjay9ydW50aW1lL2NvbXBhdCBnZXQgZGVmYXVsdCBleHBvcnQiLCJ3ZWJwYWNrOi8vdG9wLWJhdHRsZXNoaXAvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3RvcC1iYXR0bGVzaGlwL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vdG9wLWJhdHRsZXNoaXAvLi9zcmMvZG9tLmpzIiwid2VicGFjazovL3RvcC1iYXR0bGVzaGlwLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIlxuLyogZXNsaW50LWRpc2FibGUgbm8tbXVsdGktYXNzaWduICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby11bnVzZWQtZXhwcmVzc2lvbnMgKi9cbmNvbnN0IGNyZWF0ZVNoaXAgPSByZXF1aXJlKCcuLi9zaGlwL3NoaXAnKVxuXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1wYXJhbS1yZWFzc2lnbiAqL1xuY29uc3QgY3JlYXRlR2FtZUJvYXJkID0gKCkgPT4ge1xuICAgIGNvbnN0IGVtcHR5Q2VsbCA9IHsgaGFzQmVlbkhpdDogZmFsc2UsIGlzU2hpcDogZmFsc2UsIG9mZkxpbWl0czogZmFsc2UgfVxuICAgIFxuICAgIGNvbnN0IGluaXRpYWxpemVCb2FyZCA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgZ2FtZUJvYXJkID0gQXJyYXkoMTApLmZpbGwoKS5tYXAoKCkgPT4gQXJyYXkoMTApLmZpbGwoKSlcbiAgICAgICAgZm9yKGxldCBjb2x1bW49IDA7IGNvbHVtbiA8IDEwOyBjb2x1bW4rKyl7XG4gICAgICAgICAgICBmb3IobGV0IHJvdz0gMDsgcm93IDwgMTA7IHJvdysrKXtcbiAgICAgICAgICAgICAgICBnYW1lQm9hcmRbY29sdW1uXVtyb3ddID0gey4uLmVtcHR5Q2VsbCwgY29sdW1uLCByb3d9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGdhbWVCb2FyZFxuICAgIFxuICAgIH1cblxuICAgIGxldCBnYW1lQm9hcmQgPSBpbml0aWFsaXplQm9hcmQoKVxuXG4gICAgY29uc3Qgc2hpcHMgPSBbXG4gICAgICAgIGNyZWF0ZVNoaXAoNSwgJ0NhcnJpZXInKSxcbiAgICAgICAgY3JlYXRlU2hpcCg0LCAnQmF0dGxlc2hpcCcpLFxuICAgICAgICBjcmVhdGVTaGlwKDMsICdEZXN0cm95ZXInKSxcbiAgICAgICAgY3JlYXRlU2hpcCgzLCAnU3VibWFyaW5lJyksXG4gICAgICAgIGNyZWF0ZVNoaXAoMiwgJ1BhdHJvbCBCb2F0JyksXG4gICAgXVxuXG5cbiAgICBjb25zdCBjcmVhdGVPZmZMaW1pdExvY2F0aW9uID0gKCkgPT5cbiAgICAgICAgT2JqZWN0LmFzc2lnbihlbXB0eUNlbGwsIHsgb2ZmTGltaXRzOiB0cnVlIH0pXG5cbiAgICBjb25zdCBnZXRMb2NhdGlvbiA9IChjb2x1bW4sIHJvdykgPT4gZ2FtZUJvYXJkPy5bY29sdW1uXT8uW3Jvd11cblxuICAgIGNvbnN0IHNldExvY2F0aW9uID0gKGNvbHVtbiwgcm93LCBzaGlwID0gY3JlYXRlT2ZmTGltaXRMb2NhdGlvbigpKSA9PiB7XG4gICAgICAgIGlmIChnYW1lQm9hcmQ/Lltjb2x1bW5dPy5bcm93XSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdHJ1ZVxuICAgICAgICBjb25zdCBsb2NhdGlvbiA9IGdhbWVCb2FyZFtjb2x1bW5dW3Jvd11cblxuICAgICAgICBnYW1lQm9hcmRbY29sdW1uXVtyb3ddID0gey4uLmxvY2F0aW9uLCAuLi5zaGlwfVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgICBjb25zdCBjaGVja0lmQWxsU2hpcHNIYXZlU3VuayA9ICgpID0+IHtcblxuICAgICAgICBsZXQgaGF2ZUFsbFNoaXBzU3VuayA9dHJ1ZSAgXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDEwOyBqKyspIHtcbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSBnZXRMb2NhdGlvbihpLCBqKVxuICAgICAgICBpZihsb2NhdGlvbi5pc1NoaXAgPT09IGZhbHNlKSBjb250aW51ZVxuICAgICAgICBpZihsb2NhdGlvbi5pc1NoaXAgJiYgbG9jYXRpb24uaXNTdW5rKCkgPT09IGZhbHNlKXtcbiAgICAgICAgICAgaGF2ZUFsbFNoaXBzU3VuayA9IGZhbHNlIFxuICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaGF2ZUFsbFNoaXBzU3VuayBcbiAgICB9XG5cbiAgICBjb25zdCBhZGRPZmZMaW1pdEFyZWFGb3JTaGlwcyA9IChjb2x1bW4sIHJvdykgPT4ge1xuICAgICAgICAvLyB0b3AtbGVmdFxuICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gLSAxLCByb3cgLSAxKVxuICAgICAgICAvLyB0b3BcbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uLCByb3cgLSAxKVxuICAgIH1cblxuICAgIGNvbnN0IGFkZE9mZkxpbWl0QXJlYUZvckhvcml6b250YWxseVBvc2l0aW9uZWRTaGlwID0gKFxuICAgICAgICBjb2x1bW4sXG4gICAgICAgIHJvdyxcbiAgICAgICAgc2hpcExlbmd0aFxuICAgICkgPT4ge1xuICAgICAgICAvLyBwb3NpdGlvbnMgcmVsYXRpdmUgdG8gdGhlIHNoaXAgaXRzZWxmKGllLiBhIGhvcml6b250YWwgc2hpcCdzIGJvdHRvbSBpcyB0byB0aGUgcmlnaHQpXG5cbiAgICAgICAgYWRkT2ZmTGltaXRBcmVhRm9yU2hpcHMoY29sdW1uLCByb3cpXG4gICAgICAgIC8vIGJvdHRvbVxuICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gKyBzaGlwTGVuZ3RoLCByb3cpXG4gICAgICAgIC8vIGJvdHRvbS1sZWZ0XG4gICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiAtIDEsIHJvdyArIDEpXG4gICAgICAgIC8vIGJvdHRvbS1yaWdodFxuICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gKyBzaGlwTGVuZ3RoLCByb3cgKyAxKVxuICAgICAgICAvLyB0b3AtcmlnaHRcbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uICsgc2hpcExlbmd0aCwgcm93IC0gMSlcbiAgICB9XG5cbiAgICBjb25zdCBhZGRPZmZMaW1pdEFyZWFGb3JWZXJ0aWNhbGx5UG9zaXRpb25lZFNoaXAgPSAoXG4gICAgICAgIGNvbHVtbixcbiAgICAgICAgcm93LFxuICAgICAgICBzaGlwTGVuZ3RoXG4gICAgKSA9PiB7XG4gICAgICAgIC8vIHBvc2l0aW9ucyByZWxhdGl2ZSB0byBob3cgdGhlIHVzZXIgc2VlcyBpdChpZS4gYSB2ZXJ0aWNhbCBzaGlwJ3MgYm90dG9tIGlzIHRvIHRoZSBib3R0b20pXG5cbiAgICAgICAgYWRkT2ZmTGltaXRBcmVhRm9yU2hpcHMoY29sdW1uLCByb3cpXG4gICAgICAgIC8vIGJvdHRvbVxuICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4sIHJvdyArIHNoaXBMZW5ndGgpXG4gICAgICAgIC8vIGJvdHRvbS1yaWdodFxuICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gKyAxLCByb3cgKyBzaGlwTGVuZ3RoKVxuICAgICAgICAvLyBib3R0b20tbGVmdFxuICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gLSAxLCByb3cgKyBzaGlwTGVuZ3RoKVxuICAgICAgICAvLyB0b3AtcmlnaHRcbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uICsgMSwgcm93IC0gMSlcbiAgICB9XG5cbiAgICBjb25zdCBjaGVja0lmQ29sdW1uQ29vcmRpbmF0ZUlzVmFsaWQgPSAoY29sdW1uLCBzaGlwTGVuZ3RoKSA9PlxuICAgICAgICBjb2x1bW4gPj0gMCAmJiBjb2x1bW4gKyBzaGlwTGVuZ3RoIC0gMSA8IGdhbWVCb2FyZC5sZW5ndGhcblxuICAgIGNvbnN0IGNoZWNrSWZSb3dDb29yZGluYXRlSXNWYWxpZCA9IChyb3csIHNoaXBMZW5ndGgpID0+XG4gICAgICAgIHJvdyA+PSAwICYmIHJvdyArIHNoaXBMZW5ndGggLSAxIDwgZ2FtZUJvYXJkLmxlbmd0aFxuXG5cbiAgICBjb25zdCBjaGVja0lmTG9jYXRpb25Jc0FTaGlwT3JPZmZMaW1pdHMgPSAoXG4gICAgICAgIGNvbHVtbixcbiAgICAgICAgcm93LFxuICAgICAgICBkaXJlY3Rpb24sXG4gICAgICAgIHNoaXBMZW5ndGhcbiAgICApID0+IHtcbiAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gJ3ZlcnRpY2FsJykge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsb2NhdGlvbiA9IGdldExvY2F0aW9uKGNvbHVtbiwgcm93ICsgaSlcbiAgICAgICAgICAgICAgICBpZiAobG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uaXNTaGlwID09PSB0cnVlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5vZmZMaW1pdHMgPT09IHRydWVcbiAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkaXJlY3Rpb24gPT09ICdob3Jpem9udGFsJykge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsb2NhdGlvbiA9IGdldExvY2F0aW9uKGNvbHVtbiArIGksIHJvdylcbiAgICAgICAgICAgICAgICBpZiAobG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uaXNTaGlwID09PSB0cnVlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5vZmZMaW1pdHMgPT09IHRydWVcbiAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cblxuICAgIGNvbnN0IHBsYWNlU2hpcCA9IChjb2x1bW4sIHJvdywgZGlyZWN0aW9uLCBzaGlwKSA9PiB7XG4gICAgICAgIGNvbnN0IHNoaXBMZW5ndGggPSBzaGlwLmdldExlbmd0aCgpXG4gICAgICAgIGlmIChjaGVja0lmTG9jYXRpb25Jc0FTaGlwT3JPZmZMaW1pdHMoZ2V0TG9jYXRpb24oY29sdW1uLCByb3csIGRpcmVjdGlvbiwgc2hpcExlbmd0aCkpKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIGlmIChkaXJlY3Rpb24gPT09ICd2ZXJ0aWNhbCcpIHtcbiAgICAgICAgICAgIGlmIChjaGVja0lmUm93Q29vcmRpbmF0ZUlzVmFsaWQocm93LCBzaGlwTGVuZ3RoKSkge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcExlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiwgcm93ICsgaSwgey4uLnNoaXAsIHBvc2l0aW9uOiBpfSlcbiAgICAgICAgICAgICAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uICsgMSwgcm93ICsgaSlcbiAgICAgICAgICAgICAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uIC0gMSwgcm93ICsgaSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYWRkT2ZmTGltaXRBcmVhRm9yVmVydGljYWxseVBvc2l0aW9uZWRTaGlwKFxuICAgICAgICAgICAgICAgICAgICBjb2x1bW4sXG4gICAgICAgICAgICAgICAgICAgIHJvdyxcbiAgICAgICAgICAgICAgICAgICAgc2hpcExlbmd0aFxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ2hvcml6b250YWwnKSB7XG4gICAgICAgICAgICBpZiAoY2hlY2tJZkNvbHVtbkNvb3JkaW5hdGVJc1ZhbGlkKGNvbHVtbiwgc2hpcExlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBMZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gKyBpICwgcm93LCB7Li4uc2hpcCwgcG9zaXRpb246IGl9KVxuICAgICAgICAgICAgICAgICAgICAvL3NldExvY2F0aW9uKGNvbHVtbiArIGksIHJvdywgc2hpcClcbiAgICAgICAgICAgICAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uICsgaSwgcm93ICsgMSlcbiAgICAgICAgICAgICAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uICsgaSwgcm93IC0gMSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYWRkT2ZmTGltaXRBcmVhRm9ySG9yaXpvbnRhbGx5UG9zaXRpb25lZFNoaXAoXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbixcbiAgICAgICAgICAgICAgICAgICAgcm93LFxuICAgICAgICAgICAgICAgICAgICBzaGlwTGVuZ3RoXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICAgICAgICBjb25zdCBhdmFpbGFibGVTcGFjZXMgPSAoKSA9PntcblxuICAgICAgICBjb25zdCBmbGF0dGVuZWRHYW1lQm9hcmQgPSBbLi4uZ2FtZUJvYXJkLmZsYXQoKV1cblxuICAgICAgICAgICAgZmxhdHRlbmVkR2FtZUJvYXJkLmZvckVhY2goKGVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgICAgICBpZihlbGVtZW50Lmhhc0JlZW5IaXQgPT09IHRydWUpe1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmF2YWlsYWJpbGl0eSA9IGZhbHNlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYXZhaWxhYmlsaXR5ID10cnVlICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICByZXR1cm4gZmxhdHRlbmVkR2FtZUJvYXJkXG5cbiAgICAgICAgfVxuICAgIGNvbnN0IG1ha2VSYW5kb21Db29yZGluYXRlcyA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgcmFuZG9tRGlyZWN0aW9uID1cbiAgICAgICAgICAgIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIpID09PSAwID8gJ3ZlcnRpY2FsJyA6ICdob3Jpem9udGFsJ1xuICAgICAgICBjb25zdCByYW5kb21Mb2NhdGlvbiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMClcbiAgICAgICAgY29uc3QgZmxhdHRlbmVkR2FtZUJvYXJkID0gYXZhaWxhYmxlU3BhY2VzKClcblxuICAgICAgICBjb25zdCBsb2NhdGlvbiA9IGZsYXR0ZW5lZEdhbWVCb2FyZFtyYW5kb21Mb2NhdGlvbl1cblxuICAgICAgICBpZihsb2NhdGlvbi5hdmFpbGFiaWxpdHkgPT09IGZhbHNlKXtcbiAgICAgICAgICAgIHJldHVybiBtYWtlUmFuZG9tQ29vcmRpbmF0ZXMoKVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZWxlbWVudENvbHVtbiA9IGxvY2F0aW9uLmNvbHVtblxuICAgICAgICBjb25zdCBlbGVtZW50Um93ID0gbG9jYXRpb24ucm93XG5cblxuICAgICAgICByZXR1cm4geyBlbGVtZW50Q29sdW1uLCBlbGVtZW50Um93LCByYW5kb21EaXJlY3Rpb24gfVxuICAgIH1cblxuICAgIGNvbnN0IHJhbmRvbWx5UGxhY2VTaGlwcyA9ICgpID0+IHtcbiAgICAgICAgY29uc3Qgc2hpcERldGFpbHMgPSBbXVxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICBjb25zdCBzaGlwID0gc2hpcHNbaV1cbiAgICAgICAgICAgIGNvbnN0IHsgcmFuZG9tQ29sdW1uLCByYW5kb21Sb3csIHJhbmRvbURpcmVjdGlvbiB9ID1cbiAgICAgICAgICAgICAgICBtYWtlUmFuZG9tQ29vcmRpbmF0ZXMoc2hpcC5nZXRMZW5ndGgoKSlcbiAgICAgICAgICAgIGlmIChwbGFjZVNoaXAocmFuZG9tQ29sdW1uLCByYW5kb21Sb3csIHJhbmRvbURpcmVjdGlvbiwgc2hpcCkpIHtcbiAgICAgICAgICAgICAgICBzaGlwRGV0YWlscy5wdXNoKHsgcmFuZG9tQ29sdW1uLCByYW5kb21Sb3csIHJhbmRvbURpcmVjdGlvbiB9KVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpIC09IDFcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2hpcERldGFpbHNcbiAgICB9XG5cbiAgICBjb25zdCByZWNlaXZlQXR0YWNrID0gKGNvbHVtbiwgcm93KSA9PiB7XG4gICAgICAgIGdhbWVCb2FyZFtjb2x1bW5dW3Jvd10uaGFzQmVlbkhpdCA9IHRydWVcbiAgICB9XG5cbiAgICBjb25zdCBjaGVja0lmT2ZmTGltaXRab25lV2FzQ29ycmVjdGx5SW1wbGVtZW50ZWQgPSAoc2hpcExlbmd0aCkgPT5cbiAgICAgICAgZ2FtZUJvYXJkLmZsYXQoKS5maWx0ZXIoKGVsZW1lbnQpID0+IGVsZW1lbnQub2ZmTGltaXRzID09PSB0cnVlKVxuICAgICAgICAgICAgLmxlbmd0aCA9PT1cbiAgICAgICAgc2hpcExlbmd0aCArIDJcbiAgICAvLyBhZGRpbmcgc2hpcExlbmd0aCBwbHVzIHR3byBiZWNhdXNlIGZvciBldmVyeSBpbmNyZWFzZSBpbiB0aGUgc2l6ZSBvZiBzaGlwLCB0aGUgem9uZXMgY292ZXJlZCBpbmNyZWFzZSBieSAyIHVuaXRzXG5cbiAgICBjb25zdCBjbGVhckJvYXJkICA9ICgpID0+IHtcbiAgICAgICAgZ2FtZUJvYXJkID0gaW5pdGlhbGl6ZUJvYXJkKClcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBjbGVhckJvYXJkLFxuICAgICAgICBjaGVja0lmTG9jYXRpb25Jc0FTaGlwT3JPZmZMaW1pdHMsXG4gICAgICAgIGNoZWNrSWZPZmZMaW1pdFpvbmVXYXNDb3JyZWN0bHlJbXBsZW1lbnRlZCxcbiAgICAgICAgZ2V0TG9jYXRpb24sXG4gICAgICAgIHJlY2VpdmVBdHRhY2ssXG4gICAgICAgIGNoZWNrSWZBbGxTaGlwc0hhdmVTdW5rLFxuICAgICAgICBwbGFjZVNoaXAsXG4gICAgICAgIHJhbmRvbWx5UGxhY2VTaGlwcyxcbiAgICAgICAgbWFrZVJhbmRvbUNvb3JkaW5hdGVzLFxuICAgIH1cbn1cbm1vZHVsZS5leHBvcnRzID0gY3JlYXRlR2FtZUJvYXJkIiwiY29uc3QgY3JlYXRlUGxheWVyID0gKG5hbWUgPSAncGxheWVyJykgPT4ge1xuICAgIGNvbnN0IGdldE5hbWUgPSAoKSA9PiBuYW1lXG5cbiAgICBjb25zdCBhdHRhY2sgPSAoY29sdW1uLCByb3csIHsgZ2V0TG9jYXRpb24sIHJlY2VpdmVBdHRhY2sgfSkgPT4ge1xuICAgICAgICBjb25zdCBsb2NhdGlvbiA9IGdldExvY2F0aW9uKGNvbHVtbiwgcm93KVxuICAgICAgICBpZiAobG9jYXRpb24uaGFzQmVlbkhpdCA9PT0gZmFsc2UgfHwgKGxvY2F0aW9uLmlzU2hpcCAmJiBsb2NhdGlvbi5nZXRTdGF0dXMoKS5pbmNsdWRlcygndW5oaXQnKSA9PT0gZmFsc2UpKSB7XG4gICAgICAgICAgICByZWNlaXZlQXR0YWNrKGNvbHVtbiwgcm93KVxuICAgICAgICAgICAgaWYobG9jYXRpb24uaGl0KXtcblxuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhpdChsb2NhdGlvbi5wb3NpdGlvbilcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJZb3UgaGl0IGEgc2hpcCFcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFwiSXQncyBhIGhpdCFcIlxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuICdZb3UgaGF2ZSBhbHJlYWR5IGhpdCB0aGlzIHNwb3QhJ1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIGdldE5hbWUsXG4gICAgICAgIGF0dGFjayxcbiAgICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gY3JlYXRlUGxheWVyXG4iLCJjb25zdCBjcmVhdGVTaGlwID0gKGxlbmd0aCwgbmFtZSA9ICdzaGlwJykgPT4ge1xuXG4gICAgY29uc3Qgc3RhdHVzID0gQXJyYXkobGVuZ3RoKS5maWxsKCd1bmhpdCcpXG5cbiAgICBjb25zdCBnZXRMZW5ndGggPSAoKSA9PiBzdGF0dXMubGVuZ3RoXG5cbiAgICBjb25zdCBnZXRTdGF0dXMgPSAoKSA9PiBzdGF0dXNcblxuICAgIGNvbnN0IGhpdCA9IChwb3NpdGlvbikgPT4ge1xuICAgICAgICBpZiAocG9zaXRpb24gPCBsZW5ndGgpIHtcbiAgICAgICAgICAgIHN0YXR1c1twb3NpdGlvbl0gPSAnaGl0J1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgZ2V0TmFtZSA9ICgpID0+ICBuYW1lXG5cbiAgICBjb25zdCBpc1N1bmsgPSAoKSA9PiBzdGF0dXMuZXZlcnkoKHBvc2l0aW9uKSA9PiBwb3NpdGlvbiA9PT0gJ2hpdCcpXG5cbiAgICByZXR1cm4ge1xuICAgICAgICBnZXROYW1lLFxuICAgICAgICBnZXRMZW5ndGgsXG4gICAgICAgIGlzU3VuayxcbiAgICAgICAgaGl0LFxuICAgICAgICBnZXRTdGF0dXMsXG4gICAgICAgIGhhc0JlZW5IaXQ6IGZhbHNlLFxuICAgICAgICBvZmZMaW1pdHM6IHRydWUsXG4gICAgICAgIGlzU2hpcDogdHJ1ZSxcbiAgICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gY3JlYXRlU2hpcFxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSAobW9kdWxlKSA9PiB7XG5cdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuXHRcdCgpID0+IChtb2R1bGVbJ2RlZmF1bHQnXSkgOlxuXHRcdCgpID0+IChtb2R1bGUpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCB7IGE6IGdldHRlciB9KTtcblx0cmV0dXJuIGdldHRlcjtcbn07IiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImltcG9ydCBjcmVhdGVHYW1lQm9hcmQgZnJvbSBcIi4vZ2FtZWJvYXJkL2dhbWVib2FyZFwiXG5pbXBvcnQgY3JlYXRlU2hpcCBmcm9tIFwiLi9zaGlwL3NoaXBcIlxuXG5jb25zdCByZW5kZXJBdHRhY2tzID0gKHBsYXllciwgY29sdW1uLCByb3csIGVuZW15Qm9hcmQpID0+IHtcbiAgICBjb25zdCBjZWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgYC4ke3BsYXllcn0tYm9hcmQgPiAuY2VsbFtjb2x1bW49JyR7Y29sdW1ufSddW3Jvdz0nJHtyb3d9J11gXG4gICAgKVxuXG4gICAgY29uc3QgbG9jYXRpb24gPSBlbmVteUJvYXJkLmdldExvY2F0aW9uKGNvbHVtbiwgcm93KVxuICAgIGlmIChsb2NhdGlvbi5pc1NoaXApIHtcbiAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdoaXQnKVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnbWlzcycpXG4gICAgfVxufVxuXG5jb25zdCBoYW5kbGVBdHRhY2sgPSAoY29sdW1uLCByb3csIGVuZW15Qm9hcmQsIHBsYXllcikgPT5cbiAgICBwbGF5ZXIuYXR0YWNrKGNvbHVtbiwgcm93LCBlbmVteUJvYXJkKVxuXG5jb25zdCBhdHRhY2tFbmVteUNlbGwgPSAoY29sdW1uLCByb3csIGVuZW15Qm9hcmQsIHBsYXllcikgPT4ge1xuICAgIGhhbmRsZUF0dGFjayhjb2x1bW4sIHJvdywgZW5lbXlCb2FyZCwgcGxheWVyKVxuICAgIHJlbmRlckF0dGFja3MoJ2VuZW15JywgY29sdW1uLCByb3csIGVuZW15Qm9hcmQpXG59XG5cbmNvbnN0IGlzU3BhY2VBcm91bmRIaXQgPSAoY29sdW1uLCByb3csIHBsYXllckJvYXJkKSA9PiB7XG5cbiAgICBjb25zdCBuZXh0Q29sdW1uID0gcGxheWVyQm9hcmQuZ2V0TG9jYXRpb24oY29sdW1uICsgMSwgcm93KVxuICAgIGNvbnN0IHByZXZpb3VzQ29sdW1uID0gcGxheWVyQm9hcmQuZ2V0TG9jYXRpb24oY29sdW1uIC0gMSwgcm93KVxuICAgIGNvbnN0IG5leHRSb3cgPSBwbGF5ZXJCb2FyZC5nZXRMb2NhdGlvbihjb2x1bW4sIHJvdyArIDEpXG4gICAgY29uc3QgcHJldmlvdXNSb3cgPSBwbGF5ZXJCb2FyZC5nZXRMb2NhdGlvbihjb2x1bW4sIHJvdyAtIDEpXG5cbiAgICBjb25zdCBzcGFjZXNIaXQgPSBbXVxuXG4gICAgaWYobmV4dENvbHVtbiAmJiAhbmV4dENvbHVtbi5oYXNCZWVuSGl0KXtcbiAgICAgICAgc3BhY2VzSGl0LnB1c2gobmV4dENvbHVtbilcbiAgICB9XG4gICAgaWYocHJldmlvdXNDb2x1bW4gJiYgIXByZXZpb3VzQ29sdW1uLmhhc0JlZW5IaXQpe1xuICAgICAgICBzcGFjZXNIaXQucHVzaChwcmV2aW91c0NvbHVtbilcbiAgICB9XG4gICAgaWYobmV4dFJvdyAmJiAhbmV4dFJvdy5oYXNCZWVuSGl0KXtcbiAgICAgICAgc3BhY2VzSGl0LnB1c2gobmV4dFJvdylcbiAgICB9XG4gICAgaWYocHJldmlvdXNSb3cgJiYgIXByZXZpb3VzUm93Lmhhc0JlZW5IaXQpe1xuICAgICAgICBzcGFjZXNIaXQucHVzaChwcmV2aW91c1JvdylcbiAgICB9XG5cbiAgICByZXR1cm4gc3BhY2VzSGl0XG5cbn1cblxuY29uc3QgcmFuZG9tRGlyZWN0aW9uQXR0YWNrID0gKGNvbHVtbiwgcm93LCBwbGF5ZXJCb2FyZCkgPT4ge1xuXG4gICAgY29uc3Qgc3BhY2VzSGl0ID0gaXNTcGFjZUFyb3VuZEhpdChjb2x1bW4sIHJvdywgcGxheWVyQm9hcmQpXG5cbiAgICBjb25zdCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHNwYWNlc0hpdC5sZW5ndGgpXG5cbiAgICBpZighc3BhY2VzSGl0W3JhbmRvbUluZGV4XSkgcmV0dXJuIHJhbmRvbURpcmVjdGlvbkF0dGFjayhjb2x1bW4sIHJvdyAsIHBsYXllckJvYXJkKVxuXG4gICAgcmV0dXJuIHNwYWNlc0hpdFtyYW5kb21JbmRleF1cbn1cblxuY29uc3QgaXNSYW5kb21Db2x1bW5HcmVhdGVyVGhhbkN1cnJlbnRDb2x1bW4gPSAoY29sdW1uLCByYW5kb21Db2x1bW4pID0+IFxuICAgIHJhbmRvbUNvbHVtbiA+IGNvbHVtblxuXG5jb25zdCBpc1JhbmRvbVJvd0dyZWF0ZXJUaGFuQ3VycmVudENvbHVtbiA9IChyb3csIHJhbmRvbVJvdykgPT4gXG4gICAgcmFuZG9tUm93ID4gcm93XG5cbmNvbnN0IGxpc3RPZlJhbmRvbUNvb3JkaW5hdGVzID0gKGNvbHVtbiwgcm93LCBwbGF5ZXJCb2FyZCkgPT4ge1xuXG4gICAgICAgIGNvbnN0IGxvY2F0aW9uUHJvdG90eXBlID0ge1xuICAgICAgICAgICAgbG9jYXRpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBsYXllckJvYXJkLmdldExvY2F0aW9uKHRoaXMuY29sdW1uLCB0aGlzLnJvdylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRvcCA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShsb2NhdGlvblByb3RvdHlwZSksIHtcbiAgICAgICAgICAgIGNvbHVtbixcbiAgICAgICAgICAgIHJvdzogcm93IC0gMSxcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgYm90dG9tID0gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKGxvY2F0aW9uUHJvdG90eXBlKSwge1xuICAgICAgICAgICAgY29sdW1uLFxuICAgICAgICAgICAgcm93OiByb3cgKyAxLFxuICAgICAgICB9KVxuICAgICAgICBjb25zdCByaWdodCA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShsb2NhdGlvblByb3RvdHlwZSksIHtcbiAgICAgICAgICAgIGNvbHVtbjogY29sdW1uICsgMSxcbiAgICAgICAgICAgIHJvdyxcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgbGVmdCA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShsb2NhdGlvblByb3RvdHlwZSksIHtcbiAgICAgICAgICAgIGNvbHVtbjogY29sdW1uIC0gMSxcbiAgICAgICAgICAgIHJvdyxcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgZGlyZWN0aW9ucyA9IFtdXG5cbiAgICAgICAgZGlyZWN0aW9ucy5wdXNoKHRvcClcbiAgICAgICAgZGlyZWN0aW9ucy5wdXNoKGJvdHRvbSlcbiAgICAgICAgZGlyZWN0aW9ucy5wdXNoKHJpZ2h0KVxuICAgICAgICBkaXJlY3Rpb25zLnB1c2gobGVmdClcblxuICAgICAgICByZXR1cm4gZGlyZWN0aW9uc1xufVxuXG5jb25zdCBjaGVja0lmUm93Q29udGFpbnNTaGlwID0gKGNvbHVtbiwgcGxheWVyQm9hcmQpID0+IHtcbiAgICBmb3IobGV0IHJvdyA9IDA7IHJvdyA8IDEwOyByb3crKyl7XG4gICAgICAgIGlmKHBsYXllckJvYXJkLmdldExvY2F0aW9uKGNvbHVtbiwgcm93KS5pc1NoaXApe1xuICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2Vcbn1cblxuY29uc3QgY2hlY2tJZkNvbHVtbkNvbnRhaW5zU2hpcCA9IChyb3csIHBsYXllckJvYXJkKSA9PiB7XG5cbiAgICBmb3IobGV0IGNvbHVtbiA9IDA7IGNvbHVtbiA8IDEwOyBjb2x1bW4rKyl7XG4gICAgICAgIGlmKHBsYXllckJvYXJkLmdldExvY2F0aW9uKGNvbHVtbiwgcm93KS5pc1NoaXApe1xuICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2Vcbn1cblxuY29uc3QgYXR0YWNrUGxheWVyQ2VsbCA9IChwbGF5ZXJCb2FyZCwgZW5lbXksIGVsZW1lbnRDb2x1bW4sIGVsZW1lbnRSb3csIHByZXZMb2NhdGlvbikgPT4ge1xuICAgICAgICBjb25zdCBsb2NhdGlvbiA9IHBsYXllckJvYXJkLmdldExvY2F0aW9uKGVsZW1lbnRDb2x1bW4sIGVsZW1lbnRSb3cpXG4gICAgaWYoaGFuZGxlQXR0YWNrKGVsZW1lbnRDb2x1bW4sIGVsZW1lbnRSb3csIHBsYXllckJvYXJkLCBlbmVteSkgPT09IFwiWW91IGhpdCBhIHNoaXAhXCIpe1xuICAgICAgICBcblxuICAgICAgICBjb25zdCByYW5kb21Qb3NpdGlvbiA9IHJhbmRvbURpcmVjdGlvbkF0dGFjayhlbGVtZW50Q29sdW1uLCBlbGVtZW50Um93LCBwbGF5ZXJCb2FyZClcbiAgICAgICAgY29uc3QgcmFuZG9tUG9zaXRpb25Db2x1bW4gPSByYW5kb21Qb3NpdGlvbi5jb2x1bW5cblxuICAgICAgICBjb25zdCBkaXJlY3Rpb25zID0gbGlzdE9mUmFuZG9tQ29vcmRpbmF0ZXMoZWxlbWVudENvbHVtbiwgZWxlbWVudFJvdywgcGxheWVyQm9hcmQpXG4gICAgICAgIGNvbnN0IGZpbHRlcmVkRGlyZWN0aW9ucyA9IGRpcmVjdGlvbnMuZmlsdGVyKChlbGVtZW50KSA9PiBlbGVtZW50LmNvbHVtbiAhPT0gdW5kZWZpbmVkICYmIGVsZW1lbnQucm93ICE9PSB1bmRlZmluZWQpXG4gICAgICAgIGNvbnN0IHJhbmRvbVBvc2l0aW9uUm93ID0gcmFuZG9tUG9zaXRpb24ucm93XG4gICAgICAgICAgICAgICAgaWYobG9jYXRpb24uaXNTaGlwICYmIGxvY2F0aW9uLmlzU3VuaygpID09PSBmYWxzZSl7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmFuZG9tID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZmlsdGVyZWREaXJlY3Rpb25zLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlZmF1bHQtY2FzZVxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2gocmFuZG9tKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0YWNrUGxheWVyQ2VsbChwbGF5ZXJCb2FyZCwgZW5lbXksIGZpbHRlcmVkRGlyZWN0aW9uc1swXS5jb2x1bW4sIGZpbHRlcmVkRGlyZWN0aW9uc1swXS5yb3csIGxvY2F0aW9uKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dGFja1BsYXllckNlbGwocGxheWVyQm9hcmQsIGVuZW15LCBmaWx0ZXJlZERpcmVjdGlvbnNbMV0uY29sdW1uLCBmaWx0ZXJlZERpcmVjdGlvbnNbMV0ucm93LCBsb2NhdGlvbilcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRhY2tQbGF5ZXJDZWxsKHBsYXllckJvYXJkLCBlbmVteSwgZmlsdGVyZWREaXJlY3Rpb25zWzJdLmNvbHVtbiwgZmlsdGVyZWREaXJlY3Rpb25zWzJdLnJvdywgbG9jYXRpb24pXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0YWNrUGxheWVyQ2VsbChwbGF5ZXJCb2FyZCwgZW5lbXksIGZpbHRlcmVkRGlyZWN0aW9uc1szXS5jb2x1bW4sIGZpbHRlcmVkRGlyZWN0aW9uc1szXS5yb3csIGxvY2F0aW9uKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICBhdHRhY2tQbGF5ZXJDZWxsKHBsYXllckJvYXJkLCBlbmVteSwgcmFuZG9tUG9zaXRpb25Db2x1bW4sIHJhbmRvbVBvc2l0aW9uUm93LCBwcmV2TG9jYXRpb24pXG4gICAgICAgIH0sIDcwMClcbiAgICB9XG4gICAgZWxzZSBpZihsb2NhdGlvbiYmIGxvY2F0aW9uLmlzU2hpcCA9PT0gZmFsc2UgJiYgcHJldkxvY2F0aW9uICYmIHByZXZMb2NhdGlvbi5pc1NoaXAgPT09IHRydWUpe1xuXG4gICAgICAgIGxldCBwcmV2TG9jYXRpb25Sb3c7XG4gICAgICAgIGxldCBwcmV2TG9jYXRpb25Db2x1bW47XG4gICAgICAgIGNvbnN0IHNoaXBMZW5ndGggPSBwcmV2TG9jYXRpb24uZ2V0TGVuZ3RoKClcbiAgICAgICAgaWYocHJldkxvY2F0aW9uLmNvbHVtbiA+IGVsZW1lbnRDb2x1bW4gKXtcbiAgICAgICAgcHJldkxvY2F0aW9uQ29sdW1uID0gcHJldkxvY2F0aW9uLmNvbHVtbiAtIChwcmV2TG9jYXRpb24uY29sdW1uIC0gZWxlbWVudENvbHVtbilcbiAgICAgICAgfVxuICAgICAgICBpZihwcmV2TG9jYXRpb24uY29sdW1uIDwgZWxlbWVudENvbHVtbil7XG4gICAgICAgIHByZXZMb2NhdGlvbkNvbHVtbiA9IHByZXZMb2NhdGlvbi5jb2x1bW4gKyAoZWxlbWVudENvbHVtbiAtIHByZXZMb2NhdGlvbi5jb2x1bW4pXG4gICAgICAgIH1cbiAgICAgICAgaWYocHJldkxvY2F0aW9uLnJvdyA+IGVsZW1lbnRSb3cpe1xuICAgICAgICBwcmV2TG9jYXRpb25Sb3cgPSBwcmV2TG9jYXRpb24ucm93IC0gIChwcmV2TG9jYXRpb24ucm93IC0gZWxlbWVudFJvdylcblxuICAgICAgICB9XG4gICAgICAgIGlmKHByZXZMb2NhdGlvbi5yb3cgPCBlbGVtZW50Um93KXtcbiAgICAgICAgcHJldkxvY2F0aW9uUm93ID0gcHJldkxvY2F0aW9uLnJvdyArIChlbGVtZW50Um93IC0gcHJldkxvY2F0aW9uLnJvdylcblxuICAgICAgICB9XG5cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG5cbiAgICAgICAgICAgIGlmKHByZXZMb2NhdGlvbi5pc1N1bmsoKSA9PT0gZmFsc2Upe1xuXG4gICAgICAgICAgICBhdHRhY2tQbGF5ZXJDZWxsKHBsYXllckJvYXJkLCBlbmVteSwgcHJldkxvY2F0aW9uQ29sdW1uLCBwcmV2TG9jYXRpb25Sb3csIHByZXZMb2NhdGlvbilcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSw3MDApXG4gICAgfVxuXG5cbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcblxuICAgIHJlbmRlckF0dGFja3MoJ3BsYXllcicsIGVsZW1lbnRDb2x1bW4sIGVsZW1lbnRSb3csIHBsYXllckJvYXJkLCBwcmV2TG9jYXRpb24pXG4gICAgfSwgNzAwKVxuXG59XG4vLyBodHRwczovL2pzbWFuaWZlc3QuY29tL3RoZS1wdWJsaXNoLXN1YnNjcmliZS1wYXR0ZXJuLWluLWphdmFzY3JpcHQvXG5cbmV4cG9ydCBjb25zdCBwdWJTdWIgPSAoKSA9PiB7XG4gICAgY29uc3Qgc3Vic2NyaWJlcnMgPSB7fVxuXG4gICAgZnVuY3Rpb24gcHVibGlzaChldmVudE5hbWUsIGRhdGEpIHtcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHN1YnNjcmliZXJzW2V2ZW50TmFtZV0pKSB7XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgICBzdWJzY3JpYmVyc1tldmVudE5hbWVdLmZvckVhY2goKGNhbGxiYWNrKSA9PiB7XG4gICAgICAgICAgICBjYWxsYmFjayhkYXRhKVxuICAgICAgICB9KVxuICAgIH1cbiAgICBmdW5jdGlvbiBzdWJzY3JpYmUoZXZlbnROYW1lLCBjYWxsYmFjaykge1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoc3Vic2NyaWJlW2V2ZW50TmFtZV0pKSB7XG4gICAgICAgICAgICBzdWJzY3JpYmVyc1tldmVudE5hbWVdID0gW11cbiAgICAgICAgfVxuICAgICAgICBzdWJzY3JpYmVyc1tldmVudE5hbWVdLnB1c2goY2FsbGJhY2spXG4gICAgICAgIGNvbnN0IGluZGV4ID0gc3Vic2NyaWJlcnNbZXZlbnROYW1lXS5sZW5ndGggLSAxXG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHVuc3Vic2NyaWJlKCkge1xuICAgICAgICAgICAgICAgIHN1YnNjcmliZXJzW2V2ZW50TmFtZV0uc3BsaWNlKGluZGV4LCAxKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIHB1Ymxpc2gsXG4gICAgICAgIHN1YnNjcmliZSxcbiAgICB9XG59XG5cbmNvbnN0IGNlbGxEcmFnTGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICBjb25zb2xlLmxvZyh0aGlzKVxufVxuXG4vL2NvbnN0IGFkZERyYWdnYWJsZVByb3BlcnRpZXMgPSAoKSA9PiB7XG5cbiAgICAvL2NvbnN0IGRyYWdnYWJsZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2VsbFtkcmFnZ2FibGU9XCJ0cnVlXCJdJylcbiAgICAvL2RyYWdnYWJsZXMuZm9yRWFjaChkcmFnZ2FibGUgPT4ge1xuICAgICAgICAvL2RyYWdnYWJsZS5hZGRFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCAoKSA9PiB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdib2Igam9uZXMnKVxuICAgICAgICAvL30pXG4gICAgLy99KVxuLy99XG5cbmZ1bmN0aW9uIGdldERyYWdBZnRlckVsZW1lbnQoY29udGFpbmVyLCB5LCB4KXtcbiAgICBjb25zdCBkcmFnZ2FibGVFbGVtZW50cyA9IFsuLi5jb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLmNlbGw6bm90KC5kcmFnZ2luZyknKV1cblxuICAgIHJldHVybiBkcmFnZ2FibGVFbGVtZW50cy5yZWR1Y2UoKGNsb3Nlc3QsIGNoaWxkKSA9PiB7XG4gICAgICAgIGNvbnN0IGJveCA9IGNoaWxkLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG4gICAgICAgIGNvbnN0IG9mZnNldFkgPSB5IC0gYm94LnRvcCAtIGJveC5oZWlnaHQgLyAyXG4gICAgICAgIGNvbnN0IG9mZnNldFggPSB4IC0gYm94LmxlZnQgLSBib3gud2lkdGgvIDJcbiAgICAgICAgY29uc29sZS5sb2coY2hpbGQpXG4gICAgICAgIGlmKG9mZnNldFkgPCAwICYmIG9mZnNldFkgPiBjbG9zZXN0Lm9mZnNldFkgJiYgb2Zmc2V0WCA8IDAgJiYgb2Zmc2V0WCA+IGNsb3Nlc3Qub2Zmc2V0WCl7XG4gICAgICAgICAgICByZXR1cm4ge29mZnNldFgsIG9mZnNldFksIGVsZW1lbnQ6Y2hpbGR9XG4gICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjbG9zZXN0XG5cbiAgICB9LCB7b2Zmc2V0WDogTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLCBvZmZzZXRZOk51bWJlci5ORUdBVElWRV9JTkZJTklUWX0pLmVsZW1lbnRcbn1cblxuY29uc3QgYWRkTGlzdGVuZXJUb0JvYXQgPSAoY2VsbHMpID0+IHtcblxuICAgIC8vVmlkZW8gZm9yIGRyYWcgYW5kIGRyb3A6IGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9amZZV3dRcnR6ellcblxuICAgIGNvbnN0IGNlbGxzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllci1ib2FyZCcpXG4gICAgY29uc3Qgc2hpcENvbnRhaW5lciAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgIGNlbGxzLmZvckVhY2goKGNlbGwsIGluZGV4KSA9PiB7XG4gICAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgKCkgPT4ge1xuICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdkcmFnZ2luZycpXG4gICAgICAgIH0pXG5cbiAgICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgKCkgPT4ge1xuICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QucmVtb3ZlKCdkcmFnZ2luZycpXG4gICAgICAgIH0pXG4gICAgfSlcblxuICAgIGNlbGxzQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdvdmVyJywgKGV2ZW50KSA9PiB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgbGV0IGFmdGVyRWxlbWVudDtcbiAgICAgICAgY29uc3QgZHJhZ2dhYmxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRyYWdnaW5nJylcbiAgICAgICAgY29uc29sZS5sb2coYWZ0ZXJFbGVtZW50KVxuICAgICAgICBpZihhZnRlckVsZW1lbnQgPT09IG51bGwpe1xuXG4gICAgICAgICAgICBjZWxsc0NvbnRhaW5lci5hcHBlbmRDaGlsZChkcmFnZ2FibGUpXG4gICAgICAgIH0gZWxzZXtcbiAgICAgICAgICAgIGNlbGxzQ29udGFpbmVyLmluc2VydEJlZm9yZShkcmFnZ2FibGUsIGFmdGVyRWxlbWVudClcbiAgICAgICAgfVxuICAgIH0pXG59XG5cbmNvbnN0IHF1ZXJ5Q2VsbHMgPSAoKSA9PiB7XG5cbiAgICBjb25zdCBwYXRyb2xCb2F0PSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2VsbFtzaGlwLW5hbWU9XCJQYXRyb2wgQm9hdFwiXScpXG4gICAgYWRkTGlzdGVuZXJUb0JvYXQocGF0cm9sQm9hdClcblxuICAgIC8vY29uc3QgcGF0cm9sQm9hdENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG5cbiAgICBjb25zdCBzdWJtYXJpbmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2VsbFtzaGlwLW5hbWU9XCJTdWJtYXJpbmVcIl0nKVxuICAgIGFkZExpc3RlbmVyVG9Cb2F0KHN1Ym1hcmluZSlcbiAgICAvL2NvbnN0IHN1Ym1hcmluZUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG5cbiAgICBjb25zdCBjYXJyaWVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNlbGxbc2hpcC1uYW1lPVwiQ2FycmllclwiXScpXG4gICAgYWRkTGlzdGVuZXJUb0JvYXQoY2FycmllcilcbiAgICAvL2NvbnN0IGNhcnJpZXJDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuXG4gICAgY29uc3QgYmF0dGxlU2hpcD0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNlbGxbc2hpcC1uYW1lPVwiQmF0dGxlc2hpcFwiXScpXG4gICAgYWRkTGlzdGVuZXJUb0JvYXQoYmF0dGxlU2hpcClcbiAgICAvL2NvbnN0IGJhdHRsZVNoaXBDb250YWluZXI9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG5cbiAgICBjb25zdCBkZXN0cm95ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2VsbFtzaGlwLW5hbWU9XCJEZXN0cm95ZXJcIl0nKVxuICAgIGFkZExpc3RlbmVyVG9Cb2F0KGRlc3Ryb3llcilcbiAgICAvL2NvbnN0IGRlc3Ryb3llckNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG5cblxufVxuXG5mdW5jdGlvbiBjcmVhdGVEcmFnQW5kRHJvcEZsZWV0KHBsYXllcil7XG4gICAgcmVuZGVyUGxheWVyU2hpcFNlbGVjdCgxLCAxKVxuICAgIHJlbmRlclBsYXllclNoaXBTZWxlY3QoMiwgMilcbiAgICByZW5kZXJQbGF5ZXJTaGlwU2VsZWN0KDMsIDMpXG4gICAgcmVuZGVyUGxheWVyU2hpcFNlbGVjdCg0LCA0KVxuXG4gICAgZnVuY3Rpb24gcmVuZGVyUGxheWVyU2hpcFNlbGVjdChpLCBsZW5ndGgpe1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyLWJvYXJkJylcbiAgICAgICAgY29uc3Qgc2hpcENvbnRhaW5lciA9IGRvY3VtbmV0LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgICAgIHNoaXBDb250YWluZXIuY2xhc3NMaXN0LmFkZChcInNoaXAtY29udGFpbmVyXCIpXG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChzaGlwQ29udGFpbmVyKVxuXG4gICAgICAgIGNvbnN0IHNoaXBJbmZvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIilcbiAgICAgICAgc2hpcEluZm8uY2xhc3NMaXN0LmFkZCgpXG5cbiAgICB9XG59XG5leHBvcnQgY29uc3QgcmVuZGVyUGxheWVyU2hpcHMgPSAoeyBnZXRMb2NhdGlvbiB9KSA9PiB7XG4gICAgY29uc3QgcGxheWVyQm9hcmRBcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2LnBsYXllci1ib2FyZCcpXG5cbiAgICBmb3IgKGxldCBjb2x1bW4gPSAwOyBjb2x1bW4gPCAxMDsgY29sdW1uICs9IDEpIHtcbiAgICAgICAgZm9yIChsZXQgcm93ID0gMDsgcm93IDwgMTA7IHJvdyArPSAxKSB7XG4gICAgICAgICAgICBjb25zdCBjZWxsID0gcGxheWVyQm9hcmRBcmVhLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICAgICAgYC5jZWxsOm50aC1jaGlsZCgke3JvdyAqIDEwICsgY29sdW1uICsgMX0pYFxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgY2VsbC5zZXRBdHRyaWJ1dGUoJ2NvbHVtbicsIGNvbHVtbilcbiAgICAgICAgICAgIGNlbGwuc2V0QXR0cmlidXRlKCdyb3cnLCByb3cpXG4gICAgICAgICAgICBjb25zdCBsb2NhdGlvbiA9IGdldExvY2F0aW9uKGNvbHVtbiwgcm93KVxuICAgICAgICAgICAgaWYgKGxvY2F0aW9uLmlzU2hpcCkge1xuICAgICAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnc2hpcCcpXG4gICAgICAgICAgICAgICAgY2VsbC5zZXRBdHRyaWJ1dGUoJ3NoaXAtbmFtZScsIGxvY2F0aW9uLmdldE5hbWUoKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuY29uc3QgY2hlY2tJZkdhbWVPdmVyID0gKHBsYXllckJvYXJkLCBlbmVteUJvYXJkKSA9PiB7XG4gICAgaWYgKHBsYXllckJvYXJkLmNoZWNrSWZBbGxTaGlwc0hhdmVTdW5rKCkpIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwnKVxuICAgICAgICBjb25zdCBtb2RhbFdpbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1jb250ZW50ID4gcCcpXG4gICAgICAgIGNvbnN0IHBsYXlBZ2FpbkJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICAnLm1vZGFsLWNvbnRlbnQgPiBidXR0b24nXG4gICAgICAgIClcblxuICAgICAgICBtb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJ1xuICAgICAgICBwbGF5QWdhaW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKVxuICAgICAgICB9KVxuXG4gICAgICAgIG1vZGFsV2lubmVyLnRleHRDb250ZW50ID0gJ1lvdSBsb3NlISdcbiAgICB9XG4gICAgaWYgKGVuZW15Qm9hcmQuY2hlY2tJZkFsbFNoaXBzSGF2ZVN1bmsoKSkge1xuICAgICAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbCcpXG4gICAgICAgIGNvbnN0IG1vZGFsV2lubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWNvbnRlbnQgPiBwJylcbiAgICAgICAgY29uc3QgcGxheUFnYWluQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICcubW9kYWwtY29udGVudCA+IGJ1dHRvbidcbiAgICAgICAgKVxuXG4gICAgICAgIG1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snXG4gICAgICAgIG1vZGFsV2lubmVyLnRleHRDb250ZW50ID0gJ1lvdSB3aW4hJ1xuICAgICAgICBwbGF5QWdhaW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKVxuICAgICAgICB9KVxuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IGFkZExpc3RlbmVyc1RvRW5lbXlCb2FyZCA9IChcbiAgICBwbGF5ZXJCb2FyZCxcbiAgICBlbmVteUJvYXJkLFxuICAgIHBsYXllcixcbiAgICBlbmVteSxcbiAgICBwc1xuKSA9PiB7XG4gICAgY29uc3QgZW5lbXlCb2FyZEFyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXYuZW5lbXktYm9hcmQnKVxuXG4gICAgZm9yIChsZXQgY29sdW1uID0gMDsgY29sdW1uIDwgMTA7IGNvbHVtbiArPSAxKSB7XG4gICAgICAgIGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IDEwOyByb3cgKz0gMSkge1xuICAgICAgICAgICAgLy8gQ3JlZGl0aW5nIGZvcm11bGEgdG8gY2FsY3VsYXRlIG50aC1jaGlsZCB1c2luZyBuZXN0ZWQgbG9vcDogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvODg3MjY2Mi9tYXRoLXRvLWRldGVybWluZS1pdGVtLWluZGV4LWJhc2VkLW9uLWNvbC1yb3ctc2VsZWN0aW9uLWluLWdyaWRcbiAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBlbmVteUJvYXJkQXJlYS5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgICAgIGAuY2VsbDpudGgtY2hpbGQoJHtyb3cgKiAxMCArIGNvbHVtbiArIDF9KWBcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIGNlbGwuc2V0QXR0cmlidXRlKCdjb2x1bW4nLCBjb2x1bW4pXG4gICAgICAgICAgICBjZWxsLnNldEF0dHJpYnV0ZSgncm93Jywgcm93KVxuXG4gICAgICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICAgICAgJ2NsaWNrJyxcbiAgICAgICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHBzLnB1Ymxpc2goJ2NsaWNrJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2VsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllckJvYXJkLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5lbXlCb2FyZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllcixcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZW15LFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgeyBvbmNlOiB0cnVlIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgfVxuICAgIH1cbn1cblxuY29uc3QgY2xlYXJCb2FyZERPTSA9ICgpID0+IHtcbiAgICBjb25zdCBjZWxscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wbGF5ZXItYm9hcmQgPiAuY2VsbCcpXG5cbiAgICBjZWxscy5mb3JFYWNoKGNlbGwgPT4ge1xuICAgICAgICBjZWxsLmNsYXNzTGlzdC5yZW1vdmUoJ3NoaXAnKVxuICAgICAgICBjZWxsLmNsYXNzTGlzdC5yZW1vdmUoJ2hpdCcpXG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LnJlbW92ZSgnbWlzcycpXG4gICAgfSlcblxuXG5cbn1cblxuXG5leHBvcnQgY29uc3QgcmFuZG9taXplTGlzdGVuZXIgPSAoZ2FtZUJvYXJkKSA9PiB7XG5cbiAgICBnYW1lQm9hcmQuY2xlYXJCb2FyZCgpXG4gICAgY2xlYXJCb2FyZERPTSgpXG5cbiAgICBjb25zdCByYW5kb21Qb3NzaWJpbGl0eSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpXG4gICAgc3dpdGNoKHJhbmRvbVBvc3NpYmlsaXR5KXtcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDksIDEsICd2ZXJ0aWNhbCcsIGNyZWF0ZVNoaXAoNSkpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoMCwgMywgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDMpKVxuICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDMsIDYsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgyKSlcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCg2LCA1LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMykpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoMywgOSwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDQpKVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCgwLCAyLCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoNSkpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoNCwgNSwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDMpKVxuICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDgsIDcsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgyKSlcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCg1LCA5LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMykpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoNiwgMywgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDQpKVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCg1LCAxLCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoNSkpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoMywgMywgJ3ZlcnRpY2FsJywgY3JlYXRlU2hpcCgzKSlcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCgwLCAwLCAndmVydGljYWwnLCBjcmVhdGVTaGlwKDIpKVxuICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDYsIDUsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgzKSlcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCg1LCA5LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoNCkpXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoMCwgMCwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDUpKVxuICAgICAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCgzLCA0LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMykpXG4gICAgICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDYsIDcsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgyKSlcbiAgICAgICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoOSwgMSwgJ3ZlcnRpY2FsJywgY3JlYXRlU2hpcCgzKSlcbiAgICAgICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoNSwgOSwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDQpKVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgcmVuZGVyUGxheWVyU2hpcHMoZ2FtZUJvYXJkKVxuXG59XG5cblxuXG5leHBvcnQgY29uc3QgYXR0YWNrID0gKHtcbiAgICBjZWxsLFxuICAgIGNvbHVtbixcbiAgICByb3csXG4gICAgcGxheWVyQm9hcmQsXG4gICAgZW5lbXlCb2FyZCxcbiAgICBwbGF5ZXIsXG4gICAgZW5lbXksXG59KSA9PiB7XG4gICAgLy8gaHVtYW4gcGxheWVyIGF0dGFja2luZyBjb21wdXRlclxuICAgIGF0dGFja0VuZW15Q2VsbChjb2x1bW4sIHJvdywgZW5lbXlCb2FyZCwgcGxheWVyKVxuICAgIC8vIGNvbXB1dGVyIGF0dGFja2luZyBodW1hblxuICAgIGNvbnN0IHsgZWxlbWVudENvbHVtbiwgZWxlbWVudFJvdyB9ID0gcGxheWVyQm9hcmQubWFrZVJhbmRvbUNvb3JkaW5hdGVzKClcbiAgICBhdHRhY2tQbGF5ZXJDZWxsKHBsYXllckJvYXJkLCBlbmVteSwgZWxlbWVudENvbHVtbiwgZWxlbWVudFJvdylcblxuICAgIGNoZWNrSWZHYW1lT3ZlcihwbGF5ZXJCb2FyZCwgZW5lbXlCb2FyZClcbn1cbiIsImltcG9ydCB7IGFkZExpc3RlbmVyc1RvRW5lbXlCb2FyZCwgcmVuZGVyUGxheWVyU2hpcHMscHViU3ViLCByYW5kb21pemVMaXN0ZW5lciwgYXR0YWNrfSBmcm9tICcuL2RvbSdcblxuaW1wb3J0IGNyZWF0ZUdhbWVCb2FyZCBmcm9tICcuL2dhbWVib2FyZC9nYW1lYm9hcmQnXG5pbXBvcnQgY3JlYXRlU2hpcCBmcm9tICcuL3NoaXAvc2hpcCdcbmltcG9ydCBjcmVhdGVQbGF5ZXIgZnJvbSAnLi9wbGF5ZXIvcGxheWVyJ1xuXG5jb25zdCBwbGF5ZXJCb2FyZCA9IGNyZWF0ZUdhbWVCb2FyZCgpXG5jb25zdCBlbmVteUJvYXJkID0gY3JlYXRlR2FtZUJvYXJkKClcbmNvbnN0IHBsYXllciA9IGNyZWF0ZVBsYXllcigpXG5jb25zdCBjb21wdXRlciA9IGNyZWF0ZVBsYXllcigpXG5cbmNvbnN0IHJhbmRvbWl6ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbi5yYW5kb21pemUnKVxuXG5yYW5kb21pemVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgcmFuZG9taXplTGlzdGVuZXIocGxheWVyQm9hcmQpXG59KVxuXG5yYW5kb21pemVMaXN0ZW5lcihwbGF5ZXJCb2FyZClcblxuZW5lbXlCb2FyZC5wbGFjZVNoaXAoMCwgMCwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDUpKVxuZW5lbXlCb2FyZC5wbGFjZVNoaXAoMywgNCwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDMpKVxuZW5lbXlCb2FyZC5wbGFjZVNoaXAoNiwgNywgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDIpKVxuZW5lbXlCb2FyZC5wbGFjZVNoaXAoOSwgMSwgJ3ZlcnRpY2FsJywgY3JlYXRlU2hpcCgzKSlcbmVuZW15Qm9hcmQucGxhY2VTaGlwKDUsIDksICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCg0KSlcblxuY29uc3QgcHMgPSBwdWJTdWIoKVxuXG5hZGRMaXN0ZW5lcnNUb0VuZW15Qm9hcmQocGxheWVyQm9hcmQsIGVuZW15Qm9hcmQsIHBsYXllciwgY29tcHV0ZXIsIHBzKVxuXG5wcy5zdWJzY3JpYmUoJ2NsaWNrJywgYXR0YWNrKVxuXG5yZW5kZXJQbGF5ZXJTaGlwcyhwbGF5ZXJCb2FyZCkiXSwibmFtZXMiOlsiY3JlYXRlU2hpcCIsIm1vZHVsZSIsImV4cG9ydHMiLCJlbXB0eUNlbGwiLCJoYXNCZWVuSGl0IiwiaXNTaGlwIiwib2ZmTGltaXRzIiwiaW5pdGlhbGl6ZUJvYXJkIiwiZ2FtZUJvYXJkIiwiQXJyYXkiLCJmaWxsIiwibWFwIiwiY29sdW1uIiwicm93Iiwic2hpcHMiLCJnZXRMb2NhdGlvbiIsInNldExvY2F0aW9uIiwic2hpcCIsIk9iamVjdCIsImFzc2lnbiIsImNyZWF0ZU9mZkxpbWl0TG9jYXRpb24iLCJ1bmRlZmluZWQiLCJsb2NhdGlvbiIsImFkZE9mZkxpbWl0QXJlYUZvclNoaXBzIiwiY2hlY2tJZkxvY2F0aW9uSXNBU2hpcE9yT2ZmTGltaXRzIiwiZGlyZWN0aW9uIiwic2hpcExlbmd0aCIsImkiLCJwbGFjZVNoaXAiLCJnZXRMZW5ndGgiLCJsZW5ndGgiLCJjaGVja0lmUm93Q29vcmRpbmF0ZUlzVmFsaWQiLCJwb3NpdGlvbiIsImFkZE9mZkxpbWl0QXJlYUZvclZlcnRpY2FsbHlQb3NpdGlvbmVkU2hpcCIsImNoZWNrSWZDb2x1bW5Db29yZGluYXRlSXNWYWxpZCIsImFkZE9mZkxpbWl0QXJlYUZvckhvcml6b250YWxseVBvc2l0aW9uZWRTaGlwIiwibWFrZVJhbmRvbUNvb3JkaW5hdGVzIiwicmFuZG9tRGlyZWN0aW9uIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicmFuZG9tTG9jYXRpb24iLCJmbGF0dGVuZWRHYW1lQm9hcmQiLCJmbGF0IiwiZm9yRWFjaCIsImVsZW1lbnQiLCJhdmFpbGFiaWxpdHkiLCJhdmFpbGFibGVTcGFjZXMiLCJlbGVtZW50Q29sdW1uIiwiZWxlbWVudFJvdyIsImNsZWFyQm9hcmQiLCJjaGVja0lmT2ZmTGltaXRab25lV2FzQ29ycmVjdGx5SW1wbGVtZW50ZWQiLCJmaWx0ZXIiLCJyZWNlaXZlQXR0YWNrIiwiY2hlY2tJZkFsbFNoaXBzSGF2ZVN1bmsiLCJoYXZlQWxsU2hpcHNTdW5rIiwiaiIsImlzU3VuayIsInJhbmRvbWx5UGxhY2VTaGlwcyIsInNoaXBEZXRhaWxzIiwicmFuZG9tQ29sdW1uIiwicmFuZG9tUm93IiwicHVzaCIsIm5hbWUiLCJnZXROYW1lIiwiYXR0YWNrIiwiZ2V0U3RhdHVzIiwiaW5jbHVkZXMiLCJoaXQiLCJzdGF0dXMiLCJldmVyeSIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJuIiwiZ2V0dGVyIiwiX19lc01vZHVsZSIsImQiLCJhIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwicmVuZGVyQXR0YWNrcyIsInBsYXllciIsImVuZW15Qm9hcmQiLCJjZWxsIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xhc3NMaXN0IiwiYWRkIiwiaGFuZGxlQXR0YWNrIiwicmFuZG9tRGlyZWN0aW9uQXR0YWNrIiwicGxheWVyQm9hcmQiLCJzcGFjZXNIaXQiLCJuZXh0Q29sdW1uIiwicHJldmlvdXNDb2x1bW4iLCJuZXh0Um93IiwicHJldmlvdXNSb3ciLCJpc1NwYWNlQXJvdW5kSGl0IiwicmFuZG9tSW5kZXgiLCJsaXN0T2ZSYW5kb21Db29yZGluYXRlcyIsImxvY2F0aW9uUHJvdG90eXBlIiwidGhpcyIsInRvcCIsImNyZWF0ZSIsImJvdHRvbSIsInJpZ2h0IiwibGVmdCIsImRpcmVjdGlvbnMiLCJhdHRhY2tQbGF5ZXJDZWxsIiwiZW5lbXkiLCJwcmV2TG9jYXRpb24iLCJyYW5kb21Qb3NpdGlvbiIsInJhbmRvbVBvc2l0aW9uQ29sdW1uIiwiZmlsdGVyZWREaXJlY3Rpb25zIiwicmFuZG9tUG9zaXRpb25Sb3ciLCJzZXRUaW1lb3V0IiwicHJldkxvY2F0aW9uUm93IiwicHJldkxvY2F0aW9uQ29sdW1uIiwicmVuZGVyUGxheWVyU2hpcHMiLCJwbGF5ZXJCb2FyZEFyZWEiLCJzZXRBdHRyaWJ1dGUiLCJyYW5kb21pemVMaXN0ZW5lciIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJyZW1vdmUiLCJjb21wdXRlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJwcyIsInN1YnNjcmliZXJzIiwicHVibGlzaCIsImV2ZW50TmFtZSIsImRhdGEiLCJpc0FycmF5IiwiY2FsbGJhY2siLCJzdWJzY3JpYmUiLCJpbmRleCIsInVuc3Vic2NyaWJlIiwic3BsaWNlIiwicHViU3ViIiwiZW5lbXlCb2FyZEFyZWEiLCJvbmNlIiwiYWRkTGlzdGVuZXJzVG9FbmVteUJvYXJkIiwiYXR0YWNrRW5lbXlDZWxsIiwibW9kYWwiLCJtb2RhbFdpbm5lciIsInBsYXlBZ2FpbkJ1dHRvbiIsInN0eWxlIiwiZGlzcGxheSIsInJlbG9hZCIsInRleHRDb250ZW50IiwiY2hlY2tJZkdhbWVPdmVyIl0sInNvdXJjZVJvb3QiOiIifQ==