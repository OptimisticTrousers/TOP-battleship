(()=>{var e={653:(e,t,o)=>{const r=o(585);e.exports=()=>{const e={hasBeenHit:!1,isShip:!1,offLimits:!1},t=Array(10).fill([]);(()=>{for(let o=0;o<10;o++)for(let r=0;r<10;r++)t[o][r]={...e,column:o,row:r}})();const o=[r(5,"Carrier"),r(4,"Battleship"),r(3,"Destroyer"),r(3,"Submarine"),r(2,"Patrol Boat")],n=(e,o)=>t?.[e]?.[o],i=(o,r,n=(()=>Object.assign(e,{offLimits:!0}))())=>{void 0!==t?.[o]?.[r]&&(t[o][r]=n)},l=(e,t)=>{i(e-1,t-1),i(e,t-1)},a=()=>{const e=0===Math.floor(2*Math.random())?"vertical":"horizontal";return{randomLocation:Math.floor(Math.random()*(t.flat().filter((e=>!1===e.isShip&&!1===e.offLimits)).length-1)),randomDirection:e}};return{checkIfOffLimitZoneWasCorrectlyImplemented:e=>t.flat().filter((e=>!0===e.offLimits)).length===e+2,getLocation:n,receiveAttack:(e,o)=>{t[e][o].hasBeenHit=!0},checkIfAllShipsHaveSunk:()=>{let e=!0;for(let t=0;t<10;t++)for(let o=0;o<10;o++){const r=n(t,o);if(!1!==r.isShip&&r.isShip&&!1===r.isSunk()){e=!1;break}}return e},placeShip:(e,o,r,a)=>{const c=a.getLength();if(((e,t,o,r)=>{if("vertical"===o)for(let o=0;o<r;o++){const r=n(e,t+o);if(r&&!0===r.isShip&&!0===r.offLimits)return!0}else if("horizontal"===o)for(let o=0;o<r;o++){const r=n(e+o,t);if(r&&!0===r.isShip&&!0===r.offLimits)return!0}return!1})(e,o,r,c))return!1;if("vertical"===r){if(((e,o)=>e>=0&&e+o-1<t.length)(o,c)){for(let t=0;t<c;t+=1)i(e,o+t,{...a,position:t,hasBeenHit:!1,direction:r}),i(e+1,o+t),i(e-1,o+t);return((e,t,o)=>{l(e,t),i(e,t+o),i(e+1,t+o),i(e-1,t+o),i(e+1,t-1)})(e,o,c),!0}}else if("horizontal"===r&&((e,o)=>e>=0&&e+o-1<t.length)(e,c)){for(let t=0;t<c;t+=1)i(e+t,o,{...a,position:t,hasBeenHit:!1,direction:r}),i(e+t,o+1),i(e+t,o-1);return((e,t,o)=>{l(e,t),i(e+o,t),i(e-1,t+1),i(e+o,t+1),i(e+o,t-1)})(e,o,c),!0}return!1},randomlyPlaceShips:()=>{const e=[];for(let r=0;r<o.length;r++){const{randomLocation:o,randomDirection:r}=a(),n=t.flat(),i=n.findIndex(((e,t)=>t===o)),l=n[i],c=l.column,s=l.row;e.push({elementColumn:c,elementRow:s,randomDirection:r})}return e},makeRandomCoordinates:a}}},61:e=>{e.exports=(e="player")=>({getName:()=>e,attack:(e,t,{getLocation:o,receiveAttack:r})=>{const n=o(e,t);return!1===n.hasBeenHit||n.isShip&&!1===n.getStatus().includes("unhit")?(r(e,t),n.hit&&n.hit(n.position),"It's a hit!"):"You have already hit this spot!"}})},585:e=>{e.exports=(e,t="ship")=>{const o=Array(e).fill("unhit");return{name:t,getLength:()=>o.length,isSunk:()=>o.every((e=>"hit"===e)),hit:t=>{t<e&&(o[t]="hit")},getStatus:()=>o,hasBeenHit:!1,isShip:!0}}}},t={};function o(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,o),i.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=(e,t,o,r)=>{const n=document.querySelector(`.${e}-board > .cell[column='${t}'][row='${o}']`);r.getLocation(t,o).isShip?n.classList.add("hit"):n.classList.add("miss")},t=(e,t,o,r)=>r.attack(e,t,o);var r=o(653),n=o.n(r),i=o(585),l=o.n(i),a=o(61),c=o.n(a);const s=n()(),h=n()(),u=c()(),p=c()();s.randomlyPlaceShips(),h.randomlyPlaceShips(),s.placeShip(0,0,"horizontal",l()(5)),s.placeShip(3,4,"horizontal",l()(3)),s.placeShip(6,7,"horizontal",l()(2)),s.placeShip(9,1,"vertical",l()(3)),s.placeShip(5,9,"horizontal",l()(4)),h.placeShip(0,0,"horizontal",l()(5)),h.placeShip(3,4,"horizontal",l()(3)),h.placeShip(6,7,"horizontal",l()(2)),h.placeShip(9,1,"vertical",l()(3)),h.placeShip(5,9,"horizontal",l()(4));const d=(()=>{const e={};return{publish:function(t,o){Array.isArray(e[t])&&e[t].forEach((e=>{e(o)}))},subscribe:function t(o,r){Array.isArray(t[o])||(e[o]=[]),e[o].push(r);const n=e[o].length-1;return{unsubscribe(){e[o].splice(n,1)}}}}})();((e,t,o,r,n)=>{const i=document.querySelector("div.enemy-board");for(let l=0;l<10;l+=1)for(let a=0;a<10;a+=1){const c=i.querySelector(`.cell:nth-child(${10*a+l+1})`);c.setAttribute("column",l),c.setAttribute("row",a),c.addEventListener("click",(()=>{n.publish("click",{cell:c,column:l,row:a,playerBoard:e,enemyBoard:t,player:o,enemy:r})}),{once:!0})}})(s,h,u,p,d),d.subscribe("click",(({cell:o,column:r,row:n,playerBoard:i,enemyBoard:l,player:a,enemy:c})=>{((o,r,n,i)=>{t(o,r,n,i),e("enemy",o,r,n)})(r,n,l,a),((o,r)=>{const{randomColumn:n,randomRow:i}=o.makeRandomCoordinates();t(n,n,o,r),e("player",n,i,o)})(i,c),((e,t)=>{if(e.checkIfAllShipsHaveSunk()){const e=document.querySelector(".modal"),t=document.querySelector(".modal-content > p"),o=document.querySelector(".modal-content > button");e.style.display="block",o.addEventListener("click",(()=>{location.reload()})),t.textContent="You win!"}if(t.checkIfAllShipsHaveSunk()){const e=document.querySelector(".modal"),t=document.querySelector(".modal-content > p"),o=document.querySelector(".modal-content > button");e.style.display="block",t.textContent="You lose!",o.addEventListener("click",(()=>{location.reload()}))}})(i,l)})),(({getLocation:e})=>{const t=document.querySelector("div.player-board");for(let o=0;o<10;o+=1)for(let r=0;r<10;r+=1){const n=t.querySelector(`.cell:nth-child(${10*r+o+1})`);n.setAttribute("column",o),n.setAttribute("row",r),e(r,o).isShip&&n.classList.add("ship")}})(s)})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNbUYsRUFBUTdCLFNBQVNDLGNBQWMsVUFDL0I2QixFQUFjOUIsU0FBU0MsY0FBYyxzQkFDckM4QixFQUFrQi9CLFNBQVNDLGNBQWMsMkJBRS9DNEIsRUFBTUcsTUFBTUMsUUFBVSxRQUN0QkgsRUFBWUssWUFBYyxZQUMxQkosRUFBZ0JULGlCQUFpQixTQUFTLEtBQ3RDMUUsU0FBU3NGLGNBeURqQkUsQ0FBZ0IvQixFQUFhTixNQWpHQSxHQUFHM0Usa0JBQ2hDLE1BQU1pSCxFQUFrQnJDLFNBQVNDLGNBQWMsb0JBRS9DLElBQUssSUFBSWpGLEVBQVMsRUFBR0EsRUFBUyxHQUFJQSxHQUFVLEVBQ3hDLElBQUssSUFBSUMsRUFBTSxFQUFHQSxFQUFNLEdBQUlBLEdBQU8sRUFBRyxDQUNsQyxNQUFNbUIsRUFBT2lHLEVBQWdCcEMsY0FDekIsbUJBQXlCLEdBQU5oRixFQUFXRCxFQUFTLE1BRTNDb0IsRUFBS2lGLGFBQWEsU0FBVXJHLEdBQzVCb0IsRUFBS2lGLGFBQWEsTUFBT3BHLEdBQ3JCRyxFQUFZSCxFQUFLRCxHQUFRUCxRQUN6QjJCLEVBQUs4RCxVQUFVQyxJQUFJLFVDbENuQ21DLENBQWtCakMsSSIsInNvdXJjZXMiOlsid2VicGFjazovL3RvcC1iYXR0bGVzaGlwLy4vc3JjL2dhbWVib2FyZC9nYW1lYm9hcmQuanMiLCJ3ZWJwYWNrOi8vdG9wLWJhdHRsZXNoaXAvLi9zcmMvcGxheWVyL3BsYXllci5qcyIsIndlYnBhY2s6Ly90b3AtYmF0dGxlc2hpcC8uL3NyYy9zaGlwL3NoaXAuanMiLCJ3ZWJwYWNrOi8vdG9wLWJhdHRsZXNoaXAvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vdG9wLWJhdHRsZXNoaXAvd2VicGFjay9ydW50aW1lL2NvbXBhdCBnZXQgZGVmYXVsdCBleHBvcnQiLCJ3ZWJwYWNrOi8vdG9wLWJhdHRsZXNoaXAvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3RvcC1iYXR0bGVzaGlwL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vdG9wLWJhdHRsZXNoaXAvLi9zcmMvZG9tLmpzIiwid2VicGFjazovL3RvcC1iYXR0bGVzaGlwLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIG5vLW11bHRpLWFzc2lnbiAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLWV4cHJlc3Npb25zICovXG5jb25zdCBjcmVhdGVTaGlwID0gcmVxdWlyZSgnLi4vc2hpcC9zaGlwJylcblxuLyogZXNsaW50LWRpc2FibGUgbm8tcGFyYW0tcmVhc3NpZ24gKi9cbmNvbnN0IGNyZWF0ZUdhbWVCb2FyZCA9ICgpID0+IHtcbiAgICBjb25zdCBlbXB0eUNlbGwgPSB7IGhhc0JlZW5IaXQ6IGZhbHNlLCBpc1NoaXA6IGZhbHNlLCBvZmZMaW1pdHM6IGZhbHNlIH1cblxuICAgIGNvbnN0IGdhbWVCb2FyZCA9IEFycmF5KDEwKS5maWxsKFtdKVxuICAgIGNvbnN0IGluaXRpYWxpemVCb2FyZCA9ICgpID0+IHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDEwOyBqKyspIHtcbiAgICAgICAgICAgICAgICBnYW1lQm9hcmRbaV1bal0gPSB7IC4uLmVtcHR5Q2VsbCwgY29sdW1uOiBpLCByb3c6IGogfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgaW5pdGlhbGl6ZUJvYXJkKClcblxuICAgIGNvbnN0IHNoaXBzID0gW1xuICAgICAgICBjcmVhdGVTaGlwKDUsICdDYXJyaWVyJyksXG4gICAgICAgIGNyZWF0ZVNoaXAoNCwgJ0JhdHRsZXNoaXAnKSxcbiAgICAgICAgY3JlYXRlU2hpcCgzLCAnRGVzdHJveWVyJyksXG4gICAgICAgIGNyZWF0ZVNoaXAoMywgJ1N1Ym1hcmluZScpLFxuICAgICAgICBjcmVhdGVTaGlwKDIsICdQYXRyb2wgQm9hdCcpLFxuICAgIF1cblxuICAgIGNvbnN0IGNyZWF0ZU9mZkxpbWl0TG9jYXRpb24gPSAoKSA9PlxuICAgICAgICBPYmplY3QuYXNzaWduKGVtcHR5Q2VsbCwgeyBvZmZMaW1pdHM6IHRydWUgfSlcblxuICAgIGNvbnN0IGdldExvY2F0aW9uID0gKGNvbHVtbiwgcm93KSA9PiBnYW1lQm9hcmQ/Lltjb2x1bW5dPy5bcm93XVxuXG4gICAgY29uc3Qgc2V0TG9jYXRpb24gPSAoY29sdW1uLCByb3csIHNoaXAgPSBjcmVhdGVPZmZMaW1pdExvY2F0aW9uKCkpID0+IHtcbiAgICAgICAgaWYgKGdhbWVCb2FyZD8uW2NvbHVtbl0/Lltyb3ddICE9PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBnYW1lQm9hcmRbY29sdW1uXVtyb3ddID0gc2hpcFxuICAgIH1cbiAgICBjb25zdCBjaGVja0lmQWxsU2hpcHNIYXZlU3VuayA9ICgpID0+IHtcbiAgICAgICAgbGV0IGhhdmVBbGxTaGlwc1N1bmsgPSB0cnVlXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbG9jYXRpb24gPSBnZXRMb2NhdGlvbihpLCBqKVxuICAgICAgICAgICAgICAgIGlmIChsb2NhdGlvbi5pc1NoaXAgPT09IGZhbHNlKSBjb250aW51ZVxuICAgICAgICAgICAgICAgIGlmIChsb2NhdGlvbi5pc1NoaXAgJiYgbG9jYXRpb24uaXNTdW5rKCkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGhhdmVBbGxTaGlwc1N1bmsgPSBmYWxzZVxuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaGF2ZUFsbFNoaXBzU3Vua1xuICAgIH1cblxuICAgIGNvbnN0IGFkZE9mZkxpbWl0QXJlYUZvclNoaXBzID0gKGNvbHVtbiwgcm93KSA9PiB7XG4gICAgICAgIC8vIHRvcC1sZWZ0XG4gICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiAtIDEsIHJvdyAtIDEpXG4gICAgICAgIC8vIHRvcFxuICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4sIHJvdyAtIDEpXG4gICAgfVxuXG4gICAgY29uc3QgYWRkT2ZmTGltaXRBcmVhRm9ySG9yaXpvbnRhbGx5UG9zaXRpb25lZFNoaXAgPSAoXG4gICAgICAgIGNvbHVtbixcbiAgICAgICAgcm93LFxuICAgICAgICBzaGlwTGVuZ3RoXG4gICAgKSA9PiB7XG4gICAgICAgIC8vIHBvc2l0aW9ucyByZWxhdGl2ZSB0byB0aGUgc2hpcCBpdHNlbGYoaWUuIGEgaG9yaXpvbnRhbCBzaGlwJ3MgYm90dG9tIGlzIHRvIHRoZSByaWdodClcblxuICAgICAgICBhZGRPZmZMaW1pdEFyZWFGb3JTaGlwcyhjb2x1bW4sIHJvdylcbiAgICAgICAgLy8gYm90dG9tXG4gICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIHNoaXBMZW5ndGgsIHJvdylcbiAgICAgICAgLy8gYm90dG9tLWxlZnRcbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uIC0gMSwgcm93ICsgMSlcbiAgICAgICAgLy8gYm90dG9tLXJpZ2h0XG4gICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIHNoaXBMZW5ndGgsIHJvdyArIDEpXG4gICAgICAgIC8vIHRvcC1yaWdodFxuICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gKyBzaGlwTGVuZ3RoLCByb3cgLSAxKVxuICAgIH1cblxuICAgIGNvbnN0IGFkZE9mZkxpbWl0QXJlYUZvclZlcnRpY2FsbHlQb3NpdGlvbmVkU2hpcCA9IChcbiAgICAgICAgY29sdW1uLFxuICAgICAgICByb3csXG4gICAgICAgIHNoaXBMZW5ndGhcbiAgICApID0+IHtcbiAgICAgICAgLy8gcG9zaXRpb25zIHJlbGF0aXZlIHRvIGhvdyB0aGUgdXNlciBzZWVzIGl0KGllLiBhIHZlcnRpY2FsIHNoaXAncyBib3R0b20gaXMgdG8gdGhlIGJvdHRvbSlcblxuICAgICAgICBhZGRPZmZMaW1pdEFyZWFGb3JTaGlwcyhjb2x1bW4sIHJvdylcbiAgICAgICAgLy8gYm90dG9tXG4gICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiwgcm93ICsgc2hpcExlbmd0aClcbiAgICAgICAgLy8gYm90dG9tLXJpZ2h0XG4gICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIDEsIHJvdyArIHNoaXBMZW5ndGgpXG4gICAgICAgIC8vIGJvdHRvbS1sZWZ0XG4gICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiAtIDEsIHJvdyArIHNoaXBMZW5ndGgpXG4gICAgICAgIC8vIHRvcC1yaWdodFxuICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gKyAxLCByb3cgLSAxKVxuICAgIH1cblxuICAgIGNvbnN0IGNoZWNrSWZDb2x1bW5Db29yZGluYXRlSXNWYWxpZCA9IChjb2x1bW4sIHNoaXBMZW5ndGgpID0+XG4gICAgICAgIGNvbHVtbiA+PSAwICYmIGNvbHVtbiArIHNoaXBMZW5ndGggLSAxIDwgZ2FtZUJvYXJkLmxlbmd0aFxuXG4gICAgY29uc3QgY2hlY2tJZlJvd0Nvb3JkaW5hdGVJc1ZhbGlkID0gKHJvdywgc2hpcExlbmd0aCkgPT5cbiAgICAgICAgcm93ID49IDAgJiYgcm93ICsgc2hpcExlbmd0aCAtIDEgPCBnYW1lQm9hcmQubGVuZ3RoXG5cbiAgICBjb25zdCBjaGVja0lmTG9jYXRpb25Jc0FTaGlwT3JPZmZMaW1pdHMgPSAoXG4gICAgICAgIGNvbHVtbixcbiAgICAgICAgcm93LFxuICAgICAgICBkaXJlY3Rpb24sXG4gICAgICAgIHNoaXBMZW5ndGhcbiAgICApID0+IHtcbiAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gJ3ZlcnRpY2FsJykge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsb2NhdGlvbiA9IGdldExvY2F0aW9uKGNvbHVtbiwgcm93ICsgaSlcbiAgICAgICAgICAgICAgICBpZiAobG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uaXNTaGlwID09PSB0cnVlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5vZmZMaW1pdHMgPT09IHRydWVcbiAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ2hvcml6b250YWwnKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxvY2F0aW9uID0gZ2V0TG9jYXRpb24oY29sdW1uICsgaSwgcm93KVxuICAgICAgICAgICAgICAgIGlmIChsb2NhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5pc1NoaXAgPT09IHRydWUgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLm9mZkxpbWl0cyA9PT0gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICBjb25zdCBpc09mZkxpbWl0QXJlYUNsZWFyID0gKGNvbHVtbiwgcm93LCBkaXJlY3Rpb24sIHNoaXBMZW5ndGgpID0+IHtcbiAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gJ3ZlcnRpY2FsJykge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsZWZ0ID0gZ2V0TG9jYXRpb24oY29sdW1uIC0gMSwgcm93ICsgaSlcbiAgICAgICAgICAgICAgICBjb25zdCByaWdodCA9IGdldExvY2F0aW9uKGNvbHVtbiArIDEsIHJvdyArIGkpXG4gICAgICAgICAgICAgICAgaWYgKGxlZnQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxlZnQuaXNTaGlwICYmIGxlZnQub2ZmTGltaXRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocmlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJpZ2h0LmlzU2hpcCAmJiByaWdodC5vZmZMaW1pdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ2hvcml6b250YWwnKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRvcCA9IGdldExvY2F0aW9uKGNvbHVtbiArIGksIHJvdyAtIDEpXG4gICAgICAgICAgICAgICAgY29uc3QgYm90dG9tID0gZ2V0TG9jYXRpb24oY29sdW1uICsgaSwgcm93ICsgMSlcbiAgICAgICAgICAgICAgICBpZiAodG9wKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0b3AuaXNTaGlwICYmIHRvcC5vZmZMaW1pdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChib3R0b20pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJvdHRvbS5pc1NoaXAgJiYgYm90dG9tLm9mZkxpbWl0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIGNvbnN0IHBsYWNlU2hpcCA9IChjb2x1bW4sIHJvdywgZGlyZWN0aW9uLCBzaGlwKSA9PiB7XG4gICAgICAgIGNvbnN0IHNoaXBMZW5ndGggPSBzaGlwLmdldExlbmd0aCgpXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIGNoZWNrSWZMb2NhdGlvbklzQVNoaXBPck9mZkxpbWl0cyhcbiAgICAgICAgICAgICAgICBjb2x1bW4sXG4gICAgICAgICAgICAgICAgcm93LFxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbixcbiAgICAgICAgICAgICAgICBzaGlwTGVuZ3RoXG4gICAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICBpZiAoZGlyZWN0aW9uID09PSAndmVydGljYWwnKSB7XG4gICAgICAgICAgICBpZiAoY2hlY2tJZlJvd0Nvb3JkaW5hdGVJc1ZhbGlkKHJvdywgc2hpcExlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBMZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4sIHJvdyArIGksIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLnNoaXAsXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogaSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc0JlZW5IaXQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uLFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gKyAxLCByb3cgKyBpKVxuICAgICAgICAgICAgICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gLSAxLCByb3cgKyBpKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhZGRPZmZMaW1pdEFyZWFGb3JWZXJ0aWNhbGx5UG9zaXRpb25lZFNoaXAoXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbixcbiAgICAgICAgICAgICAgICAgICAgcm93LFxuICAgICAgICAgICAgICAgICAgICBzaGlwTGVuZ3RoXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAnaG9yaXpvbnRhbCcpIHtcbiAgICAgICAgICAgIGlmIChjaGVja0lmQ29sdW1uQ29vcmRpbmF0ZUlzVmFsaWQoY29sdW1uLCBzaGlwTGVuZ3RoKSkge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcExlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIGksIHJvdywge1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4uc2hpcCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBpLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGFzQmVlbkhpdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXJlY3Rpb24sXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC8vIHNldExvY2F0aW9uKGNvbHVtbiArIGksIHJvdywgc2hpcClcbiAgICAgICAgICAgICAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uICsgaSwgcm93ICsgMSlcbiAgICAgICAgICAgICAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uICsgaSwgcm93IC0gMSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYWRkT2ZmTGltaXRBcmVhRm9ySG9yaXpvbnRhbGx5UG9zaXRpb25lZFNoaXAoXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbixcbiAgICAgICAgICAgICAgICAgICAgcm93LFxuICAgICAgICAgICAgICAgICAgICBzaGlwTGVuZ3RoXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgY29uc3QgYXZhaWxhYmxlU3BhY2VzID0gKCkgPT5cbiAgICAgICAgZ2FtZUJvYXJkXG4gICAgICAgICAgICAuZmxhdCgpXG4gICAgICAgICAgICAuZmlsdGVyKChjZWxsKSA9PiBjZWxsLmlzU2hpcCA9PT0gZmFsc2UgJiYgY2VsbC5vZmZMaW1pdHMgPT09IGZhbHNlKVxuICAgICAgICAgICAgLmxlbmd0aCAtIDFcblxuICAgIGNvbnN0IG1ha2VSYW5kb21Db29yZGluYXRlcyA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgcmFuZG9tRGlyZWN0aW9uID1cbiAgICAgICAgICAgIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDIpID09PSAwID8gJ3ZlcnRpY2FsJyA6ICdob3Jpem9udGFsJ1xuICAgICAgICBjb25zdCByYW5kb21Mb2NhdGlvbiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGF2YWlsYWJsZVNwYWNlcygpKVxuXG4gICAgICAgIHJldHVybiB7IHJhbmRvbUxvY2F0aW9uLCByYW5kb21EaXJlY3Rpb24gfVxuICAgIH1cblxuICAgIGNvbnN0IHJhbmRvbWx5UGxhY2VTaGlwcyA9ICgpID0+IHtcbiAgICAgICAgY29uc3Qgc2hpcHNEZXRhaWxzID0gW11cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgeyByYW5kb21Mb2NhdGlvbiwgcmFuZG9tRGlyZWN0aW9uIH0gPSBtYWtlUmFuZG9tQ29vcmRpbmF0ZXMoKVxuICAgICAgICAgICAgY29uc3QgZmxhdHRlbmVkR2FtZUJvYXJkID0gZ2FtZUJvYXJkLmZsYXQoKVxuICAgICAgICAgICAgY29uc3QgZWxlbWVudEluZGV4ID0gZmxhdHRlbmVkR2FtZUJvYXJkLmZpbmRJbmRleChcbiAgICAgICAgICAgICAgICAoZWxlbWVudCwgaW5kZXgpID0+IGluZGV4ID09PSByYW5kb21Mb2NhdGlvblxuICAgICAgICAgICAgKVxuXG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gZmxhdHRlbmVkR2FtZUJvYXJkW2VsZW1lbnRJbmRleF1cbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRDb2x1bW4gPSBlbGVtZW50LmNvbHVtblxuICAgICAgICAgICAgY29uc3QgZWxlbWVudFJvdyA9IGVsZW1lbnQucm93XG4gICAgICAgICAgICBzaGlwc0RldGFpbHMucHVzaCh7ZWxlbWVudENvbHVtbiwgZWxlbWVudFJvdywgcmFuZG9tRGlyZWN0aW9ufSlcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2hpcHNEZXRhaWxzXG4gICAgfVxuXG4gICAgY29uc3QgcmVjZWl2ZUF0dGFjayA9IChjb2x1bW4sIHJvdykgPT4ge1xuICAgICAgICBnYW1lQm9hcmRbY29sdW1uXVtyb3ddLmhhc0JlZW5IaXQgPSB0cnVlXG4gICAgfVxuXG4gICAgY29uc3QgY2hlY2tJZk9mZkxpbWl0Wm9uZVdhc0NvcnJlY3RseUltcGxlbWVudGVkID0gKHNoaXBMZW5ndGgpID0+XG4gICAgICAgIGdhbWVCb2FyZC5mbGF0KCkuZmlsdGVyKChlbGVtZW50KSA9PiBlbGVtZW50Lm9mZkxpbWl0cyA9PT0gdHJ1ZSlcbiAgICAgICAgICAgIC5sZW5ndGggPT09XG4gICAgICAgIHNoaXBMZW5ndGggKyAyXG4gICAgLy8gYWRkaW5nIHNoaXBMZW5ndGggcGx1cyB0d28gYmVjYXVzZSBmb3IgZXZlcnkgaW5jcmVhc2UgaW4gdGhlIHNpemUgb2Ygc2hpcCwgdGhlIHpvbmVzIGNvdmVyZWQgaW5jcmVhc2UgYnkgMiB1bml0c1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgY2hlY2tJZk9mZkxpbWl0Wm9uZVdhc0NvcnJlY3RseUltcGxlbWVudGVkLFxuICAgICAgICBnZXRMb2NhdGlvbixcbiAgICAgICAgcmVjZWl2ZUF0dGFjayxcbiAgICAgICAgY2hlY2tJZkFsbFNoaXBzSGF2ZVN1bmssXG4gICAgICAgIHBsYWNlU2hpcCxcbiAgICAgICAgcmFuZG9tbHlQbGFjZVNoaXBzLFxuICAgICAgICBtYWtlUmFuZG9tQ29vcmRpbmF0ZXMsXG4gICAgfVxufVxubW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVHYW1lQm9hcmRcbiIsImNvbnN0IGNyZWF0ZVBsYXllciA9IChuYW1lID0gJ3BsYXllcicpID0+IHtcbiAgICBjb25zdCBnZXROYW1lID0gKCkgPT4gbmFtZVxuXG4gICAgY29uc3QgYXR0YWNrID0gKGNvbHVtbiwgcm93LCB7IGdldExvY2F0aW9uLCByZWNlaXZlQXR0YWNrIH0pID0+IHtcbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSBnZXRMb2NhdGlvbihjb2x1bW4sIHJvdylcbiAgICAgICAgaWYgKGxvY2F0aW9uLmhhc0JlZW5IaXQgPT09IGZhbHNlIHx8IChsb2NhdGlvbi5pc1NoaXAgJiYgbG9jYXRpb24uZ2V0U3RhdHVzKCkuaW5jbHVkZXMoJ3VuaGl0JykgPT09IGZhbHNlKSkge1xuICAgICAgICAgICAgcmVjZWl2ZUF0dGFjayhjb2x1bW4sIHJvdylcbiAgICAgICAgICAgIGlmKGxvY2F0aW9uLmhpdCl7XG5cbiAgICAgICAgICAgICAgICBsb2NhdGlvbi5oaXQobG9jYXRpb24ucG9zaXRpb24pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gXCJJdCdzIGEgaGl0IVwiXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gJ1lvdSBoYXZlIGFscmVhZHkgaGl0IHRoaXMgc3BvdCEnXG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZ2V0TmFtZSxcbiAgICAgICAgYXR0YWNrLFxuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVQbGF5ZXJcbiIsImNvbnN0IGNyZWF0ZVNoaXAgPSAobGVuZ3RoLCBuYW1lID0gJ3NoaXAnKSA9PiB7XG5cbiAgICBjb25zdCBzdGF0dXMgPSBBcnJheShsZW5ndGgpLmZpbGwoJ3VuaGl0JylcblxuICAgIGNvbnN0IGdldExlbmd0aCA9ICgpID0+IHN0YXR1cy5sZW5ndGhcblxuICAgIGNvbnN0IGdldFN0YXR1cyA9ICgpID0+IHN0YXR1c1xuXG4gICAgY29uc3QgaGl0ID0gKHBvc2l0aW9uKSA9PiB7XG4gICAgICAgIGlmIChwb3NpdGlvbiA8IGxlbmd0aCkge1xuICAgICAgICAgICAgc3RhdHVzW3Bvc2l0aW9uXSA9ICdoaXQnXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBpc1N1bmsgPSAoKSA9PiBzdGF0dXMuZXZlcnkoKHBvc2l0aW9uKSA9PiBwb3NpdGlvbiA9PT0gJ2hpdCcpXG5cbiAgICByZXR1cm4ge1xuICAgICAgICBuYW1lLFxuICAgICAgICBnZXRMZW5ndGgsXG4gICAgICAgIGlzU3VuayxcbiAgICAgICAgaGl0LFxuICAgICAgICBnZXRTdGF0dXMsXG4gICAgICAgIGhhc0JlZW5IaXQ6IGZhbHNlLFxuICAgICAgICBpc1NoaXA6IHRydWUsXG4gICAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZVNoaXBcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gKG1vZHVsZSkgPT4ge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHQoKSA9PiAobW9kdWxlWydkZWZhdWx0J10pIDpcblx0XHQoKSA9PiAobW9kdWxlKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCJjb25zdCByZW5kZXJBdHRhY2tzID0gKHBsYXllciwgY29sdW1uLCByb3csIGVuZW15Qm9hcmQpID0+IHtcbiAgICBjb25zdCBjZWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgYC4ke3BsYXllcn0tYm9hcmQgPiAuY2VsbFtjb2x1bW49JyR7Y29sdW1ufSddW3Jvdz0nJHtyb3d9J11gXG4gICAgKVxuXG4gICAgY29uc3QgbG9jYXRpb24gPSBlbmVteUJvYXJkLmdldExvY2F0aW9uKGNvbHVtbiwgcm93KVxuICAgIGlmIChsb2NhdGlvbi5pc1NoaXApIHtcbiAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdoaXQnKVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnbWlzcycpXG4gICAgfVxufVxuXG5jb25zdCBoYW5kbGVBdHRhY2sgPSAoY29sdW1uLCByb3csIGVuZW15Qm9hcmQsIHBsYXllcikgPT5cbiAgICBwbGF5ZXIuYXR0YWNrKGNvbHVtbiwgcm93LCBlbmVteUJvYXJkKVxuXG5jb25zdCBhdHRhY2tFbmVteUNlbGwgPSAoY29sdW1uLCByb3csIGVuZW15Qm9hcmQsIHBsYXllcikgPT4ge1xuICAgIGhhbmRsZUF0dGFjayhjb2x1bW4sIHJvdywgZW5lbXlCb2FyZCwgcGxheWVyKVxuICAgIHJlbmRlckF0dGFja3MoJ2VuZW15JywgY29sdW1uLCByb3csIGVuZW15Qm9hcmQpXG59XG5cbmNvbnN0IGF0dGFja1BsYXllckNlbGwgPSAocGxheWVyQm9hcmQsIGVuZW15KSA9PiB7XG4gICAgY29uc3QgeyByYW5kb21Db2x1bW4sIHJhbmRvbVJvdyB9ID0gcGxheWVyQm9hcmQubWFrZVJhbmRvbUNvb3JkaW5hdGVzKClcbiAgICBoYW5kbGVBdHRhY2socmFuZG9tQ29sdW1uLCByYW5kb21Db2x1bW4sIHBsYXllckJvYXJkLCBlbmVteSlcbiAgICByZW5kZXJBdHRhY2tzKCdwbGF5ZXInLCByYW5kb21Db2x1bW4sIHJhbmRvbVJvdywgcGxheWVyQm9hcmQpXG59XG4vLyBodHRwczovL2pzbWFuaWZlc3QuY29tL3RoZS1wdWJsaXNoLXN1YnNjcmliZS1wYXR0ZXJuLWluLWphdmFzY3JpcHQvXG5cbmV4cG9ydCBjb25zdCBwdWJTdWIgPSAoKSA9PiB7XG4gICAgY29uc3Qgc3Vic2NyaWJlcnMgPSB7fVxuXG4gICAgZnVuY3Rpb24gcHVibGlzaChldmVudE5hbWUsIGRhdGEpIHtcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHN1YnNjcmliZXJzW2V2ZW50TmFtZV0pKSB7XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgICBzdWJzY3JpYmVyc1tldmVudE5hbWVdLmZvckVhY2goKGNhbGxiYWNrKSA9PiB7XG4gICAgICAgICAgICBjYWxsYmFjayhkYXRhKVxuICAgICAgICB9KVxuICAgIH1cbiAgICBmdW5jdGlvbiBzdWJzY3JpYmUoZXZlbnROYW1lLCBjYWxsYmFjaykge1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoc3Vic2NyaWJlW2V2ZW50TmFtZV0pKSB7XG4gICAgICAgICAgICBzdWJzY3JpYmVyc1tldmVudE5hbWVdID0gW11cbiAgICAgICAgfVxuICAgICAgICBzdWJzY3JpYmVyc1tldmVudE5hbWVdLnB1c2goY2FsbGJhY2spXG4gICAgICAgIGNvbnN0IGluZGV4ID0gc3Vic2NyaWJlcnNbZXZlbnROYW1lXS5sZW5ndGggLSAxXG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHVuc3Vic2NyaWJlKCkge1xuICAgICAgICAgICAgICAgIHN1YnNjcmliZXJzW2V2ZW50TmFtZV0uc3BsaWNlKGluZGV4LCAxKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIHB1Ymxpc2gsXG4gICAgICAgIHN1YnNjcmliZSxcbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCByZW5kZXJQbGF5ZXJTaGlwcyA9ICh7IGdldExvY2F0aW9uIH0pID0+IHtcbiAgICBjb25zdCBwbGF5ZXJCb2FyZEFyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXYucGxheWVyLWJvYXJkJylcblxuICAgIGZvciAobGV0IGNvbHVtbiA9IDA7IGNvbHVtbiA8IDEwOyBjb2x1bW4gKz0gMSkge1xuICAgICAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCAxMDsgcm93ICs9IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBwbGF5ZXJCb2FyZEFyZWEucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICAgICBgLmNlbGw6bnRoLWNoaWxkKCR7cm93ICogMTAgKyBjb2x1bW4gKyAxfSlgXG4gICAgICAgICAgICApXG4gICAgICAgICAgICBjZWxsLnNldEF0dHJpYnV0ZSgnY29sdW1uJywgY29sdW1uKVxuICAgICAgICAgICAgY2VsbC5zZXRBdHRyaWJ1dGUoJ3JvdycsIHJvdylcbiAgICAgICAgICAgIGlmIChnZXRMb2NhdGlvbihyb3csIGNvbHVtbikuaXNTaGlwKSB7XG4gICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdzaGlwJylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuY29uc3QgY2hlY2tJZkdhbWVPdmVyID0gKHBsYXllckJvYXJkLCBlbmVteUJvYXJkKSA9PiB7XG4gICAgaWYocGxheWVyQm9hcmQuY2hlY2tJZkFsbFNoaXBzSGF2ZVN1bmsoKSl7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsJyk7XG4gICAgICAgIGNvbnN0IG1vZGFsV2lubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWNvbnRlbnQgPiBwJylcbiAgICAgICAgY29uc3QgcGxheUFnYWluQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWNvbnRlbnQgPiBidXR0b24nKVxuXG4gICAgICAgIG1vZGFsLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCJcbiAgICAgICAgcGxheUFnYWluQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKClcbiAgICAgICAgfSlcblxuICAgICAgICBtb2RhbFdpbm5lci50ZXh0Q29udGVudCA9ICdZb3Ugd2luISdcblxuXG4gICAgfVxuICAgIGlmKGVuZW15Qm9hcmQuY2hlY2tJZkFsbFNoaXBzSGF2ZVN1bmsoKSl7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsJyk7XG4gICAgICAgIGNvbnN0IG1vZGFsV2lubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWNvbnRlbnQgPiBwJylcbiAgICAgICAgY29uc3QgcGxheUFnYWluQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWNvbnRlbnQgPiBidXR0b24nKVxuXG4gICAgICAgIG1vZGFsLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCJcbiAgICAgICAgbW9kYWxXaW5uZXIudGV4dENvbnRlbnQgPSAnWW91IGxvc2UhJ1xuICAgICAgICBwbGF5QWdhaW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKVxuICAgICAgICB9KVxuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IGFkZExpc3RlbmVyc1RvRW5lbXlCb2FyZCA9IChcbiAgICBwbGF5ZXJCb2FyZCxcbiAgICBlbmVteUJvYXJkLFxuICAgIHBsYXllcixcbiAgICBlbmVteSxcbiAgICBwc1xuKSA9PiB7XG4gICAgY29uc3QgZW5lbXlCb2FyZEFyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXYuZW5lbXktYm9hcmQnKVxuXG4gICAgZm9yIChsZXQgY29sdW1uID0gMDsgY29sdW1uIDwgMTA7IGNvbHVtbiArPSAxKSB7XG4gICAgICAgIGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IDEwOyByb3cgKz0gMSkge1xuICAgICAgICAgICAgLy8gQ3JlZGl0aW5nIGZvcm11bGEgdG8gY2FsY3VsYXRlIG50aC1jaGlsZCB1c2luZyBuZXN0ZWQgbG9vcDogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvODg3MjY2Mi9tYXRoLXRvLWRldGVybWluZS1pdGVtLWluZGV4LWJhc2VkLW9uLWNvbC1yb3ctc2VsZWN0aW9uLWluLWdyaWRcbiAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBlbmVteUJvYXJkQXJlYS5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgICAgIGAuY2VsbDpudGgtY2hpbGQoJHtyb3cgKiAxMCArIGNvbHVtbiArIDF9KWBcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIGNlbGwuc2V0QXR0cmlidXRlKCdjb2x1bW4nLCBjb2x1bW4pXG4gICAgICAgICAgICBjZWxsLnNldEF0dHJpYnV0ZSgncm93Jywgcm93KVxuXG4gICAgICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICAgICAgJ2NsaWNrJyxcbiAgICAgICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHBzLnB1Ymxpc2goJ2NsaWNrJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2VsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllckJvYXJkLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5lbXlCb2FyZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXllcixcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZW15LFxuICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7IG9uY2U6IHRydWUgfVxuICAgICAgICAgICAgKVxuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgY29uc3QgYXR0YWNrID0gKHtcbiAgICBjZWxsLFxuICAgIGNvbHVtbixcbiAgICByb3csXG4gICAgcGxheWVyQm9hcmQsXG4gICAgZW5lbXlCb2FyZCxcbiAgICBwbGF5ZXIsXG4gICAgZW5lbXksXG59KSA9PiB7XG4gICAgLy8gaHVtYW4gcGxheWVyIGF0dGFja2luZyBjb21wdXRlclxuICAgIGF0dGFja0VuZW15Q2VsbChjb2x1bW4sIHJvdywgZW5lbXlCb2FyZCwgcGxheWVyKVxuICAgIC8vIGNvbXB1dGVyIGF0dGFja2luZyBodW1hblxuICAgIGF0dGFja1BsYXllckNlbGwocGxheWVyQm9hcmQsIGVuZW15KVxuXG4gICAgY2hlY2tJZkdhbWVPdmVyKHBsYXllckJvYXJkLCBlbmVteUJvYXJkKVxuXG59XG4iLCJpbXBvcnQgeyBhZGRMaXN0ZW5lcnNUb0VuZW15Qm9hcmQsIHJlbmRlclBsYXllclNoaXBzLHB1YlN1YiwgYXR0YWNrfSBmcm9tICcuL2RvbSdcblxuaW1wb3J0IGNyZWF0ZUdhbWVCb2FyZCBmcm9tICcuL2dhbWVib2FyZC9nYW1lYm9hcmQnXG5pbXBvcnQgY3JlYXRlU2hpcCBmcm9tICcuL3NoaXAvc2hpcCdcbmltcG9ydCBjcmVhdGVQbGF5ZXIgZnJvbSAnLi9wbGF5ZXIvcGxheWVyJ1xuXG5jb25zdCBwbGF5ZXJCb2FyZCA9IGNyZWF0ZUdhbWVCb2FyZCgpXG5jb25zdCBlbmVteUJvYXJkID0gY3JlYXRlR2FtZUJvYXJkKClcblxuY29uc3QgcGxheWVyID0gY3JlYXRlUGxheWVyKClcblxuY29uc3QgY29tcHV0ZXIgPSBjcmVhdGVQbGF5ZXIoKVxuXG5wbGF5ZXJCb2FyZC5yYW5kb21seVBsYWNlU2hpcHMoKVxuZW5lbXlCb2FyZC5yYW5kb21seVBsYWNlU2hpcHMoKVxucGxheWVyQm9hcmQucGxhY2VTaGlwKDAsIDAsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCg1KSlcbnBsYXllckJvYXJkLnBsYWNlU2hpcCgzLCA0LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMykpXG5wbGF5ZXJCb2FyZC5wbGFjZVNoaXAoNiwgNywgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDIpKVxucGxheWVyQm9hcmQucGxhY2VTaGlwKDksIDEsICd2ZXJ0aWNhbCcsIGNyZWF0ZVNoaXAoMykpXG5wbGF5ZXJCb2FyZC5wbGFjZVNoaXAoNSwgOSwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDQpKVxuXG5lbmVteUJvYXJkLnBsYWNlU2hpcCgwLCAwLCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoNSkpXG5lbmVteUJvYXJkLnBsYWNlU2hpcCgzLCA0LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMykpXG5lbmVteUJvYXJkLnBsYWNlU2hpcCg2LCA3LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMikpXG5lbmVteUJvYXJkLnBsYWNlU2hpcCg5LCAxLCAndmVydGljYWwnLCBjcmVhdGVTaGlwKDMpKVxuZW5lbXlCb2FyZC5wbGFjZVNoaXAoNSwgOSwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDQpKVxuXG5jb25zdCBwcyA9IHB1YlN1YigpXG5cbmFkZExpc3RlbmVyc1RvRW5lbXlCb2FyZChwbGF5ZXJCb2FyZCwgZW5lbXlCb2FyZCwgcGxheWVyLCBjb21wdXRlciwgcHMpXG5cbnBzLnN1YnNjcmliZSgnY2xpY2snLCBhdHRhY2spXG5cblxuXG5cbnJlbmRlclBsYXllclNoaXBzKHBsYXllckJvYXJkKSJdLCJuYW1lcyI6WyJjcmVhdGVTaGlwIiwibW9kdWxlIiwiZXhwb3J0cyIsImVtcHR5Q2VsbCIsImhhc0JlZW5IaXQiLCJpc1NoaXAiLCJvZmZMaW1pdHMiLCJnYW1lQm9hcmQiLCJBcnJheSIsImZpbGwiLCJpIiwiaiIsImNvbHVtbiIsInJvdyIsImluaXRpYWxpemVCb2FyZCIsInNoaXBzIiwiZ2V0TG9jYXRpb24iLCJzZXRMb2NhdGlvbiIsInNoaXAiLCJPYmplY3QiLCJhc3NpZ24iLCJjcmVhdGVPZmZMaW1pdExvY2F0aW9uIiwidW5kZWZpbmVkIiwiYWRkT2ZmTGltaXRBcmVhRm9yU2hpcHMiLCJtYWtlUmFuZG9tQ29vcmRpbmF0ZXMiLCJyYW5kb21EaXJlY3Rpb24iLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJyYW5kb21Mb2NhdGlvbiIsImZsYXQiLCJmaWx0ZXIiLCJjZWxsIiwibGVuZ3RoIiwiY2hlY2tJZk9mZkxpbWl0Wm9uZVdhc0NvcnJlY3RseUltcGxlbWVudGVkIiwic2hpcExlbmd0aCIsImVsZW1lbnQiLCJyZWNlaXZlQXR0YWNrIiwiY2hlY2tJZkFsbFNoaXBzSGF2ZVN1bmsiLCJoYXZlQWxsU2hpcHNTdW5rIiwibG9jYXRpb24iLCJpc1N1bmsiLCJwbGFjZVNoaXAiLCJkaXJlY3Rpb24iLCJnZXRMZW5ndGgiLCJjaGVja0lmTG9jYXRpb25Jc0FTaGlwT3JPZmZMaW1pdHMiLCJjaGVja0lmUm93Q29vcmRpbmF0ZUlzVmFsaWQiLCJwb3NpdGlvbiIsImFkZE9mZkxpbWl0QXJlYUZvclZlcnRpY2FsbHlQb3NpdGlvbmVkU2hpcCIsImNoZWNrSWZDb2x1bW5Db29yZGluYXRlSXNWYWxpZCIsImFkZE9mZkxpbWl0QXJlYUZvckhvcml6b250YWxseVBvc2l0aW9uZWRTaGlwIiwicmFuZG9tbHlQbGFjZVNoaXBzIiwic2hpcHNEZXRhaWxzIiwiZmxhdHRlbmVkR2FtZUJvYXJkIiwiZWxlbWVudEluZGV4IiwiZmluZEluZGV4IiwiaW5kZXgiLCJlbGVtZW50Q29sdW1uIiwiZWxlbWVudFJvdyIsInB1c2giLCJuYW1lIiwiZ2V0TmFtZSIsImF0dGFjayIsImdldFN0YXR1cyIsImluY2x1ZGVzIiwiaGl0Iiwic3RhdHVzIiwiZXZlcnkiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwibiIsImdldHRlciIsIl9fZXNNb2R1bGUiLCJkIiwiYSIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsInJlbmRlckF0dGFja3MiLCJwbGF5ZXIiLCJlbmVteUJvYXJkIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xhc3NMaXN0IiwiYWRkIiwiaGFuZGxlQXR0YWNrIiwicGxheWVyQm9hcmQiLCJjb21wdXRlciIsInBzIiwic3Vic2NyaWJlcnMiLCJwdWJsaXNoIiwiZXZlbnROYW1lIiwiZGF0YSIsImlzQXJyYXkiLCJmb3JFYWNoIiwiY2FsbGJhY2siLCJzdWJzY3JpYmUiLCJ1bnN1YnNjcmliZSIsInNwbGljZSIsInB1YlN1YiIsImVuZW15IiwiZW5lbXlCb2FyZEFyZWEiLCJzZXRBdHRyaWJ1dGUiLCJhZGRFdmVudExpc3RlbmVyIiwib25jZSIsImFkZExpc3RlbmVyc1RvRW5lbXlCb2FyZCIsImF0dGFja0VuZW15Q2VsbCIsInJhbmRvbUNvbHVtbiIsInJhbmRvbVJvdyIsImF0dGFja1BsYXllckNlbGwiLCJtb2RhbCIsIm1vZGFsV2lubmVyIiwicGxheUFnYWluQnV0dG9uIiwic3R5bGUiLCJkaXNwbGF5IiwicmVsb2FkIiwidGV4dENvbnRlbnQiLCJjaGVja0lmR2FtZU92ZXIiLCJwbGF5ZXJCb2FyZEFyZWEiLCJyZW5kZXJQbGF5ZXJTaGlwcyJdLCJzb3VyY2VSb290IjoiIn0=