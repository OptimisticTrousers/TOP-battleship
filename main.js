(()=>{var e={653:(e,t,o)=>{const r=o(585);e.exports=()=>{const e={hasBeenHit:!1,isShip:!1,offLimits:!1},t=()=>{const t=Array(10).fill().map((()=>Array(10).fill()));for(let o=0;o<10;o++)for(let r=0;r<10;r++)t[o][r]={...e,column:o,row:r};return t};let o=t();const i=[r(5,"Carrier"),r(4,"Battleship"),r(3,"Destroyer"),r(3,"Submarine"),r(2,"Patrol Boat")],n=(e,t)=>o?.[e]?.[t],a=(t,r,i=(()=>Object.assign(e,{offLimits:!0}))())=>{if(void 0===o?.[t]?.[r])return!0;const n=o[t][r];return o[t][r]={...n,...i},!0},l=(e,t)=>{a(e-1,t-1),a(e,t-1)},c=(e,t,o,r)=>{if("vertical"===o)for(let o=0;o<r;o++){const r=n(e,t+o);if(r&&!0===r.isShip&&!0===r.offLimits)return!1}if("horizontal"===o)for(let o=0;o<r;o++){const r=n(e+o,t);if(r&&!0===r.isShip&&!0===r.offLimits)return!1}return!1},s=(e,t,r,i)=>{const s=i.getLength();if(c(n(e,t)))return!1;if("vertical"===r){if(((e,t)=>e>=0&&e+t-1<o.length)(t,s)){for(let o=0;o<s;o+=1)a(e,t+o,{...i,position:o}),a(e+1,t+o),a(e-1,t+o);return((e,t,o)=>{l(e,t),a(e,t+o),a(e+1,t+o),a(e-1,t+o),a(e+1,t-1)})(e,t,s),!0}}else if("horizontal"===r&&((e,t)=>e>=0&&e+t-1<o.length)(e,s)){for(let o=0;o<s;o+=1)a(e+o,t,{...i,position:o}),a(e+o,t+1),a(e+o,t-1);return((e,t,o)=>{l(e,t),a(e+o,t),a(e-1,t+1),a(e+o,t+1),a(e+o,t-1)})(e,t,s),!0}return!1},h=()=>{const e=0===Math.floor(2*Math.random())?"vertical":"horizontal",t=Math.floor(100*Math.random()),r=(()=>{const e=[...o.flat()];return e.forEach((e=>{!0===e.hasBeenHit?e.availability=!1:e.availability=!0})),e})()[t];return!1===r.availability?h():{elementColumn:r.column,elementRow:r.row,randomDirection:e}};return{clearBoard:()=>{o=t()},checkIfLocationIsAShipOrOffLimits:c,checkIfOffLimitZoneWasCorrectlyImplemented:e=>o.flat().filter((e=>!0===e.offLimits)).length===e+2,getLocation:n,receiveAttack:(e,t)=>{o[e][t].hasBeenHit=!0},checkIfAllShipsHaveSunk:()=>{let e=!0;for(let t=0;t<10;t++)for(let o=0;o<10;o++){const r=n(t,o);if(!1!==r.isShip&&r.isShip&&!1===r.isSunk()){e=!1;break}}return e},placeShip:s,randomlyPlaceShips:()=>{const e=[];for(let t=0;t<i.length;t+=1){const o=i[t],{randomColumn:r,randomRow:n,randomDirection:a}=h(o.getLength());s(r,n,a,o)?e.push({randomColumn:r,randomRow:n,randomDirection:a}):t-=1}return e},makeRandomCoordinates:h}}},61:e=>{e.exports=(e="player")=>({getName:()=>e,attack:(e,t,{getLocation:o,receiveAttack:r})=>{const i=o(e,t);return!1===i.hasBeenHit||i.isShip&&!1===i.getStatus().includes("unhit")?(r(e,t),i.hit?(i.hit(i.position),"You hit a ship!"):"It's a hit!"):"You have already hit this spot!"}})},585:e=>{e.exports=(e,t="ship")=>{const o=Array(e).fill("unhit");return{getName:()=>t,getLength:()=>o.length,isSunk:()=>o.every((e=>"hit"===e)),hit:t=>{t<e&&(o[t]="hit")},getStatus:()=>o,hasBeenHit:!1,offLimits:!0,isShip:!0}}}},t={};function o(r){var i=t[r];if(void 0!==i)return i.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,o),n.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=o(653),t=o.n(e),r=o(585),i=o.n(r);const n=(e,t,o,r)=>{const i=document.querySelector(`.${e}-board > .cell[column='${t}'][row='${o}']`);r.getLocation(t,o).isShip?i.classList.add("hit"):i.classList.add("miss")},a=(e,t,o,r)=>r.attack(e,t,o),l=(e,t,o)=>{const r=((e,t,o)=>{const r=o.getLocation(e+1,t),i=o.getLocation(e-1,t),n=o.getLocation(e,t+1),a=o.getLocation(e,t-1),l=[];return r&&!r.hasBeenHit&&l.push(r),i&&!i.hasBeenHit&&l.push(i),n&&!n.hasBeenHit&&l.push(n),a&&!a.hasBeenHit&&l.push(a),l})(e,t,o),i=Math.floor(Math.random()*r.length);return r[i]?r[i]:l(e,t,o)},c=(e,t,o)=>{const r={location(){return o.getLocation(this.column,this.row)}},i=Object.assign(Object.create(r),{column:e,row:t-1}),n=Object.assign(Object.create(r),{column:e,row:t+1}),a=Object.assign(Object.create(r),{column:e+1,row:t}),l=Object.assign(Object.create(r),{column:e-1,row:t}),c=[];return c.push(i),c.push(n),c.push(a),c.push(l),c},s=(e,t,o,r,i)=>{const h=e.getLocation(o,r);if("You hit a ship!"===a(o,r,e,t)){const n=l(o,r,e),a=n.column,u=c(o,r,e).filter((e=>void 0!==e.column&&void 0!==e.row)),p=n.row;if(h.isShip&&!1===h.isSunk())switch(Math.floor(Math.random()*u.length)){case 0:s(e,t,u[0].column,u[0].row,h);break;case 1:s(e,t,u[1].column,u[1].row,h);break;case 2:s(e,t,u[2].column,u[2].row,h);break;case 3:s(e,t,u[3].column,u[3].row,h)}setTimeout((()=>{s(e,t,a,p,i)}),700)}else if(h&&!1===h.isShip&&i&&!0===i.isShip){let n,a;i.getLength(),i.column>o&&(a=i.column-(i.column-o)),i.column<o&&(a=i.column+(o-i.column)),i.row>r&&(n=i.row-(i.row-r)),i.row<r&&(n=i.row+(r-i.row)),setTimeout((()=>{!1===i.isSunk()&&s(e,t,a,n,i)}),700)}setTimeout((()=>{n("player",o,r,e)}),700)},h=({getLocation:e})=>{const t=document.querySelector("div.player-board");for(let o=0;o<10;o+=1)for(let r=0;r<10;r+=1){const i=t.querySelector(`.cell:nth-child(${10*r+o+1})`);i.setAttribute("column",o),i.setAttribute("row",r);const n=e(o,r);n.isShip&&(i.classList.add("ship"),i.setAttribute("ship-name",n.getName()),i.setAttribute("draggable",!0))}};var u=o(61),p=o.n(u);const m=t()(),d=t()(),f=p()(),S=p()();i()(5,"Carrier"),i()(4,"Battleship"),i()(3,"Destroyer"),i()(3,"Submarine"),i()(2,"Patrol Boat"),document.querySelector("button.randomize").addEventListener("click",(()=>{(e=>{switch(e.clearBoard(),document.querySelectorAll(".player-board > .cell").forEach((e=>{e.classList.remove("ship"),e.classList.remove("hit"),e.classList.remove("miss")})),Math.floor(4*Math.random())){case 0:e.placeShip(9,1,"vertical",i()(5)),e.placeShip(0,3,"horizontal",i()(3)),e.placeShip(3,6,"horizontal",i()(2)),e.placeShip(6,5,"horizontal",i()(3)),e.placeShip(3,9,"horizontal",i()(4));break;case 1:e.placeShip(0,2,"horizontal",i()(5)),e.placeShip(4,5,"horizontal",i()(3)),e.placeShip(8,7,"horizontal",i()(2)),e.placeShip(5,9,"horizontal",i()(3)),e.placeShip(6,3,"horizontal",i()(4));break;case 2:e.placeShip(5,1,"horizontal",i()(5)),e.placeShip(3,3,"vertical",i()(3)),e.placeShip(0,0,"vertical",i()(2)),e.placeShip(6,5,"horizontal",i()(3)),e.placeShip(5,9,"horizontal",i()(4));break;default:e.placeShip(0,0,"horizontal",i()(5)),e.placeShip(3,4,"horizontal",i()(3)),e.placeShip(6,7,"horizontal",i()(2)),e.placeShip(9,1,"vertical",i()(3)),e.placeShip(5,9,"horizontal",i()(4))}h(e)})(m)})),d.placeShip(0,0,"horizontal",i()(5)),d.placeShip(3,4,"horizontal",i()(3)),d.placeShip(6,7,"horizontal",i()(2)),d.placeShip(9,1,"vertical",i()(3)),d.placeShip(5,9,"horizontal",i()(4));const y=(()=>{const e={};return{publish:function(t,o){Array.isArray(e[t])&&e[t].forEach((e=>{e(o)}))},subscribe:function t(o,r){Array.isArray(t[o])||(e[o]=[]),e[o].push(r);const i=e[o].length-1;return{unsubscribe(){e[o].splice(i,1)}}}}})();((e,t,o,r,i)=>{const n=document.querySelector("div.enemy-board");for(let a=0;a<10;a+=1)for(let l=0;l<10;l+=1){const c=n.querySelector(`.cell:nth-child(${10*l+a+1})`);c.setAttribute("column",a),c.setAttribute("row",l),c.addEventListener("click",(()=>{i.publish("click",{cell:c,column:a,row:l,playerBoard:e,enemyBoard:t,player:o,enemy:r})}),{once:!0})}})(m,d,f,S,y),y.subscribe("click",(({cell:e,column:t,row:o,playerBoard:r,enemyBoard:i,player:l,enemy:c})=>{((e,t,o,r)=>{a(e,t,o,r),n("enemy",e,t,o)})(t,o,i,l);const{elementColumn:h,elementRow:u}=r.makeRandomCoordinates();s(r,c,h,u),((e,t)=>{if(e.checkIfAllShipsHaveSunk()){const e=document.querySelector(".modal"),t=document.querySelector(".modal-content > p"),o=document.querySelector(".modal-content > button");e.style.display="block",o.addEventListener("click",(()=>{location.reload()})),t.textContent="You lose!"}if(t.checkIfAllShipsHaveSunk()){const e=document.querySelector(".modal"),t=document.querySelector(".modal-content > p"),o=document.querySelector(".modal-content > button");e.style.display="block",t.textContent="You win!",o.addEventListener("click",(()=>{location.reload()}))}})(r,i)})),h(m)})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LFNBQVNDLGNBQWMsVUFDL0J5RCxFQUFjMUQsU0FBU0MsY0FBYyxzQkFDckMwRCxFQUFrQjNELFNBQVNDLGNBQzdCLDJCQUdKd0QsRUFBTUcsTUFBTUMsUUFBVSxRQUN0QkYsRUFBZ0J0QixpQkFBaUIsU0FBUyxLQUN0Qy9HLFNBQVN3SSxZQUdiSixFQUFZSyxZQUFjLFlBRTlCLEdBQUlqRSxFQUFXeEMsMEJBQTJCLENBQ3RDLE1BQU1tRyxFQUFRekQsU0FBU0MsY0FBYyxVQUMvQnlELEVBQWMxRCxTQUFTQyxjQUFjLHNCQUNyQzBELEVBQWtCM0QsU0FBU0MsY0FDN0IsMkJBR0p3RCxFQUFNRyxNQUFNQyxRQUFVLFFBQ3RCSCxFQUFZSyxZQUFjLFdBQzFCSixFQUFnQnRCLGlCQUFpQixTQUFTLEtBQ3RDL0csU0FBU3dJLGNBa0hqQkUsQ0FBZ0IxRCxFQUFhUixNQ25jakNtQyxFQUFrQjNCLEkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b3AtYmF0dGxlc2hpcC8uL3NyYy9nYW1lYm9hcmQvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL3RvcC1iYXR0bGVzaGlwLy4vc3JjL3BsYXllci9wbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vdG9wLWJhdHRsZXNoaXAvLi9zcmMvc2hpcC9zaGlwLmpzIiwid2VicGFjazovL3RvcC1iYXR0bGVzaGlwL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3RvcC1iYXR0bGVzaGlwL3dlYnBhY2svcnVudGltZS9jb21wYXQgZ2V0IGRlZmF1bHQgZXhwb3J0Iiwid2VicGFjazovL3RvcC1iYXR0bGVzaGlwL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly90b3AtYmF0dGxlc2hpcC93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3RvcC1iYXR0bGVzaGlwLy4vc3JjL2RvbS5qcyIsIndlYnBhY2s6Ly90b3AtYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcbi8qIGVzbGludC1kaXNhYmxlIG5vLW11bHRpLWFzc2lnbiAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLWV4cHJlc3Npb25zICovXG5jb25zdCBjcmVhdGVTaGlwID0gcmVxdWlyZSgnLi4vc2hpcC9zaGlwJylcblxuLyogZXNsaW50LWRpc2FibGUgbm8tcGFyYW0tcmVhc3NpZ24gKi9cbmNvbnN0IGNyZWF0ZUdhbWVCb2FyZCA9ICgpID0+IHtcbiAgICBjb25zdCBlbXB0eUNlbGwgPSB7IGhhc0JlZW5IaXQ6IGZhbHNlLCBpc1NoaXA6IGZhbHNlLCBvZmZMaW1pdHM6IGZhbHNlIH1cbiAgICBcbiAgICBjb25zdCBpbml0aWFsaXplQm9hcmQgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGdhbWVCb2FyZCA9IEFycmF5KDEwKS5maWxsKCkubWFwKCgpID0+IEFycmF5KDEwKS5maWxsKCkpXG4gICAgICAgIGZvcihsZXQgY29sdW1uPSAwOyBjb2x1bW4gPCAxMDsgY29sdW1uKyspe1xuICAgICAgICAgICAgZm9yKGxldCByb3c9IDA7IHJvdyA8IDEwOyByb3crKyl7XG4gICAgICAgICAgICAgICAgZ2FtZUJvYXJkW2NvbHVtbl1bcm93XSA9IHsuLi5lbXB0eUNlbGwsIGNvbHVtbiwgcm93fVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBnYW1lQm9hcmRcbiAgICBcbiAgICB9XG5cbiAgICBsZXQgZ2FtZUJvYXJkID0gaW5pdGlhbGl6ZUJvYXJkKClcblxuICAgIGNvbnN0IHNoaXBzID0gW1xuICAgICAgICBjcmVhdGVTaGlwKDUsICdDYXJyaWVyJyksXG4gICAgICAgIGNyZWF0ZVNoaXAoNCwgJ0JhdHRsZXNoaXAnKSxcbiAgICAgICAgY3JlYXRlU2hpcCgzLCAnRGVzdHJveWVyJyksXG4gICAgICAgIGNyZWF0ZVNoaXAoMywgJ1N1Ym1hcmluZScpLFxuICAgICAgICBjcmVhdGVTaGlwKDIsICdQYXRyb2wgQm9hdCcpLFxuICAgIF1cblxuXG4gICAgY29uc3QgY3JlYXRlT2ZmTGltaXRMb2NhdGlvbiA9ICgpID0+XG4gICAgICAgIE9iamVjdC5hc3NpZ24oZW1wdHlDZWxsLCB7IG9mZkxpbWl0czogdHJ1ZSB9KVxuXG4gICAgY29uc3QgZ2V0TG9jYXRpb24gPSAoY29sdW1uLCByb3cpID0+IGdhbWVCb2FyZD8uW2NvbHVtbl0/Lltyb3ddXG5cbiAgICBjb25zdCBzZXRMb2NhdGlvbiA9IChjb2x1bW4sIHJvdywgc2hpcCA9IGNyZWF0ZU9mZkxpbWl0TG9jYXRpb24oKSkgPT4ge1xuICAgICAgICBpZiAoZ2FtZUJvYXJkPy5bY29sdW1uXT8uW3Jvd10gPT09IHVuZGVmaW5lZCkgcmV0dXJuIHRydWVcbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSBnYW1lQm9hcmRbY29sdW1uXVtyb3ddXG5cbiAgICAgICAgZ2FtZUJvYXJkW2NvbHVtbl1bcm93XSA9IHsuLi5sb2NhdGlvbiwgLi4uc2hpcH1cbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gICAgY29uc3QgY2hlY2tJZkFsbFNoaXBzSGF2ZVN1bmsgPSAoKSA9PiB7XG5cbiAgICAgICAgbGV0IGhhdmVBbGxTaGlwc1N1bmsgPXRydWUgIFxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICAgIGNvbnN0IGxvY2F0aW9uID0gZ2V0TG9jYXRpb24oaSwgailcbiAgICAgICAgaWYobG9jYXRpb24uaXNTaGlwID09PSBmYWxzZSkgY29udGludWVcbiAgICAgICAgaWYobG9jYXRpb24uaXNTaGlwICYmIGxvY2F0aW9uLmlzU3VuaygpID09PSBmYWxzZSl7XG4gICAgICAgICAgIGhhdmVBbGxTaGlwc1N1bmsgPSBmYWxzZSBcbiAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGhhdmVBbGxTaGlwc1N1bmsgXG4gICAgfVxuXG4gICAgY29uc3QgYWRkT2ZmTGltaXRBcmVhRm9yU2hpcHMgPSAoY29sdW1uLCByb3cpID0+IHtcbiAgICAgICAgLy8gdG9wLWxlZnRcbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uIC0gMSwgcm93IC0gMSlcbiAgICAgICAgLy8gdG9wXG4gICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiwgcm93IC0gMSlcbiAgICB9XG5cbiAgICBjb25zdCBhZGRPZmZMaW1pdEFyZWFGb3JIb3Jpem9udGFsbHlQb3NpdGlvbmVkU2hpcCA9IChcbiAgICAgICAgY29sdW1uLFxuICAgICAgICByb3csXG4gICAgICAgIHNoaXBMZW5ndGhcbiAgICApID0+IHtcbiAgICAgICAgLy8gcG9zaXRpb25zIHJlbGF0aXZlIHRvIHRoZSBzaGlwIGl0c2VsZihpZS4gYSBob3Jpem9udGFsIHNoaXAncyBib3R0b20gaXMgdG8gdGhlIHJpZ2h0KVxuXG4gICAgICAgIGFkZE9mZkxpbWl0QXJlYUZvclNoaXBzKGNvbHVtbiwgcm93KVxuICAgICAgICAvLyBib3R0b21cbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uICsgc2hpcExlbmd0aCwgcm93KVxuICAgICAgICAvLyBib3R0b20tbGVmdFxuICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gLSAxLCByb3cgKyAxKVxuICAgICAgICAvLyBib3R0b20tcmlnaHRcbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uICsgc2hpcExlbmd0aCwgcm93ICsgMSlcbiAgICAgICAgLy8gdG9wLXJpZ2h0XG4gICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIHNoaXBMZW5ndGgsIHJvdyAtIDEpXG4gICAgfVxuXG4gICAgY29uc3QgYWRkT2ZmTGltaXRBcmVhRm9yVmVydGljYWxseVBvc2l0aW9uZWRTaGlwID0gKFxuICAgICAgICBjb2x1bW4sXG4gICAgICAgIHJvdyxcbiAgICAgICAgc2hpcExlbmd0aFxuICAgICkgPT4ge1xuICAgICAgICAvLyBwb3NpdGlvbnMgcmVsYXRpdmUgdG8gaG93IHRoZSB1c2VyIHNlZXMgaXQoaWUuIGEgdmVydGljYWwgc2hpcCdzIGJvdHRvbSBpcyB0byB0aGUgYm90dG9tKVxuXG4gICAgICAgIGFkZE9mZkxpbWl0QXJlYUZvclNoaXBzKGNvbHVtbiwgcm93KVxuICAgICAgICAvLyBib3R0b21cbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uLCByb3cgKyBzaGlwTGVuZ3RoKVxuICAgICAgICAvLyBib3R0b20tcmlnaHRcbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uICsgMSwgcm93ICsgc2hpcExlbmd0aClcbiAgICAgICAgLy8gYm90dG9tLWxlZnRcbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uIC0gMSwgcm93ICsgc2hpcExlbmd0aClcbiAgICAgICAgLy8gdG9wLXJpZ2h0XG4gICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIDEsIHJvdyAtIDEpXG4gICAgfVxuXG4gICAgY29uc3QgY2hlY2tJZkNvbHVtbkNvb3JkaW5hdGVJc1ZhbGlkID0gKGNvbHVtbiwgc2hpcExlbmd0aCkgPT5cbiAgICAgICAgY29sdW1uID49IDAgJiYgY29sdW1uICsgc2hpcExlbmd0aCAtIDEgPCBnYW1lQm9hcmQubGVuZ3RoXG5cbiAgICBjb25zdCBjaGVja0lmUm93Q29vcmRpbmF0ZUlzVmFsaWQgPSAocm93LCBzaGlwTGVuZ3RoKSA9PlxuICAgICAgICByb3cgPj0gMCAmJiByb3cgKyBzaGlwTGVuZ3RoIC0gMSA8IGdhbWVCb2FyZC5sZW5ndGhcblxuXG4gICAgY29uc3QgY2hlY2tJZkxvY2F0aW9uSXNBU2hpcE9yT2ZmTGltaXRzID0gKFxuICAgICAgICBjb2x1bW4sXG4gICAgICAgIHJvdyxcbiAgICAgICAgZGlyZWN0aW9uLFxuICAgICAgICBzaGlwTGVuZ3RoXG4gICAgKSA9PiB7XG4gICAgICAgIGlmIChkaXJlY3Rpb24gPT09ICd2ZXJ0aWNhbCcpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcExlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbG9jYXRpb24gPSBnZXRMb2NhdGlvbihjb2x1bW4sIHJvdyArIGkpXG4gICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmlzU2hpcCA9PT0gdHJ1ZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24ub2ZmTGltaXRzID09PSB0cnVlXG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGlyZWN0aW9uID09PSAnaG9yaXpvbnRhbCcpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcExlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbG9jYXRpb24gPSBnZXRMb2NhdGlvbihjb2x1bW4gKyBpLCByb3cpXG4gICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmlzU2hpcCA9PT0gdHJ1ZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24ub2ZmTGltaXRzID09PSB0cnVlXG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICBjb25zdCBwbGFjZVNoaXAgPSAoY29sdW1uLCByb3csIGRpcmVjdGlvbiwgc2hpcCkgPT4ge1xuICAgICAgICBjb25zdCBzaGlwTGVuZ3RoID0gc2hpcC5nZXRMZW5ndGgoKVxuICAgICAgICBpZiAoY2hlY2tJZkxvY2F0aW9uSXNBU2hpcE9yT2ZmTGltaXRzKGdldExvY2F0aW9uKGNvbHVtbiwgcm93LCBkaXJlY3Rpb24sIHNoaXBMZW5ndGgpKSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICBpZiAoZGlyZWN0aW9uID09PSAndmVydGljYWwnKSB7XG4gICAgICAgICAgICBpZiAoY2hlY2tJZlJvd0Nvb3JkaW5hdGVJc1ZhbGlkKHJvdywgc2hpcExlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaXBMZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4sIHJvdyArIGksIHsuLi5zaGlwLCBwb3NpdGlvbjogaX0pXG4gICAgICAgICAgICAgICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIDEsIHJvdyArIGkpXG4gICAgICAgICAgICAgICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiAtIDEsIHJvdyArIGkpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFkZE9mZkxpbWl0QXJlYUZvclZlcnRpY2FsbHlQb3NpdGlvbmVkU2hpcChcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uLFxuICAgICAgICAgICAgICAgICAgICByb3csXG4gICAgICAgICAgICAgICAgICAgIHNoaXBMZW5ndGhcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICdob3Jpem9udGFsJykge1xuICAgICAgICAgICAgaWYgKGNoZWNrSWZDb2x1bW5Db29yZGluYXRlSXNWYWxpZChjb2x1bW4sIHNoaXBMZW5ndGgpKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwTGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uICsgaSAsIHJvdywgey4uLnNoaXAsIHBvc2l0aW9uOiBpfSlcbiAgICAgICAgICAgICAgICAgICAgLy9zZXRMb2NhdGlvbihjb2x1bW4gKyBpLCByb3csIHNoaXApXG4gICAgICAgICAgICAgICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIGksIHJvdyArIDEpXG4gICAgICAgICAgICAgICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIGksIHJvdyAtIDEpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFkZE9mZkxpbWl0QXJlYUZvckhvcml6b250YWxseVBvc2l0aW9uZWRTaGlwKFxuICAgICAgICAgICAgICAgICAgICBjb2x1bW4sXG4gICAgICAgICAgICAgICAgICAgIHJvdyxcbiAgICAgICAgICAgICAgICAgICAgc2hpcExlbmd0aFxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICAgICAgY29uc3QgYXZhaWxhYmxlU3BhY2VzID0gKCkgPT57XG5cbiAgICAgICAgY29uc3QgZmxhdHRlbmVkR2FtZUJvYXJkID0gWy4uLmdhbWVCb2FyZC5mbGF0KCldXG5cbiAgICAgICAgICAgIGZsYXR0ZW5lZEdhbWVCb2FyZC5mb3JFYWNoKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYoZWxlbWVudC5oYXNCZWVuSGl0ID09PSB0cnVlKXtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hdmFpbGFiaWxpdHkgPSBmYWxzZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmF2YWlsYWJpbGl0eSA9dHJ1ZSAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgcmV0dXJuIGZsYXR0ZW5lZEdhbWVCb2FyZFxuXG4gICAgICAgIH1cbiAgICBjb25zdCBtYWtlUmFuZG9tQ29vcmRpbmF0ZXMgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJhbmRvbURpcmVjdGlvbiA9XG4gICAgICAgICAgICBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKSA9PT0gMCA/ICd2ZXJ0aWNhbCcgOiAnaG9yaXpvbnRhbCdcbiAgICAgICAgY29uc3QgcmFuZG9tTG9jYXRpb24gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApXG4gICAgICAgIGNvbnN0IGZsYXR0ZW5lZEdhbWVCb2FyZCA9IGF2YWlsYWJsZVNwYWNlcygpXG5cbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSBmbGF0dGVuZWRHYW1lQm9hcmRbcmFuZG9tTG9jYXRpb25dXG5cbiAgICAgICAgaWYobG9jYXRpb24uYXZhaWxhYmlsaXR5ID09PSBmYWxzZSl7XG4gICAgICAgICAgICByZXR1cm4gbWFrZVJhbmRvbUNvb3JkaW5hdGVzKClcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGVsZW1lbnRDb2x1bW4gPSBsb2NhdGlvbi5jb2x1bW5cbiAgICAgICAgY29uc3QgZWxlbWVudFJvdyA9IGxvY2F0aW9uLnJvd1xuXG5cbiAgICAgICAgcmV0dXJuIHsgZWxlbWVudENvbHVtbiwgZWxlbWVudFJvdywgcmFuZG9tRGlyZWN0aW9uIH1cbiAgICB9XG5cbiAgICBjb25zdCByYW5kb21seVBsYWNlU2hpcHMgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHNoaXBEZXRhaWxzID0gW11cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgY29uc3Qgc2hpcCA9IHNoaXBzW2ldXG4gICAgICAgICAgICBjb25zdCB7IHJhbmRvbUNvbHVtbiwgcmFuZG9tUm93LCByYW5kb21EaXJlY3Rpb24gfSA9XG4gICAgICAgICAgICAgICAgbWFrZVJhbmRvbUNvb3JkaW5hdGVzKHNoaXAuZ2V0TGVuZ3RoKCkpXG4gICAgICAgICAgICBpZiAocGxhY2VTaGlwKHJhbmRvbUNvbHVtbiwgcmFuZG9tUm93LCByYW5kb21EaXJlY3Rpb24sIHNoaXApKSB7XG4gICAgICAgICAgICAgICAgc2hpcERldGFpbHMucHVzaCh7IHJhbmRvbUNvbHVtbiwgcmFuZG9tUm93LCByYW5kb21EaXJlY3Rpb24gfSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaSAtPSAxXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNoaXBEZXRhaWxzXG4gICAgfVxuXG4gICAgY29uc3QgcmVjZWl2ZUF0dGFjayA9IChjb2x1bW4sIHJvdykgPT4ge1xuICAgICAgICBnYW1lQm9hcmRbY29sdW1uXVtyb3ddLmhhc0JlZW5IaXQgPSB0cnVlXG4gICAgfVxuXG4gICAgY29uc3QgY2hlY2tJZk9mZkxpbWl0Wm9uZVdhc0NvcnJlY3RseUltcGxlbWVudGVkID0gKHNoaXBMZW5ndGgpID0+XG4gICAgICAgIGdhbWVCb2FyZC5mbGF0KCkuZmlsdGVyKChlbGVtZW50KSA9PiBlbGVtZW50Lm9mZkxpbWl0cyA9PT0gdHJ1ZSlcbiAgICAgICAgICAgIC5sZW5ndGggPT09XG4gICAgICAgIHNoaXBMZW5ndGggKyAyXG4gICAgLy8gYWRkaW5nIHNoaXBMZW5ndGggcGx1cyB0d28gYmVjYXVzZSBmb3IgZXZlcnkgaW5jcmVhc2UgaW4gdGhlIHNpemUgb2Ygc2hpcCwgdGhlIHpvbmVzIGNvdmVyZWQgaW5jcmVhc2UgYnkgMiB1bml0c1xuXG4gICAgY29uc3QgY2xlYXJCb2FyZCAgPSAoKSA9PiB7XG4gICAgICAgIGdhbWVCb2FyZCA9IGluaXRpYWxpemVCb2FyZCgpXG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgY2xlYXJCb2FyZCxcbiAgICAgICAgY2hlY2tJZkxvY2F0aW9uSXNBU2hpcE9yT2ZmTGltaXRzLFxuICAgICAgICBjaGVja0lmT2ZmTGltaXRab25lV2FzQ29ycmVjdGx5SW1wbGVtZW50ZWQsXG4gICAgICAgIGdldExvY2F0aW9uLFxuICAgICAgICByZWNlaXZlQXR0YWNrLFxuICAgICAgICBjaGVja0lmQWxsU2hpcHNIYXZlU3VuayxcbiAgICAgICAgcGxhY2VTaGlwLFxuICAgICAgICByYW5kb21seVBsYWNlU2hpcHMsXG4gICAgICAgIG1ha2VSYW5kb21Db29yZGluYXRlcyxcbiAgICB9XG59XG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZUdhbWVCb2FyZCIsImNvbnN0IGNyZWF0ZVBsYXllciA9IChuYW1lID0gJ3BsYXllcicpID0+IHtcbiAgICBjb25zdCBnZXROYW1lID0gKCkgPT4gbmFtZVxuXG4gICAgY29uc3QgYXR0YWNrID0gKGNvbHVtbiwgcm93LCB7IGdldExvY2F0aW9uLCByZWNlaXZlQXR0YWNrIH0pID0+IHtcbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSBnZXRMb2NhdGlvbihjb2x1bW4sIHJvdylcbiAgICAgICAgaWYgKGxvY2F0aW9uLmhhc0JlZW5IaXQgPT09IGZhbHNlIHx8IChsb2NhdGlvbi5pc1NoaXAgJiYgbG9jYXRpb24uZ2V0U3RhdHVzKCkuaW5jbHVkZXMoJ3VuaGl0JykgPT09IGZhbHNlKSkge1xuICAgICAgICAgICAgcmVjZWl2ZUF0dGFjayhjb2x1bW4sIHJvdylcbiAgICAgICAgICAgIGlmKGxvY2F0aW9uLmhpdCl7XG5cbiAgICAgICAgICAgICAgICBsb2NhdGlvbi5oaXQobG9jYXRpb24ucG9zaXRpb24pXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiWW91IGhpdCBhIHNoaXAhXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBcIkl0J3MgYSBoaXQhXCJcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAnWW91IGhhdmUgYWxyZWFkeSBoaXQgdGhpcyBzcG90ISdcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBnZXROYW1lLFxuICAgICAgICBhdHRhY2ssXG4gICAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZVBsYXllclxuIiwiY29uc3QgY3JlYXRlU2hpcCA9IChsZW5ndGgsIG5hbWUgPSAnc2hpcCcpID0+IHtcblxuICAgIGNvbnN0IHN0YXR1cyA9IEFycmF5KGxlbmd0aCkuZmlsbCgndW5oaXQnKVxuXG4gICAgY29uc3QgZ2V0TGVuZ3RoID0gKCkgPT4gc3RhdHVzLmxlbmd0aFxuXG4gICAgY29uc3QgZ2V0U3RhdHVzID0gKCkgPT4gc3RhdHVzXG5cbiAgICBjb25zdCBoaXQgPSAocG9zaXRpb24pID0+IHtcbiAgICAgICAgaWYgKHBvc2l0aW9uIDwgbGVuZ3RoKSB7XG4gICAgICAgICAgICBzdGF0dXNbcG9zaXRpb25dID0gJ2hpdCdcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGdldE5hbWUgPSAoKSA9PiAgbmFtZVxuXG4gICAgY29uc3QgaXNTdW5rID0gKCkgPT4gc3RhdHVzLmV2ZXJ5KChwb3NpdGlvbikgPT4gcG9zaXRpb24gPT09ICdoaXQnKVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZ2V0TmFtZSxcbiAgICAgICAgZ2V0TGVuZ3RoLFxuICAgICAgICBpc1N1bmssXG4gICAgICAgIGhpdCxcbiAgICAgICAgZ2V0U3RhdHVzLFxuICAgICAgICBoYXNCZWVuSGl0OiBmYWxzZSxcbiAgICAgICAgb2ZmTGltaXRzOiB0cnVlLFxuICAgICAgICBpc1NoaXA6IHRydWUsXG4gICAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZVNoaXBcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gKG1vZHVsZSkgPT4ge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHQoKSA9PiAobW9kdWxlWydkZWZhdWx0J10pIDpcblx0XHQoKSA9PiAobW9kdWxlKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCJpbXBvcnQgY3JlYXRlR2FtZUJvYXJkIGZyb20gXCIuL2dhbWVib2FyZC9nYW1lYm9hcmRcIlxuaW1wb3J0IGNyZWF0ZVNoaXAgZnJvbSBcIi4vc2hpcC9zaGlwXCJcblxuY29uc3QgcmVuZGVyQXR0YWNrcyA9IChwbGF5ZXIsIGNvbHVtbiwgcm93LCBlbmVteUJvYXJkKSA9PiB7XG4gICAgY29uc3QgY2VsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgIGAuJHtwbGF5ZXJ9LWJvYXJkID4gLmNlbGxbY29sdW1uPScke2NvbHVtbn0nXVtyb3c9JyR7cm93fSddYFxuICAgIClcblxuICAgIGNvbnN0IGxvY2F0aW9uID0gZW5lbXlCb2FyZC5nZXRMb2NhdGlvbihjb2x1bW4sIHJvdylcbiAgICBpZiAobG9jYXRpb24uaXNTaGlwKSB7XG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnaGl0JylcbiAgICB9IGVsc2Uge1xuICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ21pc3MnKVxuICAgIH1cbn1cblxuY29uc3QgaGFuZGxlQXR0YWNrID0gKGNvbHVtbiwgcm93LCBlbmVteUJvYXJkLCBwbGF5ZXIpID0+XG4gICAgcGxheWVyLmF0dGFjayhjb2x1bW4sIHJvdywgZW5lbXlCb2FyZClcblxuY29uc3QgYXR0YWNrRW5lbXlDZWxsID0gKGNvbHVtbiwgcm93LCBlbmVteUJvYXJkLCBwbGF5ZXIpID0+IHtcbiAgICBoYW5kbGVBdHRhY2soY29sdW1uLCByb3csIGVuZW15Qm9hcmQsIHBsYXllcilcbiAgICByZW5kZXJBdHRhY2tzKCdlbmVteScsIGNvbHVtbiwgcm93LCBlbmVteUJvYXJkKVxufVxuXG5jb25zdCBpc1NwYWNlQXJvdW5kSGl0ID0gKGNvbHVtbiwgcm93LCBwbGF5ZXJCb2FyZCkgPT4ge1xuXG4gICAgY29uc3QgbmV4dENvbHVtbiA9IHBsYXllckJvYXJkLmdldExvY2F0aW9uKGNvbHVtbiArIDEsIHJvdylcbiAgICBjb25zdCBwcmV2aW91c0NvbHVtbiA9IHBsYXllckJvYXJkLmdldExvY2F0aW9uKGNvbHVtbiAtIDEsIHJvdylcbiAgICBjb25zdCBuZXh0Um93ID0gcGxheWVyQm9hcmQuZ2V0TG9jYXRpb24oY29sdW1uLCByb3cgKyAxKVxuICAgIGNvbnN0IHByZXZpb3VzUm93ID0gcGxheWVyQm9hcmQuZ2V0TG9jYXRpb24oY29sdW1uLCByb3cgLSAxKVxuXG4gICAgY29uc3Qgc3BhY2VzSGl0ID0gW11cblxuICAgIGlmKG5leHRDb2x1bW4gJiYgIW5leHRDb2x1bW4uaGFzQmVlbkhpdCl7XG4gICAgICAgIHNwYWNlc0hpdC5wdXNoKG5leHRDb2x1bW4pXG4gICAgfVxuICAgIGlmKHByZXZpb3VzQ29sdW1uICYmICFwcmV2aW91c0NvbHVtbi5oYXNCZWVuSGl0KXtcbiAgICAgICAgc3BhY2VzSGl0LnB1c2gocHJldmlvdXNDb2x1bW4pXG4gICAgfVxuICAgIGlmKG5leHRSb3cgJiYgIW5leHRSb3cuaGFzQmVlbkhpdCl7XG4gICAgICAgIHNwYWNlc0hpdC5wdXNoKG5leHRSb3cpXG4gICAgfVxuICAgIGlmKHByZXZpb3VzUm93ICYmICFwcmV2aW91c1Jvdy5oYXNCZWVuSGl0KXtcbiAgICAgICAgc3BhY2VzSGl0LnB1c2gocHJldmlvdXNSb3cpXG4gICAgfVxuXG4gICAgcmV0dXJuIHNwYWNlc0hpdFxuXG59XG5cbmNvbnN0IHJhbmRvbURpcmVjdGlvbkF0dGFjayA9IChjb2x1bW4sIHJvdywgcGxheWVyQm9hcmQpID0+IHtcblxuICAgIGNvbnN0IHNwYWNlc0hpdCA9IGlzU3BhY2VBcm91bmRIaXQoY29sdW1uLCByb3csIHBsYXllckJvYXJkKVxuXG4gICAgY29uc3QgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBzcGFjZXNIaXQubGVuZ3RoKVxuXG4gICAgaWYoIXNwYWNlc0hpdFtyYW5kb21JbmRleF0pIHJldHVybiByYW5kb21EaXJlY3Rpb25BdHRhY2soY29sdW1uLCByb3cgLCBwbGF5ZXJCb2FyZClcblxuICAgIHJldHVybiBzcGFjZXNIaXRbcmFuZG9tSW5kZXhdXG59XG5cbmNvbnN0IGlzUmFuZG9tQ29sdW1uR3JlYXRlclRoYW5DdXJyZW50Q29sdW1uID0gKGNvbHVtbiwgcmFuZG9tQ29sdW1uKSA9PiBcbiAgICByYW5kb21Db2x1bW4gPiBjb2x1bW5cblxuY29uc3QgaXNSYW5kb21Sb3dHcmVhdGVyVGhhbkN1cnJlbnRDb2x1bW4gPSAocm93LCByYW5kb21Sb3cpID0+IFxuICAgIHJhbmRvbVJvdyA+IHJvd1xuXG5jb25zdCBsaXN0T2ZSYW5kb21Db29yZGluYXRlcyA9IChjb2x1bW4sIHJvdywgcGxheWVyQm9hcmQpID0+IHtcblxuICAgICAgICBjb25zdCBsb2NhdGlvblByb3RvdHlwZSA9IHtcbiAgICAgICAgICAgIGxvY2F0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwbGF5ZXJCb2FyZC5nZXRMb2NhdGlvbih0aGlzLmNvbHVtbiwgdGhpcy5yb3cpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB0b3AgPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUobG9jYXRpb25Qcm90b3R5cGUpLCB7XG4gICAgICAgICAgICBjb2x1bW4sXG4gICAgICAgICAgICByb3c6IHJvdyAtIDEsXG4gICAgICAgIH0pXG4gICAgICAgIGNvbnN0IGJvdHRvbSA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShsb2NhdGlvblByb3RvdHlwZSksIHtcbiAgICAgICAgICAgIGNvbHVtbixcbiAgICAgICAgICAgIHJvdzogcm93ICsgMSxcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgcmlnaHQgPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUobG9jYXRpb25Qcm90b3R5cGUpLCB7XG4gICAgICAgICAgICBjb2x1bW46IGNvbHVtbiArIDEsXG4gICAgICAgICAgICByb3csXG4gICAgICAgIH0pXG4gICAgICAgIGNvbnN0IGxlZnQgPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUobG9jYXRpb25Qcm90b3R5cGUpLCB7XG4gICAgICAgICAgICBjb2x1bW46IGNvbHVtbiAtIDEsXG4gICAgICAgICAgICByb3csXG4gICAgICAgIH0pXG4gICAgICAgIGNvbnN0IGRpcmVjdGlvbnMgPSBbXVxuXG4gICAgICAgIGRpcmVjdGlvbnMucHVzaCh0b3ApXG4gICAgICAgIGRpcmVjdGlvbnMucHVzaChib3R0b20pXG4gICAgICAgIGRpcmVjdGlvbnMucHVzaChyaWdodClcbiAgICAgICAgZGlyZWN0aW9ucy5wdXNoKGxlZnQpXG5cbiAgICAgICAgcmV0dXJuIGRpcmVjdGlvbnNcbn1cblxuY29uc3QgY2hlY2tJZlJvd0NvbnRhaW5zU2hpcCA9IChjb2x1bW4sIHBsYXllckJvYXJkKSA9PiB7XG4gICAgZm9yKGxldCByb3cgPSAwOyByb3cgPCAxMDsgcm93Kyspe1xuICAgICAgICBpZihwbGF5ZXJCb2FyZC5nZXRMb2NhdGlvbihjb2x1bW4sIHJvdykuaXNTaGlwKXtcbiAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlXG59XG5cbmNvbnN0IGNoZWNrSWZDb2x1bW5Db250YWluc1NoaXAgPSAocm93LCBwbGF5ZXJCb2FyZCkgPT4ge1xuXG4gICAgZm9yKGxldCBjb2x1bW4gPSAwOyBjb2x1bW4gPCAxMDsgY29sdW1uKyspe1xuICAgICAgICBpZihwbGF5ZXJCb2FyZC5nZXRMb2NhdGlvbihjb2x1bW4sIHJvdykuaXNTaGlwKXtcbiAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlXG59XG5cbmNvbnN0IGF0dGFja1BsYXllckNlbGwgPSAocGxheWVyQm9hcmQsIGVuZW15LCBlbGVtZW50Q29sdW1uLCBlbGVtZW50Um93LCBwcmV2TG9jYXRpb24pID0+IHtcbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSBwbGF5ZXJCb2FyZC5nZXRMb2NhdGlvbihlbGVtZW50Q29sdW1uLCBlbGVtZW50Um93KVxuICAgIGlmKGhhbmRsZUF0dGFjayhlbGVtZW50Q29sdW1uLCBlbGVtZW50Um93LCBwbGF5ZXJCb2FyZCwgZW5lbXkpID09PSBcIllvdSBoaXQgYSBzaGlwIVwiKXtcbiAgICAgICAgXG5cbiAgICAgICAgY29uc3QgcmFuZG9tUG9zaXRpb24gPSByYW5kb21EaXJlY3Rpb25BdHRhY2soZWxlbWVudENvbHVtbiwgZWxlbWVudFJvdywgcGxheWVyQm9hcmQpXG4gICAgICAgIGNvbnN0IHJhbmRvbVBvc2l0aW9uQ29sdW1uID0gcmFuZG9tUG9zaXRpb24uY29sdW1uXG5cbiAgICAgICAgY29uc3QgZGlyZWN0aW9ucyA9IGxpc3RPZlJhbmRvbUNvb3JkaW5hdGVzKGVsZW1lbnRDb2x1bW4sIGVsZW1lbnRSb3csIHBsYXllckJvYXJkKVxuICAgICAgICBjb25zdCBmaWx0ZXJlZERpcmVjdGlvbnMgPSBkaXJlY3Rpb25zLmZpbHRlcigoZWxlbWVudCkgPT4gZWxlbWVudC5jb2x1bW4gIT09IHVuZGVmaW5lZCAmJiBlbGVtZW50LnJvdyAhPT0gdW5kZWZpbmVkKVxuICAgICAgICBjb25zdCByYW5kb21Qb3NpdGlvblJvdyA9IHJhbmRvbVBvc2l0aW9uLnJvd1xuICAgICAgICAgICAgICAgIGlmKGxvY2F0aW9uLmlzU2hpcCAmJiBsb2NhdGlvbi5pc1N1bmsoKSA9PT0gZmFsc2Upe1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJhbmRvbSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGZpbHRlcmVkRGlyZWN0aW9ucy5sZW5ndGgpXG4gICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZWZhdWx0LWNhc2VcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoKHJhbmRvbSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dGFja1BsYXllckNlbGwocGxheWVyQm9hcmQsIGVuZW15LCBmaWx0ZXJlZERpcmVjdGlvbnNbMF0uY29sdW1uLCBmaWx0ZXJlZERpcmVjdGlvbnNbMF0ucm93LCBsb2NhdGlvbilcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRhY2tQbGF5ZXJDZWxsKHBsYXllckJvYXJkLCBlbmVteSwgZmlsdGVyZWREaXJlY3Rpb25zWzFdLmNvbHVtbiwgZmlsdGVyZWREaXJlY3Rpb25zWzFdLnJvdywgbG9jYXRpb24pXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0YWNrUGxheWVyQ2VsbChwbGF5ZXJCb2FyZCwgZW5lbXksIGZpbHRlcmVkRGlyZWN0aW9uc1syXS5jb2x1bW4sIGZpbHRlcmVkRGlyZWN0aW9uc1syXS5yb3csIGxvY2F0aW9uKVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dGFja1BsYXllckNlbGwocGxheWVyQm9hcmQsIGVuZW15LCBmaWx0ZXJlZERpcmVjdGlvbnNbM10uY29sdW1uLCBmaWx0ZXJlZERpcmVjdGlvbnNbM10ucm93LCBsb2NhdGlvbilcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXR0YWNrUGxheWVyQ2VsbChwbGF5ZXJCb2FyZCwgZW5lbXksIHJhbmRvbVBvc2l0aW9uQ29sdW1uLCByYW5kb21Qb3NpdGlvblJvdywgcHJldkxvY2F0aW9uKVxuICAgICAgICB9LCA3MDApXG4gICAgfVxuICAgIGVsc2UgaWYobG9jYXRpb24mJiBsb2NhdGlvbi5pc1NoaXAgPT09IGZhbHNlICYmIHByZXZMb2NhdGlvbiAmJiBwcmV2TG9jYXRpb24uaXNTaGlwID09PSB0cnVlKXtcblxuICAgICAgICBsZXQgcHJldkxvY2F0aW9uUm93O1xuICAgICAgICBsZXQgcHJldkxvY2F0aW9uQ29sdW1uO1xuICAgICAgICBjb25zdCBzaGlwTGVuZ3RoID0gcHJldkxvY2F0aW9uLmdldExlbmd0aCgpXG4gICAgICAgIGlmKHByZXZMb2NhdGlvbi5jb2x1bW4gPiBlbGVtZW50Q29sdW1uICl7XG4gICAgICAgIHByZXZMb2NhdGlvbkNvbHVtbiA9IHByZXZMb2NhdGlvbi5jb2x1bW4gLSAocHJldkxvY2F0aW9uLmNvbHVtbiAtIGVsZW1lbnRDb2x1bW4pXG4gICAgICAgIH1cbiAgICAgICAgaWYocHJldkxvY2F0aW9uLmNvbHVtbiA8IGVsZW1lbnRDb2x1bW4pe1xuICAgICAgICBwcmV2TG9jYXRpb25Db2x1bW4gPSBwcmV2TG9jYXRpb24uY29sdW1uICsgKGVsZW1lbnRDb2x1bW4gLSBwcmV2TG9jYXRpb24uY29sdW1uKVxuICAgICAgICB9XG4gICAgICAgIGlmKHByZXZMb2NhdGlvbi5yb3cgPiBlbGVtZW50Um93KXtcbiAgICAgICAgcHJldkxvY2F0aW9uUm93ID0gcHJldkxvY2F0aW9uLnJvdyAtICAocHJldkxvY2F0aW9uLnJvdyAtIGVsZW1lbnRSb3cpXG5cbiAgICAgICAgfVxuICAgICAgICBpZihwcmV2TG9jYXRpb24ucm93IDwgZWxlbWVudFJvdyl7XG4gICAgICAgIHByZXZMb2NhdGlvblJvdyA9IHByZXZMb2NhdGlvbi5yb3cgKyAoZWxlbWVudFJvdyAtIHByZXZMb2NhdGlvbi5yb3cpXG5cbiAgICAgICAgfVxuXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuXG4gICAgICAgICAgICBpZihwcmV2TG9jYXRpb24uaXNTdW5rKCkgPT09IGZhbHNlKXtcblxuICAgICAgICAgICAgYXR0YWNrUGxheWVyQ2VsbChwbGF5ZXJCb2FyZCwgZW5lbXksIHByZXZMb2NhdGlvbkNvbHVtbiwgcHJldkxvY2F0aW9uUm93LCBwcmV2TG9jYXRpb24pXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sNzAwKVxuICAgIH1cblxuXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG5cbiAgICByZW5kZXJBdHRhY2tzKCdwbGF5ZXInLCBlbGVtZW50Q29sdW1uLCBlbGVtZW50Um93LCBwbGF5ZXJCb2FyZCwgcHJldkxvY2F0aW9uKVxuICAgIH0sIDcwMClcblxufVxuLy8gaHR0cHM6Ly9qc21hbmlmZXN0LmNvbS90aGUtcHVibGlzaC1zdWJzY3JpYmUtcGF0dGVybi1pbi1qYXZhc2NyaXB0L1xuXG5leHBvcnQgY29uc3QgcHViU3ViID0gKCkgPT4ge1xuICAgIGNvbnN0IHN1YnNjcmliZXJzID0ge31cblxuICAgIGZ1bmN0aW9uIHB1Ymxpc2goZXZlbnROYW1lLCBkYXRhKSB7XG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShzdWJzY3JpYmVyc1tldmVudE5hbWVdKSkge1xuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgICAgc3Vic2NyaWJlcnNbZXZlbnROYW1lXS5mb3JFYWNoKChjYWxsYmFjaykgPT4ge1xuICAgICAgICAgICAgY2FsbGJhY2soZGF0YSlcbiAgICAgICAgfSlcbiAgICB9XG4gICAgZnVuY3Rpb24gc3Vic2NyaWJlKGV2ZW50TmFtZSwgY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHN1YnNjcmliZVtldmVudE5hbWVdKSkge1xuICAgICAgICAgICAgc3Vic2NyaWJlcnNbZXZlbnROYW1lXSA9IFtdXG4gICAgICAgIH1cbiAgICAgICAgc3Vic2NyaWJlcnNbZXZlbnROYW1lXS5wdXNoKGNhbGxiYWNrKVxuICAgICAgICBjb25zdCBpbmRleCA9IHN1YnNjcmliZXJzW2V2ZW50TmFtZV0ubGVuZ3RoIC0gMVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1bnN1YnNjcmliZSgpIHtcbiAgICAgICAgICAgICAgICBzdWJzY3JpYmVyc1tldmVudE5hbWVdLnNwbGljZShpbmRleCwgMSlcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBwdWJsaXNoLFxuICAgICAgICBzdWJzY3JpYmUsXG4gICAgfVxufVxuXG5jb25zdCBjZWxsRHJhZ0xpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgY29uc29sZS5sb2codGhpcylcbn1cblxuLy9jb25zdCBhZGREcmFnZ2FibGVQcm9wZXJ0aWVzID0gKCkgPT4ge1xuXG4gICAgLy9jb25zdCBkcmFnZ2FibGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNlbGxbZHJhZ2dhYmxlPVwidHJ1ZVwiXScpXG4gICAgLy9kcmFnZ2FibGVzLmZvckVhY2goZHJhZ2dhYmxlID0+IHtcbiAgICAgICAgLy9kcmFnZ2FibGUuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgKCkgPT4ge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnYm9iIGpvbmVzJylcbiAgICAgICAgLy99KVxuICAgIC8vfSlcbi8vfVxuXG5mdW5jdGlvbiBnZXREcmFnQWZ0ZXJFbGVtZW50KGNvbnRhaW5lciwgeSwgeCl7XG4gICAgY29uc3QgZHJhZ2dhYmxlRWxlbWVudHMgPSBbLi4uY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jZWxsOm5vdCguZHJhZ2dpbmcpJyldXG5cbiAgICByZXR1cm4gZHJhZ2dhYmxlRWxlbWVudHMucmVkdWNlKChjbG9zZXN0LCBjaGlsZCkgPT4ge1xuICAgICAgICBjb25zdCBib3ggPSBjaGlsZC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgICAgICBjb25zdCBvZmZzZXRZID0geSAtIGJveC50b3AgLSBib3guaGVpZ2h0IC8gMlxuICAgICAgICBjb25zdCBvZmZzZXRYID0geCAtIGJveC5sZWZ0IC0gYm94LndpZHRoLyAyXG4gICAgICAgIGNvbnNvbGUubG9nKGNoaWxkKVxuICAgICAgICBpZihvZmZzZXRZIDwgMCAmJiBvZmZzZXRZID4gY2xvc2VzdC5vZmZzZXRZICYmIG9mZnNldFggPCAwICYmIG9mZnNldFggPiBjbG9zZXN0Lm9mZnNldFgpe1xuICAgICAgICAgICAgcmV0dXJuIHtvZmZzZXRYLCBvZmZzZXRZLCBlbGVtZW50OmNoaWxkfVxuICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY2xvc2VzdFxuXG4gICAgfSwge29mZnNldFg6IE51bWJlci5ORUdBVElWRV9JTkZJTklUWSwgb2Zmc2V0WTpOdW1iZXIuTkVHQVRJVkVfSU5GSU5JVFl9KS5lbGVtZW50XG59XG5cbmNvbnN0IGFkZExpc3RlbmVyVG9Cb2F0ID0gKGNlbGxzKSA9PiB7XG5cbiAgICAvL1ZpZGVvIGZvciBkcmFnIGFuZCBkcm9wOiBodHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PWpmWVd3UXJ0enpZXG5cbiAgICBjb25zdCBjZWxsc0NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXItYm9hcmQnKVxuICAgIGNvbnN0IHNoaXBDb250YWluZXIgID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBjZWxscy5mb3JFYWNoKChjZWxsLCBpbmRleCkgPT4ge1xuICAgICAgICBjZWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsICgpID0+IHtcbiAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnZHJhZ2dpbmcnKVxuICAgICAgICB9KVxuXG4gICAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsICgpID0+IHtcbiAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LnJlbW92ZSgnZHJhZ2dpbmcnKVxuICAgICAgICB9KVxuICAgIH0pXG5cbiAgICBjZWxsc0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIChldmVudCkgPT4ge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgIGxldCBhZnRlckVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IGRyYWdnYWJsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kcmFnZ2luZycpXG4gICAgICAgIGNvbnNvbGUubG9nKGFmdGVyRWxlbWVudClcbiAgICAgICAgaWYoYWZ0ZXJFbGVtZW50ID09PSBudWxsKXtcblxuICAgICAgICAgICAgY2VsbHNDb250YWluZXIuYXBwZW5kQ2hpbGQoZHJhZ2dhYmxlKVxuICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICBjZWxsc0NvbnRhaW5lci5pbnNlcnRCZWZvcmUoZHJhZ2dhYmxlLCBhZnRlckVsZW1lbnQpXG4gICAgICAgIH1cbiAgICB9KVxufVxuXG5jb25zdCBxdWVyeUNlbGxzID0gKCkgPT4ge1xuXG4gICAgY29uc3QgcGF0cm9sQm9hdD0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNlbGxbc2hpcC1uYW1lPVwiUGF0cm9sIEJvYXRcIl0nKVxuICAgIGFkZExpc3RlbmVyVG9Cb2F0KHBhdHJvbEJvYXQpXG5cbiAgICAvL2NvbnN0IHBhdHJvbEJvYXRDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuXG4gICAgY29uc3Qgc3VibWFyaW5lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNlbGxbc2hpcC1uYW1lPVwiU3VibWFyaW5lXCJdJylcbiAgICBhZGRMaXN0ZW5lclRvQm9hdChzdWJtYXJpbmUpXG4gICAgLy9jb25zdCBzdWJtYXJpbmVDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuXG4gICAgY29uc3QgY2FycmllciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jZWxsW3NoaXAtbmFtZT1cIkNhcnJpZXJcIl0nKVxuICAgIGFkZExpc3RlbmVyVG9Cb2F0KGNhcnJpZXIpXG4gICAgLy9jb25zdCBjYXJyaWVyQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcblxuICAgIGNvbnN0IGJhdHRsZVNoaXA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jZWxsW3NoaXAtbmFtZT1cIkJhdHRsZXNoaXBcIl0nKVxuICAgIGFkZExpc3RlbmVyVG9Cb2F0KGJhdHRsZVNoaXApXG4gICAgLy9jb25zdCBiYXR0bGVTaGlwQ29udGFpbmVyPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuXG4gICAgY29uc3QgZGVzdHJveWVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNlbGxbc2hpcC1uYW1lPVwiRGVzdHJveWVyXCJdJylcbiAgICBhZGRMaXN0ZW5lclRvQm9hdChkZXN0cm95ZXIpXG4gICAgLy9jb25zdCBkZXN0cm95ZXJDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuXG5cbn1cblxuZnVuY3Rpb24gY3JlYXRlRHJhZ0FuZERyb3BGbGVldChwbGF5ZXIpe1xuICAgIHJlbmRlclBsYXllclNoaXBTZWxlY3QoMSwgMSlcbiAgICByZW5kZXJQbGF5ZXJTaGlwU2VsZWN0KDIsIDIpXG4gICAgcmVuZGVyUGxheWVyU2hpcFNlbGVjdCgzLCAzKVxuICAgIHJlbmRlclBsYXllclNoaXBTZWxlY3QoNCwgNClcblxuICAgIGZ1bmN0aW9uIHJlbmRlclBsYXllclNoaXBTZWxlY3QoaSwgbGVuZ3RoKXtcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBsYXllci1ib2FyZCcpXG4gICAgICAgIGNvbnN0IHNoaXBDb250YWluZXIgPSBkb2N1bW5ldC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgICAgICBzaGlwQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJzaGlwLWNvbnRhaW5lclwiKVxuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoc2hpcENvbnRhaW5lcilcblxuICAgICAgICBjb25zdCBzaGlwSW5mbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpXG4gICAgICAgIHNoaXBJbmZvLmNsYXNzTGlzdC5hZGQoKVxuXG4gICAgfVxufVxuZXhwb3J0IGNvbnN0IHJlbmRlclBsYXllclNoaXBzID0gKHsgZ2V0TG9jYXRpb24gfSkgPT4ge1xuICAgIGNvbnN0IHBsYXllckJvYXJkQXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Rpdi5wbGF5ZXItYm9hcmQnKVxuXG4gICAgZm9yIChsZXQgY29sdW1uID0gMDsgY29sdW1uIDwgMTA7IGNvbHVtbiArPSAxKSB7XG4gICAgICAgIGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IDEwOyByb3cgKz0gMSkge1xuICAgICAgICAgICAgY29uc3QgY2VsbCA9IHBsYXllckJvYXJkQXJlYS5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgICAgIGAuY2VsbDpudGgtY2hpbGQoJHtyb3cgKiAxMCArIGNvbHVtbiArIDF9KWBcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIGNlbGwuc2V0QXR0cmlidXRlKCdjb2x1bW4nLCBjb2x1bW4pXG4gICAgICAgICAgICBjZWxsLnNldEF0dHJpYnV0ZSgncm93Jywgcm93KVxuICAgICAgICAgICAgY29uc3QgbG9jYXRpb24gPSBnZXRMb2NhdGlvbihjb2x1bW4sIHJvdylcbiAgICAgICAgICAgIGlmIChsb2NhdGlvbi5pc1NoaXApIHtcbiAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTGlzdC5hZGQoJ3NoaXAnKVxuICAgICAgICAgICAgICAgIGNlbGwuc2V0QXR0cmlidXRlKCdzaGlwLW5hbWUnLCBsb2NhdGlvbi5nZXROYW1lKCkpXG4gICAgICAgICAgICAgICAgY2VsbC5zZXRBdHRyaWJ1dGUoJ2RyYWdnYWJsZScsIHRydWUpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmNvbnN0IGNoZWNrSWZHYW1lT3ZlciA9IChwbGF5ZXJCb2FyZCwgZW5lbXlCb2FyZCkgPT4ge1xuICAgIGlmIChwbGF5ZXJCb2FyZC5jaGVja0lmQWxsU2hpcHNIYXZlU3VuaygpKSB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsJylcbiAgICAgICAgY29uc3QgbW9kYWxXaW5uZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtY29udGVudCA+IHAnKVxuICAgICAgICBjb25zdCBwbGF5QWdhaW5CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgJy5tb2RhbC1jb250ZW50ID4gYnV0dG9uJ1xuICAgICAgICApXG5cbiAgICAgICAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdibG9jaydcbiAgICAgICAgcGxheUFnYWluQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKClcbiAgICAgICAgfSlcblxuICAgICAgICBtb2RhbFdpbm5lci50ZXh0Q29udGVudCA9ICdZb3UgbG9zZSEnXG4gICAgfVxuICAgIGlmIChlbmVteUJvYXJkLmNoZWNrSWZBbGxTaGlwc0hhdmVTdW5rKCkpIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwnKVxuICAgICAgICBjb25zdCBtb2RhbFdpbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1jb250ZW50ID4gcCcpXG4gICAgICAgIGNvbnN0IHBsYXlBZ2FpbkJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICAnLm1vZGFsLWNvbnRlbnQgPiBidXR0b24nXG4gICAgICAgIClcblxuICAgICAgICBtb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJ1xuICAgICAgICBtb2RhbFdpbm5lci50ZXh0Q29udGVudCA9ICdZb3Ugd2luISdcbiAgICAgICAgcGxheUFnYWluQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKClcbiAgICAgICAgfSlcbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCBhZGRMaXN0ZW5lcnNUb0VuZW15Qm9hcmQgPSAoXG4gICAgcGxheWVyQm9hcmQsXG4gICAgZW5lbXlCb2FyZCxcbiAgICBwbGF5ZXIsXG4gICAgZW5lbXksXG4gICAgcHNcbikgPT4ge1xuICAgIGNvbnN0IGVuZW15Qm9hcmRBcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2LmVuZW15LWJvYXJkJylcblxuICAgIGZvciAobGV0IGNvbHVtbiA9IDA7IGNvbHVtbiA8IDEwOyBjb2x1bW4gKz0gMSkge1xuICAgICAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCAxMDsgcm93ICs9IDEpIHtcbiAgICAgICAgICAgIC8vIENyZWRpdGluZyBmb3JtdWxhIHRvIGNhbGN1bGF0ZSBudGgtY2hpbGQgdXNpbmcgbmVzdGVkIGxvb3A6IGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzg4NzI2NjIvbWF0aC10by1kZXRlcm1pbmUtaXRlbS1pbmRleC1iYXNlZC1vbi1jb2wtcm93LXNlbGVjdGlvbi1pbi1ncmlkXG4gICAgICAgICAgICBjb25zdCBjZWxsID0gZW5lbXlCb2FyZEFyZWEucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICAgICBgLmNlbGw6bnRoLWNoaWxkKCR7cm93ICogMTAgKyBjb2x1bW4gKyAxfSlgXG4gICAgICAgICAgICApXG4gICAgICAgICAgICBjZWxsLnNldEF0dHJpYnV0ZSgnY29sdW1uJywgY29sdW1uKVxuICAgICAgICAgICAgY2VsbC5zZXRBdHRyaWJ1dGUoJ3JvdycsIHJvdylcblxuICAgICAgICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICAgICAgICAgICdjbGljaycsXG4gICAgICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBwcy5wdWJsaXNoKCdjbGljaycsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW4sXG4gICAgICAgICAgICAgICAgICAgICAgICByb3csXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJCb2FyZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZW15Qm9hcmQsXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmVteSxcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHsgb25jZTogdHJ1ZSB9XG4gICAgICAgICAgICApXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmNvbnN0IGNsZWFyQm9hcmRET00gPSAoKSA9PiB7XG4gICAgY29uc3QgY2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGxheWVyLWJvYXJkID4gLmNlbGwnKVxuXG4gICAgY2VsbHMuZm9yRWFjaChjZWxsID0+IHtcbiAgICAgICAgY2VsbC5jbGFzc0xpc3QucmVtb3ZlKCdzaGlwJylcbiAgICAgICAgY2VsbC5jbGFzc0xpc3QucmVtb3ZlKCdoaXQnKVxuICAgICAgICBjZWxsLmNsYXNzTGlzdC5yZW1vdmUoJ21pc3MnKVxuICAgIH0pXG5cblxuXG59XG5cblxuZXhwb3J0IGNvbnN0IHJhbmRvbWl6ZUxpc3RlbmVyID0gKGdhbWVCb2FyZCkgPT4ge1xuXG4gICAgZ2FtZUJvYXJkLmNsZWFyQm9hcmQoKVxuICAgIGNsZWFyQm9hcmRET00oKVxuXG4gICAgY29uc3QgcmFuZG9tUG9zc2liaWxpdHkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA0KVxuICAgIHN3aXRjaChyYW5kb21Qb3NzaWJpbGl0eSl7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCg5LCAxLCAndmVydGljYWwnLCBjcmVhdGVTaGlwKDUpKVxuICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDAsIDMsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgzKSlcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCgzLCA2LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMikpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoNiwgNSwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDMpKVxuICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDMsIDksICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCg0KSlcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoMCwgMiwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDUpKVxuICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDQsIDUsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgzKSlcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCg4LCA3LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMikpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoNSwgOSwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDMpKVxuICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDYsIDMsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCg0KSlcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoNSwgMSwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDUpKVxuICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDMsIDMsICd2ZXJ0aWNhbCcsIGNyZWF0ZVNoaXAoMykpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoMCwgMCwgJ3ZlcnRpY2FsJywgY3JlYXRlU2hpcCgyKSlcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCg2LCA1LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMykpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoNSwgOSwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDQpKVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDAsIDAsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCg1KSlcbiAgICAgICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoMywgNCwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDMpKVxuICAgICAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCg2LCA3LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMikpXG4gICAgICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDksIDEsICd2ZXJ0aWNhbCcsIGNyZWF0ZVNoaXAoMykpXG4gICAgICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDUsIDksICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCg0KSlcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHJlbmRlclBsYXllclNoaXBzKGdhbWVCb2FyZClcblxufVxuXG5cblxuZXhwb3J0IGNvbnN0IGF0dGFjayA9ICh7XG4gICAgY2VsbCxcbiAgICBjb2x1bW4sXG4gICAgcm93LFxuICAgIHBsYXllckJvYXJkLFxuICAgIGVuZW15Qm9hcmQsXG4gICAgcGxheWVyLFxuICAgIGVuZW15LFxufSkgPT4ge1xuICAgIC8vIGh1bWFuIHBsYXllciBhdHRhY2tpbmcgY29tcHV0ZXJcbiAgICBhdHRhY2tFbmVteUNlbGwoY29sdW1uLCByb3csIGVuZW15Qm9hcmQsIHBsYXllcilcbiAgICAvLyBjb21wdXRlciBhdHRhY2tpbmcgaHVtYW5cbiAgICBjb25zdCB7IGVsZW1lbnRDb2x1bW4sIGVsZW1lbnRSb3cgfSA9IHBsYXllckJvYXJkLm1ha2VSYW5kb21Db29yZGluYXRlcygpXG4gICAgYXR0YWNrUGxheWVyQ2VsbChwbGF5ZXJCb2FyZCwgZW5lbXksIGVsZW1lbnRDb2x1bW4sIGVsZW1lbnRSb3cpXG5cbiAgICBjaGVja0lmR2FtZU92ZXIocGxheWVyQm9hcmQsIGVuZW15Qm9hcmQpXG59XG4iLCJpbXBvcnQgeyBhZGRMaXN0ZW5lcnNUb0VuZW15Qm9hcmQsIHJlbmRlclBsYXllclNoaXBzLHB1YlN1YiwgcmFuZG9taXplTGlzdGVuZXIsIGF0dGFja30gZnJvbSAnLi9kb20nXG5cbmltcG9ydCBjcmVhdGVHYW1lQm9hcmQgZnJvbSAnLi9nYW1lYm9hcmQvZ2FtZWJvYXJkJ1xuaW1wb3J0IGNyZWF0ZVNoaXAgZnJvbSAnLi9zaGlwL3NoaXAnXG5pbXBvcnQgY3JlYXRlUGxheWVyIGZyb20gJy4vcGxheWVyL3BsYXllcidcblxuY29uc3QgcGxheWVyQm9hcmQgPSBjcmVhdGVHYW1lQm9hcmQoKVxuY29uc3QgZW5lbXlCb2FyZCA9IGNyZWF0ZUdhbWVCb2FyZCgpXG5cbmNvbnN0IHBsYXllciA9IGNyZWF0ZVBsYXllcigpXG5cbmNvbnN0IGNvbXB1dGVyID0gY3JlYXRlUGxheWVyKClcblxuXG4gICAgY29uc3Qgc2hpcHMgPSBbXG4gICAgICAgIGNyZWF0ZVNoaXAoNSwgJ0NhcnJpZXInKSxcbiAgICAgICAgY3JlYXRlU2hpcCg0LCAnQmF0dGxlc2hpcCcpLFxuICAgICAgICBjcmVhdGVTaGlwKDMsICdEZXN0cm95ZXInKSxcbiAgICAgICAgY3JlYXRlU2hpcCgzLCAnU3VibWFyaW5lJyksXG4gICAgICAgIGNyZWF0ZVNoaXAoMiwgJ1BhdHJvbCBCb2F0JyksXG4gICAgXVxuXG5jb25zdCByYW5kb21pemVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdidXR0b24ucmFuZG9taXplJylcblxucmFuZG9taXplQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIHJhbmRvbWl6ZUxpc3RlbmVyKHBsYXllckJvYXJkKVxufSlcbmVuZW15Qm9hcmQucGxhY2VTaGlwKDAsIDAsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCg1KSlcbmVuZW15Qm9hcmQucGxhY2VTaGlwKDMsIDQsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgzKSlcbmVuZW15Qm9hcmQucGxhY2VTaGlwKDYsIDcsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgyKSlcbmVuZW15Qm9hcmQucGxhY2VTaGlwKDksIDEsICd2ZXJ0aWNhbCcsIGNyZWF0ZVNoaXAoMykpXG5lbmVteUJvYXJkLnBsYWNlU2hpcCg1LCA5LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoNCkpXG5cbmNvbnN0IHBzID0gcHViU3ViKClcblxuYWRkTGlzdGVuZXJzVG9FbmVteUJvYXJkKHBsYXllckJvYXJkLCBlbmVteUJvYXJkLCBwbGF5ZXIsIGNvbXB1dGVyLCBwcylcblxucHMuc3Vic2NyaWJlKCdjbGljaycsIGF0dGFjaylcblxuXG5yZW5kZXJQbGF5ZXJTaGlwcyhwbGF5ZXJCb2FyZCkiXSwibmFtZXMiOlsiY3JlYXRlU2hpcCIsIm1vZHVsZSIsImV4cG9ydHMiLCJlbXB0eUNlbGwiLCJoYXNCZWVuSGl0IiwiaXNTaGlwIiwib2ZmTGltaXRzIiwiaW5pdGlhbGl6ZUJvYXJkIiwiZ2FtZUJvYXJkIiwiQXJyYXkiLCJmaWxsIiwibWFwIiwiY29sdW1uIiwicm93Iiwic2hpcHMiLCJnZXRMb2NhdGlvbiIsInNldExvY2F0aW9uIiwic2hpcCIsIk9iamVjdCIsImFzc2lnbiIsImNyZWF0ZU9mZkxpbWl0TG9jYXRpb24iLCJ1bmRlZmluZWQiLCJsb2NhdGlvbiIsImFkZE9mZkxpbWl0QXJlYUZvclNoaXBzIiwiY2hlY2tJZkxvY2F0aW9uSXNBU2hpcE9yT2ZmTGltaXRzIiwiZGlyZWN0aW9uIiwic2hpcExlbmd0aCIsImkiLCJwbGFjZVNoaXAiLCJnZXRMZW5ndGgiLCJsZW5ndGgiLCJjaGVja0lmUm93Q29vcmRpbmF0ZUlzVmFsaWQiLCJwb3NpdGlvbiIsImFkZE9mZkxpbWl0QXJlYUZvclZlcnRpY2FsbHlQb3NpdGlvbmVkU2hpcCIsImNoZWNrSWZDb2x1bW5Db29yZGluYXRlSXNWYWxpZCIsImFkZE9mZkxpbWl0QXJlYUZvckhvcml6b250YWxseVBvc2l0aW9uZWRTaGlwIiwibWFrZVJhbmRvbUNvb3JkaW5hdGVzIiwicmFuZG9tRGlyZWN0aW9uIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicmFuZG9tTG9jYXRpb24iLCJmbGF0dGVuZWRHYW1lQm9hcmQiLCJmbGF0IiwiZm9yRWFjaCIsImVsZW1lbnQiLCJhdmFpbGFiaWxpdHkiLCJhdmFpbGFibGVTcGFjZXMiLCJlbGVtZW50Q29sdW1uIiwiZWxlbWVudFJvdyIsImNsZWFyQm9hcmQiLCJjaGVja0lmT2ZmTGltaXRab25lV2FzQ29ycmVjdGx5SW1wbGVtZW50ZWQiLCJmaWx0ZXIiLCJyZWNlaXZlQXR0YWNrIiwiY2hlY2tJZkFsbFNoaXBzSGF2ZVN1bmsiLCJoYXZlQWxsU2hpcHNTdW5rIiwiaiIsImlzU3VuayIsInJhbmRvbWx5UGxhY2VTaGlwcyIsInNoaXBEZXRhaWxzIiwicmFuZG9tQ29sdW1uIiwicmFuZG9tUm93IiwicHVzaCIsIm5hbWUiLCJnZXROYW1lIiwiYXR0YWNrIiwiZ2V0U3RhdHVzIiwiaW5jbHVkZXMiLCJoaXQiLCJzdGF0dXMiLCJldmVyeSIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJuIiwiZ2V0dGVyIiwiX19lc01vZHVsZSIsImQiLCJhIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwicmVuZGVyQXR0YWNrcyIsInBsYXllciIsImVuZW15Qm9hcmQiLCJjZWxsIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xhc3NMaXN0IiwiYWRkIiwiaGFuZGxlQXR0YWNrIiwicmFuZG9tRGlyZWN0aW9uQXR0YWNrIiwicGxheWVyQm9hcmQiLCJzcGFjZXNIaXQiLCJuZXh0Q29sdW1uIiwicHJldmlvdXNDb2x1bW4iLCJuZXh0Um93IiwicHJldmlvdXNSb3ciLCJpc1NwYWNlQXJvdW5kSGl0IiwicmFuZG9tSW5kZXgiLCJsaXN0T2ZSYW5kb21Db29yZGluYXRlcyIsImxvY2F0aW9uUHJvdG90eXBlIiwidGhpcyIsInRvcCIsImNyZWF0ZSIsImJvdHRvbSIsInJpZ2h0IiwibGVmdCIsImRpcmVjdGlvbnMiLCJhdHRhY2tQbGF5ZXJDZWxsIiwiZW5lbXkiLCJwcmV2TG9jYXRpb24iLCJyYW5kb21Qb3NpdGlvbiIsInJhbmRvbVBvc2l0aW9uQ29sdW1uIiwiZmlsdGVyZWREaXJlY3Rpb25zIiwicmFuZG9tUG9zaXRpb25Sb3ciLCJzZXRUaW1lb3V0IiwicHJldkxvY2F0aW9uUm93IiwicHJldkxvY2F0aW9uQ29sdW1uIiwicmVuZGVyUGxheWVyU2hpcHMiLCJwbGF5ZXJCb2FyZEFyZWEiLCJzZXRBdHRyaWJ1dGUiLCJjb21wdXRlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJxdWVyeVNlbGVjdG9yQWxsIiwicmVtb3ZlIiwicmFuZG9taXplTGlzdGVuZXIiLCJwcyIsInN1YnNjcmliZXJzIiwicHVibGlzaCIsImV2ZW50TmFtZSIsImRhdGEiLCJpc0FycmF5IiwiY2FsbGJhY2siLCJzdWJzY3JpYmUiLCJpbmRleCIsInVuc3Vic2NyaWJlIiwic3BsaWNlIiwicHViU3ViIiwiZW5lbXlCb2FyZEFyZWEiLCJvbmNlIiwiYWRkTGlzdGVuZXJzVG9FbmVteUJvYXJkIiwiYXR0YWNrRW5lbXlDZWxsIiwibW9kYWwiLCJtb2RhbFdpbm5lciIsInBsYXlBZ2FpbkJ1dHRvbiIsInN0eWxlIiwiZGlzcGxheSIsInJlbG9hZCIsInRleHRDb250ZW50IiwiY2hlY2tJZkdhbWVPdmVyIl0sInNvdXJjZVJvb3QiOiIifQ==