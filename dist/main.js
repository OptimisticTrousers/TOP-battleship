(()=>{var t={653:(t,e,o)=>{const r=o(585);t.exports=()=>{const t={hasBeenHit:!1,isShip:!1,offLimits:!1},e=()=>{const e=Array(10).fill().map((()=>Array(10).fill()));for(let o=0;o<10;o++)for(let r=0;r<10;r++)e[o][r]={...t,column:o,row:r};return e};let o=e();const n=[r(5,"Carrier"),r(4,"Battleship"),r(3,"Destroyer"),r(3,"Submarine"),r(2,"Patrol Boat")],i=(t,e)=>o?.[t]?.[e],a=(e,r,n=(()=>Object.assign(t,{offLimits:!0}))())=>{if(void 0===o?.[e]?.[r])return!0;const i=o[e][r];return o[e][r]={...i,...n},!0},l=(t,e)=>{a(t-1,e-1),a(t,e-1)},c=(t,e,o,r)=>{if("vertical"===o)for(let o=0;o<r;o++){const r=i(t,e+o);if(r&&!0===r.isShip&&!0===r.offLimits)return!1}if("horizontal"===o)for(let o=0;o<r;o++){const r=i(t+o,e);if(r&&!0===r.isShip&&!0===r.offLimits)return!1}return!1},s=(t,e,r,n)=>{const s=n.getLength();if(c(i(t,e)))return!1;if("vertical"===r){if(((t,e)=>t>=0&&t+e-1<o.length)(e,s)){for(let o=0;o<s;o+=1)a(t,e+o,{...n,position:o}),a(t+1,e+o),a(t-1,e+o);return((t,e,o)=>{l(t,e),a(t,e+o),a(t+1,e+o),a(t-1,e+o),a(t+1,e-1)})(t,e,s),!0}}else if("horizontal"===r&&((t,e)=>t>=0&&t+e-1<o.length)(t,s)){for(let o=0;o<s;o+=1)a(t+o,e,{...n,position:o}),a(t+o,e+1),a(t+o,e-1);return((t,e,o)=>{l(t,e),a(t+o,e),a(t-1,e+1),a(t+o,e+1),a(t+o,e-1)})(t,e,s),!0}return!1},u=()=>{const t=0===Math.floor(2*Math.random())?"vertical":"horizontal",e=Math.floor(100*Math.random()),r=(()=>{const t=[...o.flat()];return t.forEach((t=>{!0===t.hasBeenHit?t.availability=!1:t.availability=!0})),t})()[e];return!1===r.availability?u():{elementColumn:r.column,elementRow:r.row,randomDirection:t}};let h=t=>{let e=Math.floor(10*Math.random()),o=Math.floor(10*Math.random()),n=Math.round(Math.random());return(0!==n||(n="horizontal",!1!==s(e,o,n,r(t))))&&(1!==n||(n="vertical",!1!==s(e,o,n,r(t))))&&void 0};return{clearBoard:()=>{o=e()},checkIfLocationIsAShipOrOffLimits:c,checkIfOffLimitZoneWasCorrectlyImplemented:t=>o.flat().filter((t=>!0===t.offLimits)).length===t+2,getLocation:i,receiveAttack:(t,e)=>{o[t][e].hasBeenHit=!0},checkIfAllShipsHaveSunk:()=>{let t=!0;for(let e=0;e<10;e++)for(let o=0;o<10;o++){const r=i(e,o);if(!1!==r.isShip&&r.isShip&&!1===r.isSunk()){t=!1;break}}return t},placeShip:s,randomlyPlaceShips:()=>{const t=[];for(let e=0;e<n.length;e+=1){const o=n[e],{randomColumn:r,randomRow:i,randomDirection:a}=u(o.getLength());s(r,i,a,o)?t.push({randomColumn:r,randomRow:i,randomDirection:a}):e-=1}return t},makeRandomCoordinates:u,randomFleet:()=>{for(let t=0;t<2;)!1!==h(1)&&t++;for(let t=0;t<2;)!1!==h(2)&&t++;for(let t=0;t<2;)!1!==h(3)&&t++;for(let t=0;t<2;)!1!==h(4)&&t++}}}},61:t=>{t.exports=(t="player")=>({getName:()=>t,attack:(t,e,{getLocation:o,receiveAttack:r})=>{const n=o(t,e);return!1===n.hasBeenHit||n.isShip&&!1===n.getStatus().includes("unhit")?(r(t,e),n.hit?(n.hit(n.position),"You hit a ship!"):"It's a hit!"):"You have already hit this spot!"},randomPos:()=>[Math.floor(10*Math.random()),Math.floor(10*Math.random())]})},585:t=>{t.exports=(t,e="ship")=>{const o=Array(t).fill("unhit");return{getName:()=>e,getLength:()=>o.length,isSunk:()=>o.every((t=>"hit"===t)),hit:e=>{e<t&&(o[e]="hit")},getStatus:()=>o,domTargets:[],hasBeenHit:!1,offLimits:!0,isShip:!0}}}},e={};function o(r){var n=e[r];if(void 0!==n)return n.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,o),i.exports}o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=o(653),e=o.n(t),r=o(585),n=o.n(r);let i,a=!1,l=!1,c=[],s=[],u=[],h=[];function d(t,e,o,r){a=t,void 0!==e&&(l=e),void 0!==o&&(c=[o,r]),0==s.length&&void 0!==o?s=[o,r]:0!==s.length&&0==u.length&&void 0!==o&&(u=[o,r])}function f(t,e){return h=[],0!==e&&h.push([t,e-1]),9!==e&&h.push([t,e+1]),0!==t&&h.push([t-1,e]),9!==t&&h.push([t+1,e]),h}function m(t,e,o,r,n,d){let m;if(!0===r&&(c=[],s=[],u=[],h=[],a=!1,l=!1,i=""),!l&&!a)return m=e.randomPos(),y(e,o,m[0],m[1],n,d);if(0!==u.length&&a&&!t){let t;if(s[0]==u[0]-1&&(t=p("down")),s[0]==u[0]+1&&(t=p("up")),s[1]==u[1]-1&&(t=p("right")),s[1]==u[1]+1&&(t=p("left")),t[0]>=0&&t[0]<=9&&t[1]>=0&&t[1]<=9)return y(e,o,t[0],t[1],n,d)}else if(0!==u.length&&l&&!a){let t;if(c=s,u=[],"up"===i&&(t=p("down")),"down"===i&&(t=p("up")),"right"===i&&(t=p("left")),"left"===i&&(t=p("right")),t[0]>=0&&t[0]<=9&&t[1]>=0&&t[1]<=9)return y(e,o,t[0],t[1],n,d)}else if(l){0==h.length&&f(c[0],c[1]),0==h.length&&1==l&&f(s[0],s[1]);const t=h.pop();return y(e,o,t[0],t[1],n,d)}}function p(t){return"left"===t?(i="left",[c[0],c[1]-1]):"right"===t?(i="right",[c[0],c[1]+1]):"down"===t?(i="down",[c[0]+1,c[1]]):"up"===t?(i="up",[c[0]-1,c[1]]):void 0}async function y(t,e,o,r,n,i){let a=!1;const l=document.querySelector(`.player-board > .cell[column='${o}'][row='${r}']`),c=e.attack(o,r,n);if(console.log(n.getLocation(o,r)),"You have already hit this spot!"===c&&m(!0,t,e,void 0,n,i),"It's a hit!"===c&&(d(!1),l.classList.add("miss")),"You hit a ship!"===c)return d(!0,!0,o,r),l.classList.add("hit"),n.getLocation(o,r).domTargets.push(l),n.getLocation(o,r).isSunk()&&(n.getLocation(o,r).domTargets.forEach((t=>t.classList.add("sunk"))),a=!0,!0===n.checkIfAllShipsHaveSunk())?S(n,i):(await g(1e3),m(!1,t,e,a,n,i))}function g(t){return new Promise((e=>{setTimeout((()=>{e(2)}),t)}))}const S=(t,e)=>{if(t.checkIfAllShipsHaveSunk()){const t=document.querySelector(".modal"),e=document.querySelector(".modal-content > p"),o=document.querySelector(".modal-content > button");t.style.display="block",o.addEventListener("click",(()=>{location.reload()})),e.textContent="You lose!"}if(e.checkIfAllShipsHaveSunk()){const t=document.querySelector(".modal"),e=document.querySelector(".modal-content > p"),o=document.querySelector(".modal-content > button");t.style.display="block",e.textContent="You win!",o.addEventListener("click",(()=>{location.reload()}))}};var v=o(61),L=o.n(v);const k=e()(),b=e()(),w=L()(),A=L()();document.querySelector("button.randomize").addEventListener("click",(()=>{k.randomFleet()})),k.randomFleet(),b.placeShip(0,0,"horizontal",n()(5)),b.placeShip(3,4,"horizontal",n()(3)),b.placeShip(6,7,"horizontal",n()(2)),b.placeShip(9,1,"vertical",n()(3)),b.placeShip(5,9,"horizontal",n()(4));const M=(()=>{const t={};return{publish:function(e,o){Array.isArray(t[e])&&t[e].forEach((t=>{t(o)}))},subscribe:function e(o,r){Array.isArray(e[o])||(t[o]=[]),t[o].push(r);const n=t[o].length-1;return{unsubscribe(){t[o].splice(n,1)}}}}})();((t,e,o,r,n)=>{const i=document.querySelector("div.enemy-board");for(let a=0;a<10;a+=1)for(let l=0;l<10;l+=1){const c=i.querySelector(`.cell:nth-child(${10*l+a+1})`);c.setAttribute("column",a),c.setAttribute("row",l),c.addEventListener("click",(()=>{n.publish("click",{cell:c,column:a,row:l,playerBoard:t,enemyBoard:e,player:o,enemy:r})}),{once:!0})}})(k,b,w,A,M),M.subscribe("click",(({cell:t,column:e,row:o,playerBoard:r,enemyBoard:n,player:i,enemy:a})=>{(async(t,e,o,r,n,i)=>{((t,e,o,r)=>{r.attack(t,e,o)})(t,e,o,n),((t,e,o,r)=>{const n=document.querySelector(`.enemy-board > .cell[column='${e}'][row='${o}']`);r.getLocation(e,o)?.isShip&&(r.getLocation(e,o).domTargets.push(n),r.getLocation(e,o).isSunk()&&r.getLocation(e,o).domTargets.forEach((t=>t.classList.add("sunk")))),r.getLocation(e,o).isShip?n.classList.add("hit"):n.classList.add("miss")})(0,t,e,o),await g(700),o.checkIfAllShipsHaveSunk()?S(r,o):m(!1,n,i,void 0,r,o)})(e,o,n,r,i,a)})),(({getLocation:t})=>{const e=document.querySelector("div.player-board");for(let o=0;o<10;o+=1)for(let r=0;r<10;r+=1){const n=e.querySelector(`.cell:nth-child(${10*r+o+1})`);n.setAttribute("column",o),n.setAttribute("row",r);const i=t(o,r);i.isShip&&(n.classList.add("ship"),n.setAttribute("ship-name",i.getName()))}})(k)})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE9BQU94SSxFQUFXNkYsRUFBYUMsSUFvVDlJa0QsQ0FBZ0J6SixFQUFRQyxFQUFLc0csRUFBWUQsRUFBYTBDLEVBQVFDLE1BdEpqQyxHQUFHOUksa0JBQ2hDLE1BQU11SixFQUFrQjNDLFNBQVNDLGNBQWMsb0JBRS9DLElBQUssSUFBSWhILEVBQVMsRUFBR0EsRUFBUyxHQUFJQSxHQUFVLEVBQ3hDLElBQUssSUFBSUMsRUFBTSxFQUFHQSxFQUFNLEdBQUlBLEdBQU8sRUFBRyxDQUNsQyxNQUFNa0osRUFBT08sRUFBZ0IxQyxjQUN6QixtQkFBeUIsR0FBTi9HLEVBQVdELEVBQVMsTUFFM0NtSixFQUFLQyxhQUFhLFNBQVVwSixHQUM1Qm1KLEVBQUtDLGFBQWEsTUFBT25KLEdBQ3pCLE1BQU1TLEVBQVdQLEVBQVlILEVBQVFDLEdBQ2pDUyxFQUFTakIsU0FDVDBKLEVBQUtoQyxVQUFVQyxJQUFJLFFBQ25CK0IsRUFBS0MsYUFBYSxZQUFhMUksRUFBU2dELGNDaEx4RGlHLENBQWtCckQsSSIsInNvdXJjZXMiOlsid2VicGFjazovL3RvcC1iYXR0bGVzaGlwLy4vc3JjL2dhbWVib2FyZC9nYW1lYm9hcmQuanMiLCJ3ZWJwYWNrOi8vdG9wLWJhdHRsZXNoaXAvLi9zcmMvcGxheWVyL3BsYXllci5qcyIsIndlYnBhY2s6Ly90b3AtYmF0dGxlc2hpcC8uL3NyYy9zaGlwL3NoaXAuanMiLCJ3ZWJwYWNrOi8vdG9wLWJhdHRsZXNoaXAvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vdG9wLWJhdHRsZXNoaXAvd2VicGFjay9ydW50aW1lL2NvbXBhdCBnZXQgZGVmYXVsdCBleHBvcnQiLCJ3ZWJwYWNrOi8vdG9wLWJhdHRsZXNoaXAvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3RvcC1iYXR0bGVzaGlwL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vdG9wLWJhdHRsZXNoaXAvLi9zcmMvYm90LmpzIiwid2VicGFjazovL3RvcC1iYXR0bGVzaGlwLy4vc3JjL2RvbS5qcyIsIndlYnBhY2s6Ly90b3AtYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcbi8qIGVzbGludC1kaXNhYmxlIG5vLW11bHRpLWFzc2lnbiAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLWV4cHJlc3Npb25zICovXG5jb25zdCBjcmVhdGVTaGlwID0gcmVxdWlyZSgnLi4vc2hpcC9zaGlwJylcblxuLyogZXNsaW50LWRpc2FibGUgbm8tcGFyYW0tcmVhc3NpZ24gKi9cbmNvbnN0IGNyZWF0ZUdhbWVCb2FyZCA9ICgpID0+IHtcbiAgICBjb25zdCBlbXB0eUNlbGwgPSB7IGhhc0JlZW5IaXQ6IGZhbHNlLCBpc1NoaXA6IGZhbHNlLCBvZmZMaW1pdHM6IGZhbHNlIH1cbiAgICBcbiAgICBjb25zdCBpbml0aWFsaXplQm9hcmQgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGdhbWVCb2FyZCA9IEFycmF5KDEwKS5maWxsKCkubWFwKCgpID0+IEFycmF5KDEwKS5maWxsKCkpXG4gICAgICAgIGZvcihsZXQgY29sdW1uPSAwOyBjb2x1bW4gPCAxMDsgY29sdW1uKyspe1xuICAgICAgICAgICAgZm9yKGxldCByb3c9IDA7IHJvdyA8IDEwOyByb3crKyl7XG4gICAgICAgICAgICAgICAgZ2FtZUJvYXJkW2NvbHVtbl1bcm93XSA9IHsuLi5lbXB0eUNlbGwsIGNvbHVtbiwgcm93fVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBnYW1lQm9hcmRcbiAgICBcbiAgICB9XG5cbiAgICBsZXQgZ2FtZUJvYXJkID0gaW5pdGlhbGl6ZUJvYXJkKClcblxuICAgIGNvbnN0IHNoaXBzID0gW1xuICAgICAgICBjcmVhdGVTaGlwKDUsICdDYXJyaWVyJyksXG4gICAgICAgIGNyZWF0ZVNoaXAoNCwgJ0JhdHRsZXNoaXAnKSxcbiAgICAgICAgY3JlYXRlU2hpcCgzLCAnRGVzdHJveWVyJyksXG4gICAgICAgIGNyZWF0ZVNoaXAoMywgJ1N1Ym1hcmluZScpLFxuICAgICAgICBjcmVhdGVTaGlwKDIsICdQYXRyb2wgQm9hdCcpLFxuICAgIF1cblxuXG4gICAgY29uc3QgY3JlYXRlT2ZmTGltaXRMb2NhdGlvbiA9ICgpID0+XG4gICAgICAgIE9iamVjdC5hc3NpZ24oZW1wdHlDZWxsLCB7IG9mZkxpbWl0czogdHJ1ZSB9KVxuXG4gICAgY29uc3QgZ2V0TG9jYXRpb24gPSAoY29sdW1uLCByb3cpID0+IGdhbWVCb2FyZD8uW2NvbHVtbl0/Lltyb3ddXG5cbiAgICBjb25zdCBzZXRMb2NhdGlvbiA9IChjb2x1bW4sIHJvdywgc2hpcCA9IGNyZWF0ZU9mZkxpbWl0TG9jYXRpb24oKSkgPT4ge1xuICAgICAgICBpZiAoZ2FtZUJvYXJkPy5bY29sdW1uXT8uW3Jvd10gPT09IHVuZGVmaW5lZCkgcmV0dXJuIHRydWVcbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSBnYW1lQm9hcmRbY29sdW1uXVtyb3ddXG5cbiAgICAgICAgZ2FtZUJvYXJkW2NvbHVtbl1bcm93XSA9IHsuLi5sb2NhdGlvbiwgLi4uc2hpcH1cbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gICAgY29uc3QgY2hlY2tJZkFsbFNoaXBzSGF2ZVN1bmsgPSAoKSA9PiB7XG5cbiAgICAgICAgbGV0IGhhdmVBbGxTaGlwc1N1bmsgPXRydWUgIFxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICAgIGNvbnN0IGxvY2F0aW9uID0gZ2V0TG9jYXRpb24oaSwgailcbiAgICAgICAgaWYobG9jYXRpb24uaXNTaGlwID09PSBmYWxzZSkgY29udGludWVcbiAgICAgICAgaWYobG9jYXRpb24uaXNTaGlwICYmIGxvY2F0aW9uLmlzU3VuaygpID09PSBmYWxzZSl7XG4gICAgICAgICAgIGhhdmVBbGxTaGlwc1N1bmsgPSBmYWxzZSBcbiAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGhhdmVBbGxTaGlwc1N1bmsgXG4gICAgfVxuXG4gICAgY29uc3QgYWRkT2ZmTGltaXRBcmVhRm9yU2hpcHMgPSAoY29sdW1uLCByb3cpID0+IHtcbiAgICAgICAgLy8gdG9wLWxlZnRcbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uIC0gMSwgcm93IC0gMSlcbiAgICAgICAgLy8gdG9wXG4gICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiwgcm93IC0gMSlcbiAgICB9XG5cbiAgICBjb25zdCBhZGRPZmZMaW1pdEFyZWFGb3JIb3Jpem9udGFsbHlQb3NpdGlvbmVkU2hpcCA9IChcbiAgICAgICAgY29sdW1uLFxuICAgICAgICByb3csXG4gICAgICAgIHNoaXBMZW5ndGhcbiAgICApID0+IHtcbiAgICAgICAgLy8gcG9zaXRpb25zIHJlbGF0aXZlIHRvIHRoZSBzaGlwIGl0c2VsZihpZS4gYSBob3Jpem9udGFsIHNoaXAncyBib3R0b20gaXMgdG8gdGhlIHJpZ2h0KVxuXG4gICAgICAgIGFkZE9mZkxpbWl0QXJlYUZvclNoaXBzKGNvbHVtbiwgcm93KVxuICAgICAgICAvLyBib3R0b21cbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uICsgc2hpcExlbmd0aCwgcm93KVxuICAgICAgICAvLyBib3R0b20tbGVmdFxuICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gLSAxLCByb3cgKyAxKVxuICAgICAgICAvLyBib3R0b20tcmlnaHRcbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uICsgc2hpcExlbmd0aCwgcm93ICsgMSlcbiAgICAgICAgLy8gdG9wLXJpZ2h0XG4gICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIHNoaXBMZW5ndGgsIHJvdyAtIDEpXG4gICAgfVxuXG4gICAgY29uc3QgYWRkT2ZmTGltaXRBcmVhRm9yVmVydGljYWxseVBvc2l0aW9uZWRTaGlwID0gKFxuICAgICAgICBjb2x1bW4sXG4gICAgICAgIHJvdyxcbiAgICAgICAgc2hpcExlbmd0aFxuICAgICkgPT4ge1xuICAgICAgICAvLyBwb3NpdGlvbnMgcmVsYXRpdmUgdG8gaG93IHRoZSB1c2VyIHNlZXMgaXQoaWUuIGEgdmVydGljYWwgc2hpcCdzIGJvdHRvbSBpcyB0byB0aGUgYm90dG9tKVxuXG4gICAgICAgIGFkZE9mZkxpbWl0QXJlYUZvclNoaXBzKGNvbHVtbiwgcm93KVxuICAgICAgICAvLyBib3R0b21cbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uLCByb3cgKyBzaGlwTGVuZ3RoKVxuICAgICAgICAvLyBib3R0b20tcmlnaHRcbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uICsgMSwgcm93ICsgc2hpcExlbmd0aClcbiAgICAgICAgLy8gYm90dG9tLWxlZnRcbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uIC0gMSwgcm93ICsgc2hpcExlbmd0aClcbiAgICAgICAgLy8gdG9wLXJpZ2h0XG4gICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIDEsIHJvdyAtIDEpXG4gICAgfVxuXG4gICAgY29uc3QgY2hlY2tJZkNvbHVtbkNvb3JkaW5hdGVJc1ZhbGlkID0gKGNvbHVtbiwgc2hpcExlbmd0aCkgPT5cbiAgICAgICAgY29sdW1uID49IDAgJiYgY29sdW1uICsgc2hpcExlbmd0aCAtIDEgPCBnYW1lQm9hcmQubGVuZ3RoXG5cbiAgICBjb25zdCBjaGVja0lmUm93Q29vcmRpbmF0ZUlzVmFsaWQgPSAocm93LCBzaGlwTGVuZ3RoKSA9PlxuICAgICAgICByb3cgPj0gMCAmJiByb3cgKyBzaGlwTGVuZ3RoIC0gMSA8IGdhbWVCb2FyZC5sZW5ndGhcblxuXG4gICAgY29uc3QgY2hlY2tJZkxvY2F0aW9uSXNBU2hpcE9yT2ZmTGltaXRzID0gKFxuICAgICAgICBjb2x1bW4sXG4gICAgICAgIHJvdyxcbiAgICAgICAgZGlyZWN0aW9uLFxuICAgICAgICBzaGlwTGVuZ3RoXG4gICAgKSA9PiB7XG4gICAgICAgIGlmIChkaXJlY3Rpb24gPT09ICd2ZXJ0aWNhbCcpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcExlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbG9jYXRpb24gPSBnZXRMb2NhdGlvbihjb2x1bW4sIHJvdyArIGkpXG4gICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmlzU2hpcCA9PT0gdHJ1ZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24ub2ZmTGltaXRzID09PSB0cnVlXG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGlyZWN0aW9uID09PSAnaG9yaXpvbnRhbCcpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcExlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbG9jYXRpb24gPSBnZXRMb2NhdGlvbihjb2x1bW4gKyBpLCByb3cpXG4gICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmlzU2hpcCA9PT0gdHJ1ZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24ub2ZmTGltaXRzID09PSB0cnVlXG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICAgIC8vIG1ha2VzIHRpbGVzIGFyb3VuZCBzaGlwIFwicmVzZXJ2ZWRcIlxuICBsZXQgcmVzZXJ2ZUFyb3VuZCA9IChwb3MxLCBwb3MyKSA9PiB7XG4gICAgZnVuY3Rpb24gY2VsbChuMSwgbjIpIHtcbiAgICAgIGlmIChwb3MxICsgbjEgPiA5IHx8IHBvczEgKyBuMSA8IDApIHJldHVybjtcbiAgICAgIGlmIChnYW1lQm9hcmRbcG9zMSArIG4xXVtwb3MyICsgbjJdID09PSBmYWxzZSlcbiAgICAgICAgZ2FtZUJvYXJkW3BvczEgKyBuMV1bcG9zMiArIG4yXSA9IFwicmVzXCI7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHJlc2VydmVDZWxsKHJvdykge1xuICAgICAgY2VsbChyb3csIC0xKTtcbiAgICAgIGNlbGwocm93LCAwKTtcbiAgICAgIGNlbGwocm93LCAxKTtcbiAgICB9XG4gICAgcmVzZXJ2ZUNlbGwoLTEpO1xuICAgIHJlc2VydmVDZWxsKDApO1xuICAgIHJlc2VydmVDZWxsKDEpO1xuICB9O1xuXG4gICAgY29uc3QgcGxhY2VTaGlwID0gKGNvbHVtbiwgcm93LCBkaXJlY3Rpb24sIHNoaXApID0+IHtcbiAgICAgICAgY29uc3Qgc2hpcExlbmd0aCA9IHNoaXAuZ2V0TGVuZ3RoKClcbiAgICAgICAgaWYgKGNoZWNrSWZMb2NhdGlvbklzQVNoaXBPck9mZkxpbWl0cyhnZXRMb2NhdGlvbihjb2x1bW4sIHJvdywgZGlyZWN0aW9uLCBzaGlwTGVuZ3RoKSkpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gJ3ZlcnRpY2FsJykge1xuICAgICAgICAgICAgaWYgKGNoZWNrSWZSb3dDb29yZGluYXRlSXNWYWxpZChyb3csIHNoaXBMZW5ndGgpKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwTGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uLCByb3cgKyBpLCB7Li4uc2hpcCwgcG9zaXRpb246IGl9KVxuICAgICAgICAgICAgICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gKyAxLCByb3cgKyBpKVxuICAgICAgICAgICAgICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gLSAxLCByb3cgKyBpKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhZGRPZmZMaW1pdEFyZWFGb3JWZXJ0aWNhbGx5UG9zaXRpb25lZFNoaXAoXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbixcbiAgICAgICAgICAgICAgICAgICAgcm93LFxuICAgICAgICAgICAgICAgICAgICBzaGlwTGVuZ3RoXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAnaG9yaXpvbnRhbCcpIHtcbiAgICAgICAgICAgIGlmIChjaGVja0lmQ29sdW1uQ29vcmRpbmF0ZUlzVmFsaWQoY29sdW1uLCBzaGlwTGVuZ3RoKSkge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcExlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIGkgLCByb3csIHsuLi5zaGlwLCBwb3NpdGlvbjogaX0pXG4gICAgICAgICAgICAgICAgICAgIC8vc2V0TG9jYXRpb24oY29sdW1uICsgaSwgcm93LCBzaGlwKVxuICAgICAgICAgICAgICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gKyBpLCByb3cgKyAxKVxuICAgICAgICAgICAgICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gKyBpLCByb3cgLSAxKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhZGRPZmZMaW1pdEFyZWFGb3JIb3Jpem9udGFsbHlQb3NpdGlvbmVkU2hpcChcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uLFxuICAgICAgICAgICAgICAgICAgICByb3csXG4gICAgICAgICAgICAgICAgICAgIHNoaXBMZW5ndGhcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gICAgICAgIGNvbnN0IGF2YWlsYWJsZVNwYWNlcyA9ICgpID0+e1xuXG4gICAgICAgIGNvbnN0IGZsYXR0ZW5lZEdhbWVCb2FyZCA9IFsuLi5nYW1lQm9hcmQuZmxhdCgpXVxuXG4gICAgICAgICAgICBmbGF0dGVuZWRHYW1lQm9hcmQuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmKGVsZW1lbnQuaGFzQmVlbkhpdCA9PT0gdHJ1ZSl7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYXZhaWxhYmlsaXR5ID0gZmFsc2VcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hdmFpbGFiaWxpdHkgPXRydWUgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIHJldHVybiBmbGF0dGVuZWRHYW1lQm9hcmRcblxuICAgICAgICB9XG4gICAgY29uc3QgbWFrZVJhbmRvbUNvb3JkaW5hdGVzID0gKCkgPT4ge1xuICAgICAgICBjb25zdCByYW5kb21EaXJlY3Rpb24gPVxuICAgICAgICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMikgPT09IDAgPyAndmVydGljYWwnIDogJ2hvcml6b250YWwnXG4gICAgICAgIGNvbnN0IHJhbmRvbUxvY2F0aW9uID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKVxuICAgICAgICBjb25zdCBmbGF0dGVuZWRHYW1lQm9hcmQgPSBhdmFpbGFibGVTcGFjZXMoKVxuXG4gICAgICAgIGNvbnN0IGxvY2F0aW9uID0gZmxhdHRlbmVkR2FtZUJvYXJkW3JhbmRvbUxvY2F0aW9uXVxuXG4gICAgICAgIGlmKGxvY2F0aW9uLmF2YWlsYWJpbGl0eSA9PT0gZmFsc2Upe1xuICAgICAgICAgICAgcmV0dXJuIG1ha2VSYW5kb21Db29yZGluYXRlcygpXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBlbGVtZW50Q29sdW1uID0gbG9jYXRpb24uY29sdW1uXG4gICAgICAgIGNvbnN0IGVsZW1lbnRSb3cgPSBsb2NhdGlvbi5yb3dcblxuXG4gICAgICAgIHJldHVybiB7IGVsZW1lbnRDb2x1bW4sIGVsZW1lbnRSb3csIHJhbmRvbURpcmVjdGlvbiB9XG4gICAgfVxuXG4gIC8vIGNyZWF0ZXMgYSBzaGlwIHdpdGggcmFuZG9tIHBvcyBhbmQgb3JpZW50YXRpb25cbiAgbGV0IHJhbmRvbVNoaXAgPSAobGVuZ3RoKSA9PiB7XG4gICAgbGV0IHBvczEgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgbGV0IHBvczIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgbGV0IGRpciA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSk7XG5cbiAgICBpZiAoZGlyID09PSAwKSB7XG4gICAgICBkaXIgPSBcImhvcml6b250YWxcIjtcbiAgICAgIGlmIChwbGFjZVNoaXAocG9zMSwgcG9zMiwgZGlyLCBjcmVhdGVTaGlwKGxlbmd0aCkpID09PSBmYWxzZSkgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChkaXIgPT09IDEpIHtcbiAgICAgIGRpciA9IFwidmVydGljYWxcIjtcbiAgICAgIGlmIChwbGFjZVNoaXAocG9zMSwgcG9zMiwgZGlyLCBjcmVhdGVTaGlwKGxlbmd0aCkpID09PSBmYWxzZSkgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfTtcblxuICAgIGxldCByYW5kb21GbGVldCA9ICgpID0+IHtcbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IDI7KSB7XG4gICAgICAgICAgICBpZihyYW5kb21TaGlwKDEpID09PSBmYWxzZSkgY29udGludWUgXG4gICAgICAgICAgICBpKytcbiAgICAgICAgfVxuXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCAyOykge1xuICAgICAgICAgICAgaWYocmFuZG9tU2hpcCgyKSA9PT0gZmFsc2UpIGNvbnRpbnVlIFxuICAgICAgICAgICAgaSsrXG4gICAgICAgIH1cbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IDI7KSB7XG4gICAgICAgICAgICBpZihyYW5kb21TaGlwKDMpID09PSBmYWxzZSkgY29udGludWUgXG4gICAgICAgICAgICBpKytcbiAgICAgICAgfVxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgMjspIHtcbiAgICAgICAgICAgIGlmKHJhbmRvbVNoaXAoNCkgPT09IGZhbHNlKSBjb250aW51ZSBcbiAgICAgICAgICAgIGkrK1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgcmFuZG9tbHlQbGFjZVNoaXBzID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBzaGlwRGV0YWlscyA9IFtdXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcHMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IHNoaXAgPSBzaGlwc1tpXVxuICAgICAgICAgICAgY29uc3QgeyByYW5kb21Db2x1bW4sIHJhbmRvbVJvdywgcmFuZG9tRGlyZWN0aW9uIH0gPVxuICAgICAgICAgICAgICAgIG1ha2VSYW5kb21Db29yZGluYXRlcyhzaGlwLmdldExlbmd0aCgpKVxuICAgICAgICAgICAgaWYgKHBsYWNlU2hpcChyYW5kb21Db2x1bW4sIHJhbmRvbVJvdywgcmFuZG9tRGlyZWN0aW9uLCBzaGlwKSkge1xuICAgICAgICAgICAgICAgIHNoaXBEZXRhaWxzLnB1c2goeyByYW5kb21Db2x1bW4sIHJhbmRvbVJvdywgcmFuZG9tRGlyZWN0aW9uIH0pXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGkgLT0gMVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzaGlwRGV0YWlsc1xuICAgIH1cblxuICAgIGNvbnN0IHJlY2VpdmVBdHRhY2sgPSAoY29sdW1uLCByb3cpID0+IHtcbiAgICAgICAgZ2FtZUJvYXJkW2NvbHVtbl1bcm93XS5oYXNCZWVuSGl0ID0gdHJ1ZVxuICAgIH1cblxuICAgIGNvbnN0IGNoZWNrSWZPZmZMaW1pdFpvbmVXYXNDb3JyZWN0bHlJbXBsZW1lbnRlZCA9IChzaGlwTGVuZ3RoKSA9PlxuICAgICAgICBnYW1lQm9hcmQuZmxhdCgpLmZpbHRlcigoZWxlbWVudCkgPT4gZWxlbWVudC5vZmZMaW1pdHMgPT09IHRydWUpXG4gICAgICAgICAgICAubGVuZ3RoID09PVxuICAgICAgICBzaGlwTGVuZ3RoICsgMlxuICAgIC8vIGFkZGluZyBzaGlwTGVuZ3RoIHBsdXMgdHdvIGJlY2F1c2UgZm9yIGV2ZXJ5IGluY3JlYXNlIGluIHRoZSBzaXplIG9mIHNoaXAsIHRoZSB6b25lcyBjb3ZlcmVkIGluY3JlYXNlIGJ5IDIgdW5pdHNcblxuICAgIGNvbnN0IGNsZWFyQm9hcmQgID0gKCkgPT4ge1xuICAgICAgICBnYW1lQm9hcmQgPSBpbml0aWFsaXplQm9hcmQoKVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIGNsZWFyQm9hcmQsXG4gICAgICAgIGNoZWNrSWZMb2NhdGlvbklzQVNoaXBPck9mZkxpbWl0cyxcbiAgICAgICAgY2hlY2tJZk9mZkxpbWl0Wm9uZVdhc0NvcnJlY3RseUltcGxlbWVudGVkLFxuICAgICAgICBnZXRMb2NhdGlvbixcbiAgICAgICAgcmVjZWl2ZUF0dGFjayxcbiAgICAgICAgY2hlY2tJZkFsbFNoaXBzSGF2ZVN1bmssXG4gICAgICAgIHBsYWNlU2hpcCxcbiAgICAgICAgcmFuZG9tbHlQbGFjZVNoaXBzLFxuICAgICAgICBtYWtlUmFuZG9tQ29vcmRpbmF0ZXMsXG4gICAgICAgIHJhbmRvbUZsZWV0LFxuICAgIH1cbn1cbm1vZHVsZS5leHBvcnRzID0gY3JlYXRlR2FtZUJvYXJkIiwiY29uc3QgY3JlYXRlUGxheWVyID0gKG5hbWUgPSAncGxheWVyJykgPT4ge1xuICAgIGNvbnN0IGdldE5hbWUgPSAoKSA9PiBuYW1lXG5cbiAgICBjb25zdCBhdHRhY2sgPSAoY29sdW1uLCByb3csIHsgZ2V0TG9jYXRpb24sIHJlY2VpdmVBdHRhY2sgfSkgPT4ge1xuICAgICAgICBjb25zdCBsb2NhdGlvbiA9IGdldExvY2F0aW9uKGNvbHVtbiwgcm93KVxuICAgICAgICBpZiAobG9jYXRpb24uaGFzQmVlbkhpdCA9PT0gZmFsc2UgfHwgKGxvY2F0aW9uLmlzU2hpcCAmJiBsb2NhdGlvbi5nZXRTdGF0dXMoKS5pbmNsdWRlcygndW5oaXQnKSA9PT0gZmFsc2UpKSB7XG4gICAgICAgICAgICByZWNlaXZlQXR0YWNrKGNvbHVtbiwgcm93KVxuICAgICAgICAgICAgaWYobG9jYXRpb24uaGl0KXtcblxuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhpdChsb2NhdGlvbi5wb3NpdGlvbilcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJZb3UgaGl0IGEgc2hpcCFcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFwiSXQncyBhIGhpdCFcIlxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuICdZb3UgaGF2ZSBhbHJlYWR5IGhpdCB0aGlzIHNwb3QhJ1xuICAgIH1cblxuICAgICAgbGV0IHJhbmRvbVBvcyA9ICgpID0+IHtcbiAgICBsZXQgcG9zMSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICBsZXQgcG9zMiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwKTtcbiAgICByZXR1cm4gW3BvczEsIHBvczJdO1xuICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZ2V0TmFtZSxcbiAgICAgICAgYXR0YWNrLFxuICAgICAgICByYW5kb21Qb3MsXG4gICAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZVBsYXllclxuIiwiY29uc3QgY3JlYXRlU2hpcCA9IChsZW5ndGgsIG5hbWUgPSAnc2hpcCcpID0+IHtcblxuICAgIGxldCBkb21UYXJnZXRzID0gW11cblxuICAgIGNvbnN0IHN0YXR1cyA9IEFycmF5KGxlbmd0aCkuZmlsbCgndW5oaXQnKVxuXG4gICAgY29uc3QgZ2V0TGVuZ3RoID0gKCkgPT4gc3RhdHVzLmxlbmd0aFxuXG4gICAgY29uc3QgZ2V0U3RhdHVzID0gKCkgPT4gc3RhdHVzXG5cbiAgICBjb25zdCBoaXQgPSAocG9zaXRpb24pID0+IHtcbiAgICAgICAgaWYgKHBvc2l0aW9uIDwgbGVuZ3RoKSB7XG4gICAgICAgICAgICBzdGF0dXNbcG9zaXRpb25dID0gJ2hpdCdcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGdldE5hbWUgPSAoKSA9PiAgbmFtZVxuXG4gICAgY29uc3QgaXNTdW5rID0gKCkgPT4gc3RhdHVzLmV2ZXJ5KChwb3NpdGlvbikgPT4gcG9zaXRpb24gPT09ICdoaXQnKVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZ2V0TmFtZSxcbiAgICAgICAgZ2V0TGVuZ3RoLFxuICAgICAgICBpc1N1bmssXG4gICAgICAgIGhpdCxcbiAgICAgICAgZ2V0U3RhdHVzLFxuICAgICAgICBkb21UYXJnZXRzLFxuICAgICAgICBoYXNCZWVuSGl0OiBmYWxzZSxcbiAgICAgICAgb2ZmTGltaXRzOiB0cnVlLFxuICAgICAgICBpc1NoaXA6IHRydWUsXG4gICAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZVNoaXBcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gKG1vZHVsZSkgPT4ge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHQoKSA9PiAobW9kdWxlWydkZWZhdWx0J10pIDpcblx0XHQoKSA9PiAobW9kdWxlKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvKiBlc2xpbnQtZGlzYWJsZSBuby1lbHNlLXJldHVybiAqL1xuaW1wb3J0IHtyZW5kZXJBdHRhY2tQMiB9IGZyb20gJy4vZG9tJ1xuXG5sZXQgd2FzSGl0ID0gZmFsc2U7XG5sZXQgc3RhdHVzID0gZmFsc2U7XG5sZXQgbGFzdEhpdFBvcyA9IFtdO1xubGV0IGZpcnN0SGl0UG9zID0gW107XG5sZXQgc2Vjb25kSGl0UG9zID0gW107XG5sZXQgc3Vycm91bmRpbmdQb3MgPSBbXTtcbmxldCBhdHRhY2tEaXJlY3Rpb247XG5cbmZ1bmN0aW9uIHNldFdhc0hpdCh2YWx1ZSwgc3RhdCwgcG9zMSwgcG9zMikge1xuICB3YXNIaXQgPSB2YWx1ZTtcbiAgaWYgKHN0YXQgIT09IHVuZGVmaW5lZCkgc3RhdHVzID0gc3RhdDtcbiAgaWYgKHBvczEgIT09IHVuZGVmaW5lZCkgbGFzdEhpdFBvcyA9IFtwb3MxLCBwb3MyXTtcbiAgaWYgKGZpcnN0SGl0UG9zLmxlbmd0aCA9PSAwICYmIHBvczEgIT09IHVuZGVmaW5lZCkgZmlyc3RIaXRQb3MgPSBbcG9zMSwgcG9zMl07XG4gIGVsc2UgaWYgKFxuICAgIGZpcnN0SGl0UG9zLmxlbmd0aCAhPT0gMCAmJlxuICAgIHNlY29uZEhpdFBvcy5sZW5ndGggPT0gMCAmJlxuICAgIHBvczEgIT09IHVuZGVmaW5lZFxuICApXG4gICAgc2Vjb25kSGl0UG9zID0gW3BvczEsIHBvczJdO1xufVxuZnVuY3Rpb24gZ2V0V2FzSGl0KCkge1xuICByZXR1cm4gW3dhc0hpdCwgbGFzdEhpdFBvcywgc3RhdHVzXTtcbn1cblxuZnVuY3Rpb24gcmVnaXN0ZXJTdXJyb3VuZGluZ1Bvcyhwb3MxLCBwb3MyKSB7XG4gIHN1cnJvdW5kaW5nUG9zID0gW107XG4gIGlmIChwb3MyICE9PSAwKSBzdXJyb3VuZGluZ1Bvcy5wdXNoKFtwb3MxLCBwb3MyIC0gMV0pO1xuICBpZiAocG9zMiAhPT0gOSkgc3Vycm91bmRpbmdQb3MucHVzaChbcG9zMSwgcG9zMiArIDFdKTtcbiAgaWYgKHBvczEgIT09IDApIHN1cnJvdW5kaW5nUG9zLnB1c2goW3BvczEgLSAxLCBwb3MyXSk7XG4gIGlmIChwb3MxICE9PSA5KSBzdXJyb3VuZGluZ1Bvcy5wdXNoKFtwb3MxICsgMSwgcG9zMl0pO1xuICByZXR1cm4gc3Vycm91bmRpbmdQb3M7XG59XG5cbmZ1bmN0aW9uIGFpUGxheShyZXBlYXQsIHAxLCBwMiwgaXNTdW5rLCBwbGF5ZXJCb2FyZCwgZW5lbXlCb2FyZCkge1xuICBsZXQgcG9zOyBsZXQgcG9zMTsgbGV0IHBvczI7XG4gIGlmIChpc1N1bmsgPT09IHRydWUpIHtcbiAgICBsYXN0SGl0UG9zID0gW107XG4gICAgZmlyc3RIaXRQb3MgPSBbXTtcbiAgICBzZWNvbmRIaXRQb3MgPSBbXTtcbiAgICBzdXJyb3VuZGluZ1BvcyA9IFtdO1xuICAgIHdhc0hpdCA9IGZhbHNlO1xuICAgIHN0YXR1cyA9IGZhbHNlO1xuICAgIGF0dGFja0RpcmVjdGlvbiA9IFwiXCI7XG4gIH1cbiAgaWYgKCFzdGF0dXMgJiYgIXdhc0hpdCkge1xuICAgIHBvcyA9IHAxLnJhbmRvbVBvcygpO1xuXG4gICAgcmV0dXJuIHJlbmRlckF0dGFja1AyKHAxLCBwMiwgcG9zWzBdLCBwb3NbMV0sIHBsYXllckJvYXJkLCBlbmVteUJvYXJkKTtcbiAgfSBlbHNlIGlmIChzZWNvbmRIaXRQb3MubGVuZ3RoICE9PSAwICYmIHdhc0hpdCAmJiAhcmVwZWF0KSB7XG4gICAgbGV0IG5ld1BvcztcbiAgICBpZiAoZmlyc3RIaXRQb3NbMF0gPT0gc2Vjb25kSGl0UG9zWzBdIC0gMSkgbmV3UG9zID0gYXR0YWNrVG93YXJkcyhcImRvd25cIik7XG4gICAgaWYgKGZpcnN0SGl0UG9zWzBdID09IHNlY29uZEhpdFBvc1swXSArIDEpIG5ld1BvcyA9IGF0dGFja1Rvd2FyZHMoXCJ1cFwiKTtcbiAgICBpZiAoZmlyc3RIaXRQb3NbMV0gPT0gc2Vjb25kSGl0UG9zWzFdIC0gMSkgbmV3UG9zID0gYXR0YWNrVG93YXJkcyhcInJpZ2h0XCIpO1xuICAgIGlmIChmaXJzdEhpdFBvc1sxXSA9PSBzZWNvbmRIaXRQb3NbMV0gKyAxKSBuZXdQb3MgPSBhdHRhY2tUb3dhcmRzKFwibGVmdFwiKTtcbiAgICBpZiAobmV3UG9zWzBdID49IDAgJiYgbmV3UG9zWzBdIDw9IDkgJiYgbmV3UG9zWzFdID49IDAgJiYgbmV3UG9zWzFdIDw9IDkpXG4gICAgICByZXR1cm4gcmVuZGVyQXR0YWNrUDIocDEsIHAyLCBuZXdQb3NbMF0sIG5ld1Bvc1sxXSwgcGxheWVyQm9hcmQsIGVuZW15Qm9hcmQpO1xuICB9IGVsc2UgaWYgKHNlY29uZEhpdFBvcy5sZW5ndGggIT09IDAgJiYgc3RhdHVzICYmICF3YXNIaXQpIHtcbiAgICBsYXN0SGl0UG9zID0gZmlyc3RIaXRQb3M7XG4gICAgc2Vjb25kSGl0UG9zID0gW107XG4gICAgbGV0IG5ld1BvcztcbiAgICBpZiAoYXR0YWNrRGlyZWN0aW9uID09PSBcInVwXCIpIG5ld1BvcyA9IGF0dGFja1Rvd2FyZHMoXCJkb3duXCIpO1xuICAgIGlmIChhdHRhY2tEaXJlY3Rpb24gPT09IFwiZG93blwiKSBuZXdQb3MgPSBhdHRhY2tUb3dhcmRzKFwidXBcIik7XG4gICAgaWYgKGF0dGFja0RpcmVjdGlvbiA9PT0gXCJyaWdodFwiKSBuZXdQb3MgPSBhdHRhY2tUb3dhcmRzKFwibGVmdFwiKTtcbiAgICBpZiAoYXR0YWNrRGlyZWN0aW9uID09PSBcImxlZnRcIikgbmV3UG9zID0gYXR0YWNrVG93YXJkcyhcInJpZ2h0XCIpO1xuICAgIGlmIChuZXdQb3NbMF0gPj0gMCAmJiBuZXdQb3NbMF0gPD0gOSAmJiBuZXdQb3NbMV0gPj0gMCAmJiBuZXdQb3NbMV0gPD0gOSlcbiAgICAgIHJldHVybiByZW5kZXJBdHRhY2tQMihwMSwgcDIsIG5ld1Bvc1swXSwgbmV3UG9zWzFdLCBwbGF5ZXJCb2FyZCwgZW5lbXlCb2FyZCk7XG4gIH0gZWxzZSBpZiAoc3RhdHVzKSB7XG4gICAgaWYgKHN1cnJvdW5kaW5nUG9zLmxlbmd0aCA9PSAwKVxuICAgICAgcmVnaXN0ZXJTdXJyb3VuZGluZ1BvcyhsYXN0SGl0UG9zWzBdLCBsYXN0SGl0UG9zWzFdKTtcbiAgICBpZiAoc3Vycm91bmRpbmdQb3MubGVuZ3RoID09IDAgJiYgc3RhdHVzID09IHRydWUpXG4gICAgICByZWdpc3RlclN1cnJvdW5kaW5nUG9zKGZpcnN0SGl0UG9zWzBdLCBmaXJzdEhpdFBvc1sxXSk7XG4gICAgY29uc3QgbmV3UG9zID0gc3Vycm91bmRpbmdQb3MucG9wKCk7XG4gICAgcmV0dXJuIHJlbmRlckF0dGFja1AyKHAxLCBwMiwgbmV3UG9zWzBdLCBuZXdQb3NbMV0sIHBsYXllckJvYXJkLCBlbmVteUJvYXJkKTtcbiAgfVxufVxuLy8gZ2V0IHBvcyBvZiBhdHRhY2sgYmFzZWQgb24gZGlyZWN0aW9uXG5mdW5jdGlvbiBhdHRhY2tUb3dhcmRzKGRpcikge1xuICBpZiAoZGlyID09PSBcImxlZnRcIikge1xuICAgIGF0dGFja0RpcmVjdGlvbiA9IFwibGVmdFwiO1xuICAgIHJldHVybiBbbGFzdEhpdFBvc1swXSwgbGFzdEhpdFBvc1sxXSAtIDFdO1xuICB9XG4gIGlmIChkaXIgPT09IFwicmlnaHRcIikge1xuICAgIGF0dGFja0RpcmVjdGlvbiA9IFwicmlnaHRcIjtcbiAgICByZXR1cm4gW2xhc3RIaXRQb3NbMF0sIGxhc3RIaXRQb3NbMV0gKyAxXTtcbiAgfVxuICBpZiAoZGlyID09PSBcImRvd25cIikge1xuICAgIGF0dGFja0RpcmVjdGlvbiA9IFwiZG93blwiO1xuICAgIHJldHVybiBbbGFzdEhpdFBvc1swXSArIDEsIGxhc3RIaXRQb3NbMV1dO1xuICB9XG4gIGlmIChkaXIgPT09IFwidXBcIikge1xuICAgIGF0dGFja0RpcmVjdGlvbiA9IFwidXBcIjtcbiAgICByZXR1cm4gW2xhc3RIaXRQb3NbMF0gLSAxLCBsYXN0SGl0UG9zWzFdXTtcbiAgfVxufVxuXG5leHBvcnQgeyBhaVBsYXksIGdldFdhc0hpdCwgc2V0V2FzSGl0LCBsYXN0SGl0UG9zLCBzdXJyb3VuZGluZ1BvcyB9O1xuXG4iLCJpbXBvcnQgY3JlYXRlR2FtZUJvYXJkIGZyb20gXCIuL2dhbWVib2FyZC9nYW1lYm9hcmRcIlxuaW1wb3J0IGNyZWF0ZVNoaXAgZnJvbSBcIi4vc2hpcC9zaGlwXCJcbmltcG9ydCB7IGFpUGxheSwgZ2V0V2FzSGl0LCBzZXRXYXNIaXQsIHN1cnJvdW5kaW5nUG9zIH0gZnJvbSBcIi4vYm90XCI7XG5cbmNvbnN0IHJlbmRlckF0dGFja3MgPSAocGxheWVyLCBjb2x1bW4sIHJvdywgZW5lbXlCb2FyZCkgPT4ge1xuICAgIGNvbnN0IGNlbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICBgLiR7cGxheWVyfS1ib2FyZCA+IC5jZWxsW2NvbHVtbj0nJHtjb2x1bW59J11bcm93PScke3Jvd30nXWBcbiAgICApXG5cbiAgICBpZihlbmVteUJvYXJkLmdldExvY2F0aW9uKGNvbHVtbiwgcm93KT8uaXNTaGlwKXtcblxuICAgICAgICBlbmVteUJvYXJkLmdldExvY2F0aW9uKGNvbHVtbiwgcm93KS5kb21UYXJnZXRzLnB1c2goY2VsbClcbiAgICAgICAgaWYoZW5lbXlCb2FyZC5nZXRMb2NhdGlvbihjb2x1bW4sIHJvdykuaXNTdW5rKCkpe1xuXG4gICAgICAgICAgICBlbmVteUJvYXJkLmdldExvY2F0aW9uKGNvbHVtbiwgcm93KS5kb21UYXJnZXRzLmZvckVhY2goKGUpID0+IGUuY2xhc3NMaXN0LmFkZCgnc3VuaycpKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgbG9jYXRpb24gPSBlbmVteUJvYXJkLmdldExvY2F0aW9uKGNvbHVtbiwgcm93KVxuICAgIGlmIChsb2NhdGlvbi5pc1NoaXApIHtcbiAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdoaXQnKVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnbWlzcycpXG4gICAgfVxuXG59XG5cbmNvbnN0IGhhbmRsZUF0dGFjayA9IChjb2x1bW4sIHJvdywgZW5lbXlCb2FyZCwgcGxheWVyKSA9PlxuICAgIHBsYXllci5hdHRhY2soY29sdW1uLCByb3csIGVuZW15Qm9hcmQpXG5cbmNvbnN0IGF0dGFja0VuZW15Q2VsbCA9IGFzeW5jIChjb2x1bW4sIHJvdywgZW5lbXlCb2FyZCwgcGxheWVyQm9hcmQsIHBsYXllciwgZW5lbXkpID0+IHtcblxuXG4gICAgaGFuZGxlQXR0YWNrKGNvbHVtbiwgcm93LCBlbmVteUJvYXJkLCBwbGF5ZXIpXG4gICAgcmVuZGVyQXR0YWNrcygnZW5lbXknLCBjb2x1bW4sIHJvdywgZW5lbXlCb2FyZClcbiAgICBhd2FpdCBkZWxheSg3MDApXG4gICAgcmV0dXJuIGVuZW15Qm9hcmQuY2hlY2tJZkFsbFNoaXBzSGF2ZVN1bmsoKSA/IGNoZWNrSWZHYW1lT3ZlcihwbGF5ZXJCb2FyZCwgZW5lbXlCb2FyZCkgOiBhaVBsYXkoZmFsc2UsIHBsYXllciwgZW5lbXksIHVuZGVmaW5lZCwgcGxheWVyQm9hcmQsIGVuZW15Qm9hcmQpXG59XG5cbmNvbnN0IGlzU3BhY2VBcm91bmRIaXQgPSAoY29sdW1uLCByb3csIHBsYXllckJvYXJkKSA9PiB7XG5cbiAgICBjb25zdCBuZXh0Q29sdW1uID0gcGxheWVyQm9hcmQuZ2V0TG9jYXRpb24oY29sdW1uICsgMSwgcm93KVxuICAgIGNvbnN0IHByZXZpb3VzQ29sdW1uID0gcGxheWVyQm9hcmQuZ2V0TG9jYXRpb24oY29sdW1uIC0gMSwgcm93KVxuICAgIGNvbnN0IG5leHRSb3cgPSBwbGF5ZXJCb2FyZC5nZXRMb2NhdGlvbihjb2x1bW4sIHJvdyArIDEpXG4gICAgY29uc3QgcHJldmlvdXNSb3cgPSBwbGF5ZXJCb2FyZC5nZXRMb2NhdGlvbihjb2x1bW4sIHJvdyAtIDEpXG5cbiAgICBjb25zdCBzcGFjZXNIaXQgPSBbXVxuXG4gICAgaWYobmV4dENvbHVtbiAmJiAhbmV4dENvbHVtbi5oYXNCZWVuSGl0KXtcbiAgICAgICAgc3BhY2VzSGl0LnB1c2gobmV4dENvbHVtbilcbiAgICB9XG4gICAgaWYocHJldmlvdXNDb2x1bW4gJiYgIXByZXZpb3VzQ29sdW1uLmhhc0JlZW5IaXQpe1xuICAgICAgICBzcGFjZXNIaXQucHVzaChwcmV2aW91c0NvbHVtbilcbiAgICB9XG4gICAgaWYobmV4dFJvdyAmJiAhbmV4dFJvdy5oYXNCZWVuSGl0KXtcbiAgICAgICAgc3BhY2VzSGl0LnB1c2gobmV4dFJvdylcbiAgICB9XG4gICAgaWYocHJldmlvdXNSb3cgJiYgIXByZXZpb3VzUm93Lmhhc0JlZW5IaXQpe1xuICAgICAgICBzcGFjZXNIaXQucHVzaChwcmV2aW91c1JvdylcbiAgICB9XG5cbiAgICByZXR1cm4gc3BhY2VzSGl0XG5cbn1cblxuY29uc3QgcmFuZG9tRGlyZWN0aW9uQXR0YWNrID0gKGNvbHVtbiwgcm93LCBwbGF5ZXJCb2FyZCkgPT4ge1xuXG4gICAgY29uc3Qgc3BhY2VzSGl0ID0gaXNTcGFjZUFyb3VuZEhpdChjb2x1bW4sIHJvdywgcGxheWVyQm9hcmQpXG5cbiAgICBjb25zdCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHNwYWNlc0hpdC5sZW5ndGgpXG5cbiAgICBpZighc3BhY2VzSGl0W3JhbmRvbUluZGV4XSkgcmV0dXJuIHJhbmRvbURpcmVjdGlvbkF0dGFjayhjb2x1bW4sIHJvdyAsIHBsYXllckJvYXJkKVxuXG4gICAgcmV0dXJuIHNwYWNlc0hpdFtyYW5kb21JbmRleF1cbn1cblxuY29uc3QgaXNSYW5kb21Db2x1bW5HcmVhdGVyVGhhbkN1cnJlbnRDb2x1bW4gPSAoY29sdW1uLCByYW5kb21Db2x1bW4pID0+IFxuICAgIHJhbmRvbUNvbHVtbiA+IGNvbHVtblxuXG5jb25zdCBpc1JhbmRvbVJvd0dyZWF0ZXJUaGFuQ3VycmVudENvbHVtbiA9IChyb3csIHJhbmRvbVJvdykgPT4gXG4gICAgcmFuZG9tUm93ID4gcm93XG5cbmNvbnN0IGxpc3RPZlJhbmRvbUNvb3JkaW5hdGVzID0gKGNvbHVtbiwgcm93LCBwbGF5ZXJCb2FyZCkgPT4ge1xuXG4gICAgICAgIGNvbnN0IGxvY2F0aW9uUHJvdG90eXBlID0ge1xuICAgICAgICAgICAgbG9jYXRpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBsYXllckJvYXJkLmdldExvY2F0aW9uKHRoaXMuY29sdW1uLCB0aGlzLnJvdylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRvcCA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShsb2NhdGlvblByb3RvdHlwZSksIHtcbiAgICAgICAgICAgIGNvbHVtbixcbiAgICAgICAgICAgIHJvdzogcm93IC0gMSxcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgYm90dG9tID0gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKGxvY2F0aW9uUHJvdG90eXBlKSwge1xuICAgICAgICAgICAgY29sdW1uLFxuICAgICAgICAgICAgcm93OiByb3cgKyAxLFxuICAgICAgICB9KVxuICAgICAgICBjb25zdCByaWdodCA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShsb2NhdGlvblByb3RvdHlwZSksIHtcbiAgICAgICAgICAgIGNvbHVtbjogY29sdW1uICsgMSxcbiAgICAgICAgICAgIHJvdyxcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgbGVmdCA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShsb2NhdGlvblByb3RvdHlwZSksIHtcbiAgICAgICAgICAgIGNvbHVtbjogY29sdW1uIC0gMSxcbiAgICAgICAgICAgIHJvdyxcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgZGlyZWN0aW9ucyA9IFtdXG5cbiAgICAgICAgZGlyZWN0aW9ucy5wdXNoKHRvcClcbiAgICAgICAgZGlyZWN0aW9ucy5wdXNoKGJvdHRvbSlcbiAgICAgICAgZGlyZWN0aW9ucy5wdXNoKHJpZ2h0KVxuICAgICAgICBkaXJlY3Rpb25zLnB1c2gobGVmdClcblxuICAgICAgICByZXR1cm4gZGlyZWN0aW9uc1xufVxuXG4vLyByZW5kZXJzIGF0dGFjayBmb3IgcDIgKEFJKVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbmRlckF0dGFja1AyKHAxLCBwMiwgcG9zMSwgcG9zMiwgcGxheWVyQm9hcmQsIGVuZW15Qm9hcmQpIHtcbiAgbGV0IGlzU3VuayA9IGZhbHNlO1xuICBjb25zdCBlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgYC5wbGF5ZXItYm9hcmQgPiAuY2VsbFtjb2x1bW49JyR7cG9zMX0nXVtyb3c9JyR7cG9zMn0nXWBcbiAgICApXG5cbiAgY29uc3QgYXR0YWNrID0gcDIuYXR0YWNrKHBvczEsIHBvczIsIHBsYXllckJvYXJkKTtcblxuICAgIGNvbnNvbGUubG9nKHBsYXllckJvYXJkLmdldExvY2F0aW9uKHBvczEsIHBvczIpKVxuICBpZiAoYXR0YWNrID09PSBcIllvdSBoYXZlIGFscmVhZHkgaGl0IHRoaXMgc3BvdCFcIikge1xuICAgIGNvbnN0IHJlcGVhdCA9IHRydWU7XG4gICAgYWlQbGF5KHJlcGVhdCwgcDEsIHAyLCB1bmRlZmluZWQsIHBsYXllckJvYXJkLCBlbmVteUJvYXJkKTtcbiAgfVxuICBpZiAoYXR0YWNrID09PSBcIkl0J3MgYSBoaXQhXCIpIHtcbiAgICBzZXRXYXNIaXQoZmFsc2UpO1xuICAgIGUuY2xhc3NMaXN0LmFkZChcIm1pc3NcIik7XG4gIH1cbiAgaWYgKGF0dGFjayA9PT0gXCJZb3UgaGl0IGEgc2hpcCFcIikge1xuICAgIHNldFdhc0hpdCh0cnVlLCB0cnVlLCBwb3MxLCBwb3MyKTtcbiAgICBlLmNsYXNzTGlzdC5hZGQoXCJoaXRcIik7XG4gICAgcGxheWVyQm9hcmQuZ2V0TG9jYXRpb24ocG9zMSwgcG9zMikuZG9tVGFyZ2V0cy5wdXNoKGUpXG4gICAgLy8gaWYgc2hpcCBpcyBzdW5rLCBhZGQgXCJzdW5rXCIgY2xhc3NcbiAgICBpZiAocGxheWVyQm9hcmQuZ2V0TG9jYXRpb24ocG9zMSwgcG9zMikuaXNTdW5rKCkpIHtcbiAgICAgIHBsYXllckJvYXJkLmdldExvY2F0aW9uKHBvczEsIHBvczIpLmRvbVRhcmdldHMuZm9yRWFjaCgoZSkgPT5cbiAgICAgICAgZS5jbGFzc0xpc3QuYWRkKFwic3Vua1wiKVxuICAgICAgKTtcbiAgICAgIGlzU3VuayA9IHRydWU7XG4gICAgICBpZiAocGxheWVyQm9hcmQuY2hlY2tJZkFsbFNoaXBzSGF2ZVN1bmsoKSA9PT0gdHJ1ZSkgcmV0dXJuIGNoZWNrSWZHYW1lT3ZlcihwbGF5ZXJCb2FyZCwgZW5lbXlCb2FyZCk7XG4gICAgfVxuICAgIGF3YWl0IGRlbGF5KDEwMDApXG4gICAgcmV0dXJuIGFpUGxheShmYWxzZSwgcDEsIHAyLCBpc1N1bmssIHBsYXllckJvYXJkLCBlbmVteUJvYXJkKTtcbiAgfVxuXG4gIC8vIHAxLmlzVHVybihwMik7IC8vIGdpdmVzIHR1cm4gdG8gUDFcbn1cbi8vIGh0dHBzOi8vanNtYW5pZmVzdC5jb20vdGhlLXB1Ymxpc2gtc3Vic2NyaWJlLXBhdHRlcm4taW4tamF2YXNjcmlwdC9cblxuZXhwb3J0IGNvbnN0IHB1YlN1YiA9ICgpID0+IHtcbiAgICBjb25zdCBzdWJzY3JpYmVycyA9IHt9XG5cbiAgICBmdW5jdGlvbiBwdWJsaXNoKGV2ZW50TmFtZSwgZGF0YSkge1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoc3Vic2NyaWJlcnNbZXZlbnROYW1lXSkpIHtcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIHN1YnNjcmliZXJzW2V2ZW50TmFtZV0uZm9yRWFjaCgoY2FsbGJhY2spID0+IHtcbiAgICAgICAgICAgIGNhbGxiYWNrKGRhdGEpXG4gICAgICAgIH0pXG4gICAgfVxuICAgIGZ1bmN0aW9uIHN1YnNjcmliZShldmVudE5hbWUsIGNhbGxiYWNrKSB7XG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShzdWJzY3JpYmVbZXZlbnROYW1lXSkpIHtcbiAgICAgICAgICAgIHN1YnNjcmliZXJzW2V2ZW50TmFtZV0gPSBbXVxuICAgICAgICB9XG4gICAgICAgIHN1YnNjcmliZXJzW2V2ZW50TmFtZV0ucHVzaChjYWxsYmFjaylcbiAgICAgICAgY29uc3QgaW5kZXggPSBzdWJzY3JpYmVyc1tldmVudE5hbWVdLmxlbmd0aCAtIDFcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdW5zdWJzY3JpYmUoKSB7XG4gICAgICAgICAgICAgICAgc3Vic2NyaWJlcnNbZXZlbnROYW1lXS5zcGxpY2UoaW5kZXgsIDEpXG4gICAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHVibGlzaCxcbiAgICAgICAgc3Vic2NyaWJlLFxuICAgIH1cbn1cblxuLy8gY3JlYXRlcyBhIGRlbGF5IHRvIGJlIHVzZWQgaW4gYW4gYXN5bmMgZnVuY3Rpb25cbmZ1bmN0aW9uIGRlbGF5KGRlbGF5SW5Ncykge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHJlc29sdmUoMik7XG4gICAgfSwgZGVsYXlJbk1zKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBjb25zdCByZW5kZXJQbGF5ZXJTaGlwcyA9ICh7IGdldExvY2F0aW9uIH0pID0+IHtcbiAgICBjb25zdCBwbGF5ZXJCb2FyZEFyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXYucGxheWVyLWJvYXJkJylcblxuICAgIGZvciAobGV0IGNvbHVtbiA9IDA7IGNvbHVtbiA8IDEwOyBjb2x1bW4gKz0gMSkge1xuICAgICAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCAxMDsgcm93ICs9IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBwbGF5ZXJCb2FyZEFyZWEucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICAgICBgLmNlbGw6bnRoLWNoaWxkKCR7cm93ICogMTAgKyBjb2x1bW4gKyAxfSlgXG4gICAgICAgICAgICApXG4gICAgICAgICAgICBjZWxsLnNldEF0dHJpYnV0ZSgnY29sdW1uJywgY29sdW1uKVxuICAgICAgICAgICAgY2VsbC5zZXRBdHRyaWJ1dGUoJ3JvdycsIHJvdylcbiAgICAgICAgICAgIGNvbnN0IGxvY2F0aW9uID0gZ2V0TG9jYXRpb24oY29sdW1uLCByb3cpXG4gICAgICAgICAgICBpZiAobG9jYXRpb24uaXNTaGlwKSB7XG4gICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdzaGlwJylcbiAgICAgICAgICAgICAgICBjZWxsLnNldEF0dHJpYnV0ZSgnc2hpcC1uYW1lJywgbG9jYXRpb24uZ2V0TmFtZSgpKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5jb25zdCBjaGVja0lmR2FtZU92ZXIgPSAocGxheWVyQm9hcmQsIGVuZW15Qm9hcmQpID0+IHtcbiAgICBpZiAocGxheWVyQm9hcmQuY2hlY2tJZkFsbFNoaXBzSGF2ZVN1bmsoKSkge1xuICAgICAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbCcpXG4gICAgICAgIGNvbnN0IG1vZGFsV2lubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWNvbnRlbnQgPiBwJylcbiAgICAgICAgY29uc3QgcGxheUFnYWluQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICcubW9kYWwtY29udGVudCA+IGJ1dHRvbidcbiAgICAgICAgKVxuXG4gICAgICAgIG1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snXG4gICAgICAgIHBsYXlBZ2FpbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpXG4gICAgICAgIH0pXG5cbiAgICAgICAgbW9kYWxXaW5uZXIudGV4dENvbnRlbnQgPSAnWW91IGxvc2UhJ1xuICAgIH1cbiAgICBpZiAoZW5lbXlCb2FyZC5jaGVja0lmQWxsU2hpcHNIYXZlU3VuaygpKSB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsJylcbiAgICAgICAgY29uc3QgbW9kYWxXaW5uZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtY29udGVudCA+IHAnKVxuICAgICAgICBjb25zdCBwbGF5QWdhaW5CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgJy5tb2RhbC1jb250ZW50ID4gYnV0dG9uJ1xuICAgICAgICApXG5cbiAgICAgICAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdibG9jaydcbiAgICAgICAgbW9kYWxXaW5uZXIudGV4dENvbnRlbnQgPSAnWW91IHdpbiEnXG4gICAgICAgIHBsYXlBZ2FpbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpXG4gICAgICAgIH0pXG4gICAgfVxufVxuXG5leHBvcnQgY29uc3QgYWRkTGlzdGVuZXJzVG9FbmVteUJvYXJkID0gKFxuICAgIHBsYXllckJvYXJkLFxuICAgIGVuZW15Qm9hcmQsXG4gICAgcGxheWVyLFxuICAgIGVuZW15LFxuICAgIHBzXG4pID0+IHtcbiAgICBjb25zdCBlbmVteUJvYXJkQXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Rpdi5lbmVteS1ib2FyZCcpXG5cbiAgICBmb3IgKGxldCBjb2x1bW4gPSAwOyBjb2x1bW4gPCAxMDsgY29sdW1uICs9IDEpIHtcbiAgICAgICAgZm9yIChsZXQgcm93ID0gMDsgcm93IDwgMTA7IHJvdyArPSAxKSB7XG4gICAgICAgICAgICAvLyBDcmVkaXRpbmcgZm9ybXVsYSB0byBjYWxjdWxhdGUgbnRoLWNoaWxkIHVzaW5nIG5lc3RlZCBsb29wOiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy84ODcyNjYyL21hdGgtdG8tZGV0ZXJtaW5lLWl0ZW0taW5kZXgtYmFzZWQtb24tY29sLXJvdy1zZWxlY3Rpb24taW4tZ3JpZFxuICAgICAgICAgICAgY29uc3QgY2VsbCA9IGVuZW15Qm9hcmRBcmVhLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICAgICAgYC5jZWxsOm50aC1jaGlsZCgke3JvdyAqIDEwICsgY29sdW1uICsgMX0pYFxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgY2VsbC5zZXRBdHRyaWJ1dGUoJ2NvbHVtbicsIGNvbHVtbilcbiAgICAgICAgICAgIGNlbGwuc2V0QXR0cmlidXRlKCdyb3cnLCByb3cpXG5cbiAgICAgICAgICAgIGNlbGwuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgICAgICAgICAnY2xpY2snLFxuICAgICAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcHMucHVibGlzaCgnY2xpY2snLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjZWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uLFxuICAgICAgICAgICAgICAgICAgICAgICAgcm93LFxuICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyQm9hcmQsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmVteUJvYXJkLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgZW5lbXksXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7IG9uY2U6IHRydWUgfVxuICAgICAgICAgICAgKVxuICAgICAgICB9XG4gICAgfVxufVxuXG5jb25zdCBjbGVhckJvYXJkRE9NID0gKCkgPT4ge1xuICAgIGNvbnN0IGNlbGxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBsYXllci1ib2FyZCA+IC5jZWxsJylcblxuICAgIGNlbGxzLmZvckVhY2goY2VsbCA9PiB7XG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LnJlbW92ZSgnc2hpcCcpXG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LnJlbW92ZSgnaGl0JylcbiAgICAgICAgY2VsbC5jbGFzc0xpc3QucmVtb3ZlKCdtaXNzJylcbiAgICB9KVxuXG5cblxufVxuXG5leHBvcnQgY29uc3QgcmFuZG9taXplTGlzdGVuZXIgPSAoZ2FtZUJvYXJkKSA9PiB7XG5cbiAgICBnYW1lQm9hcmQuY2xlYXJCb2FyZCgpXG4gICAgY2xlYXJCb2FyZERPTSgpXG5cbiAgICBjb25zdCByYW5kb21Qb3NzaWJpbGl0eSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpXG4gICAgc3dpdGNoKHJhbmRvbVBvc3NpYmlsaXR5KXtcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDksIDEsICd2ZXJ0aWNhbCcsIGNyZWF0ZVNoaXAoNSkpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoMCwgMywgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDMpKVxuICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDMsIDYsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgyKSlcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCg2LCA1LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMykpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoMywgOSwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDQpKVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCgwLCAyLCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoNSkpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoNCwgNSwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDMpKVxuICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDgsIDcsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgyKSlcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCg1LCA5LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMykpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoNiwgMywgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDQpKVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCg1LCAxLCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoNSkpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoMywgMywgJ3ZlcnRpY2FsJywgY3JlYXRlU2hpcCgzKSlcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCgwLCAwLCAndmVydGljYWwnLCBjcmVhdGVTaGlwKDIpKVxuICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDYsIDUsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgzKSlcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCg1LCA5LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoNCkpXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoMCwgMCwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDUpKVxuICAgICAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCgzLCA0LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMykpXG4gICAgICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDYsIDcsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgyKSlcbiAgICAgICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoOSwgMSwgJ3ZlcnRpY2FsJywgY3JlYXRlU2hpcCgzKSlcbiAgICAgICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoNSwgOSwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDQpKVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgcmVuZGVyUGxheWVyU2hpcHMoZ2FtZUJvYXJkKVxuXG59XG5cbmV4cG9ydCBjb25zdCBhdHRhY2sgPSAoe1xuICAgIGNlbGwsXG4gICAgY29sdW1uLFxuICAgIHJvdyxcbiAgICBwbGF5ZXJCb2FyZCxcbiAgICBlbmVteUJvYXJkLFxuICAgIHBsYXllcixcbiAgICBlbmVteSxcbn0pID0+IHtcbiAgICAvLyBodW1hbiBwbGF5ZXIgYXR0YWNraW5nIGNvbXB1dGVyXG4gICAgYXR0YWNrRW5lbXlDZWxsKGNvbHVtbiwgcm93LCBlbmVteUJvYXJkLCBwbGF5ZXJCb2FyZCwgcGxheWVyLCBlbmVteSlcbiAgICAvLyBjb21wdXRlciBhdHRhY2tpbmcgaHVtYW5cbiAgICAvLyBjb25zdCB7IGVsZW1lbnRDb2x1bW4sIGVsZW1lbnRSb3cgfSA9IHBsYXllckJvYXJkLm1ha2VSYW5kb21Db29yZGluYXRlcygpXG4gICAgLy8gcmVuZGVyQXR0YWNrUDIocGxheWVyLCBlbmVteSwgZWxlbWVudENvbHVtbiwgZWxlbWVudFJvdywgcGxheWVyQm9hcmQsIGVuZW15Qm9hcmQpXG4gICAgLy8gYWlQbGF5KGZhbHNlLCBwbGF5ZXIsIGVuZW15LCB1bmRlZmluZWQsIHBsYXllckJvYXJkLCBlbmVteUJvYXJkKVxufVxuIiwiaW1wb3J0IHsgYWRkTGlzdGVuZXJzVG9FbmVteUJvYXJkLCByZW5kZXJQbGF5ZXJTaGlwcyxwdWJTdWIsIHJhbmRvbWl6ZUxpc3RlbmVyLCBhdHRhY2t9IGZyb20gJy4vZG9tJ1xuXG5pbXBvcnQgY3JlYXRlR2FtZUJvYXJkIGZyb20gJy4vZ2FtZWJvYXJkL2dhbWVib2FyZCdcbmltcG9ydCBjcmVhdGVTaGlwIGZyb20gJy4vc2hpcC9zaGlwJ1xuaW1wb3J0IGNyZWF0ZVBsYXllciBmcm9tICcuL3BsYXllci9wbGF5ZXInXG5cbmNvbnN0IHBsYXllckJvYXJkID0gY3JlYXRlR2FtZUJvYXJkKClcbmNvbnN0IGVuZW15Qm9hcmQgPSBjcmVhdGVHYW1lQm9hcmQoKVxuY29uc3QgcGxheWVyID0gY3JlYXRlUGxheWVyKClcbmNvbnN0IGNvbXB1dGVyID0gY3JlYXRlUGxheWVyKClcblxuY29uc3QgcmFuZG9taXplQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYnV0dG9uLnJhbmRvbWl6ZScpXG5cbnJhbmRvbWl6ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblxuICAgIHBsYXllckJvYXJkLnJhbmRvbUZsZWV0KClcbn0pXG4gICAgcGxheWVyQm9hcmQucmFuZG9tRmxlZXQoKVxuXG5lbmVteUJvYXJkLnBsYWNlU2hpcCgwLCAwLCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoNSkpXG5lbmVteUJvYXJkLnBsYWNlU2hpcCgzLCA0LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMykpXG5lbmVteUJvYXJkLnBsYWNlU2hpcCg2LCA3LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMikpXG5lbmVteUJvYXJkLnBsYWNlU2hpcCg5LCAxLCAndmVydGljYWwnLCBjcmVhdGVTaGlwKDMpKVxuZW5lbXlCb2FyZC5wbGFjZVNoaXAoNSwgOSwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDQpKVxuXG5jb25zdCBwcyA9IHB1YlN1YigpXG5cbmFkZExpc3RlbmVyc1RvRW5lbXlCb2FyZChwbGF5ZXJCb2FyZCwgZW5lbXlCb2FyZCwgcGxheWVyLCBjb21wdXRlciwgcHMpXG5cbnBzLnN1YnNjcmliZSgnY2xpY2snLCBhdHRhY2spXG5cbnJlbmRlclBsYXllclNoaXBzKHBsYXllckJvYXJkKSJdLCJuYW1lcyI6WyJjcmVhdGVTaGlwIiwibW9kdWxlIiwiZXhwb3J0cyIsImVtcHR5Q2VsbCIsImhhc0JlZW5IaXQiLCJpc1NoaXAiLCJvZmZMaW1pdHMiLCJpbml0aWFsaXplQm9hcmQiLCJnYW1lQm9hcmQiLCJBcnJheSIsImZpbGwiLCJtYXAiLCJjb2x1bW4iLCJyb3ciLCJzaGlwcyIsImdldExvY2F0aW9uIiwic2V0TG9jYXRpb24iLCJzaGlwIiwiT2JqZWN0IiwiYXNzaWduIiwiY3JlYXRlT2ZmTGltaXRMb2NhdGlvbiIsInVuZGVmaW5lZCIsImxvY2F0aW9uIiwiYWRkT2ZmTGltaXRBcmVhRm9yU2hpcHMiLCJjaGVja0lmTG9jYXRpb25Jc0FTaGlwT3JPZmZMaW1pdHMiLCJkaXJlY3Rpb24iLCJzaGlwTGVuZ3RoIiwiaSIsInBsYWNlU2hpcCIsImdldExlbmd0aCIsImxlbmd0aCIsImNoZWNrSWZSb3dDb29yZGluYXRlSXNWYWxpZCIsInBvc2l0aW9uIiwiYWRkT2ZmTGltaXRBcmVhRm9yVmVydGljYWxseVBvc2l0aW9uZWRTaGlwIiwiY2hlY2tJZkNvbHVtbkNvb3JkaW5hdGVJc1ZhbGlkIiwiYWRkT2ZmTGltaXRBcmVhRm9ySG9yaXpvbnRhbGx5UG9zaXRpb25lZFNoaXAiLCJtYWtlUmFuZG9tQ29vcmRpbmF0ZXMiLCJyYW5kb21EaXJlY3Rpb24iLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJyYW5kb21Mb2NhdGlvbiIsImZsYXR0ZW5lZEdhbWVCb2FyZCIsImZsYXQiLCJmb3JFYWNoIiwiZWxlbWVudCIsImF2YWlsYWJpbGl0eSIsImF2YWlsYWJsZVNwYWNlcyIsImVsZW1lbnRDb2x1bW4iLCJlbGVtZW50Um93IiwicmFuZG9tU2hpcCIsInBvczEiLCJwb3MyIiwiZGlyIiwicm91bmQiLCJjbGVhckJvYXJkIiwiY2hlY2tJZk9mZkxpbWl0Wm9uZVdhc0NvcnJlY3RseUltcGxlbWVudGVkIiwiZmlsdGVyIiwicmVjZWl2ZUF0dGFjayIsImNoZWNrSWZBbGxTaGlwc0hhdmVTdW5rIiwiaGF2ZUFsbFNoaXBzU3VuayIsImoiLCJpc1N1bmsiLCJyYW5kb21seVBsYWNlU2hpcHMiLCJzaGlwRGV0YWlscyIsInJhbmRvbUNvbHVtbiIsInJhbmRvbVJvdyIsInB1c2giLCJyYW5kb21GbGVldCIsIm5hbWUiLCJnZXROYW1lIiwiYXR0YWNrIiwiZ2V0U3RhdHVzIiwiaW5jbHVkZXMiLCJoaXQiLCJyYW5kb21Qb3MiLCJzdGF0dXMiLCJldmVyeSIsImRvbVRhcmdldHMiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwibiIsImdldHRlciIsIl9fZXNNb2R1bGUiLCJkIiwiYSIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImF0dGFja0RpcmVjdGlvbiIsIndhc0hpdCIsImxhc3RIaXRQb3MiLCJmaXJzdEhpdFBvcyIsInNlY29uZEhpdFBvcyIsInN1cnJvdW5kaW5nUG9zIiwic2V0V2FzSGl0IiwidmFsdWUiLCJzdGF0IiwicmVnaXN0ZXJTdXJyb3VuZGluZ1BvcyIsImFpUGxheSIsInJlcGVhdCIsInAxIiwicDIiLCJwbGF5ZXJCb2FyZCIsImVuZW15Qm9hcmQiLCJwb3MiLCJyZW5kZXJBdHRhY2tQMiIsIm5ld1BvcyIsImF0dGFja1Rvd2FyZHMiLCJwb3AiLCJhc3luYyIsImUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb25zb2xlIiwibG9nIiwiY2xhc3NMaXN0IiwiYWRkIiwiY2hlY2tJZkdhbWVPdmVyIiwiZGVsYXkiLCJkZWxheUluTXMiLCJQcm9taXNlIiwicmVzb2x2ZSIsInNldFRpbWVvdXQiLCJtb2RhbCIsIm1vZGFsV2lubmVyIiwicGxheUFnYWluQnV0dG9uIiwic3R5bGUiLCJkaXNwbGF5IiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbG9hZCIsInRleHRDb250ZW50IiwiY29tcHV0ZXIiLCJwcyIsInN1YnNjcmliZXJzIiwicHVibGlzaCIsImV2ZW50TmFtZSIsImRhdGEiLCJpc0FycmF5IiwiY2FsbGJhY2siLCJzdWJzY3JpYmUiLCJpbmRleCIsInVuc3Vic2NyaWJlIiwic3BsaWNlIiwicHViU3ViIiwicGxheWVyIiwiZW5lbXkiLCJlbmVteUJvYXJkQXJlYSIsImNlbGwiLCJzZXRBdHRyaWJ1dGUiLCJvbmNlIiwiYWRkTGlzdGVuZXJzVG9FbmVteUJvYXJkIiwiaGFuZGxlQXR0YWNrIiwicmVuZGVyQXR0YWNrcyIsImF0dGFja0VuZW15Q2VsbCIsInBsYXllckJvYXJkQXJlYSIsInJlbmRlclBsYXllclNoaXBzIl0sInNvdXJjZVJvb3QiOiIifQ==