(()=>{var e={653:(e,t,o)=>{const r=o(585);e.exports=()=>{const e={hasBeenHit:!1,isShip:!1,offLimits:!1};let t=!1;const o=()=>{const t=Array(10).fill().map((()=>Array(10).fill()));for(let o=0;o<10;o++)for(let r=0;r<10;r++)t[o][r]={...e,column:o,row:r};return t};let i=o();r(5,"Carrier"),r(4,"Battleship"),r(3,"Destroyer"),r(3,"Submarine"),r(2,"Patrol Boat");const a=(e,t)=>i?.[e]?.[t],n=(t,o,r=(()=>Object.assign(e,{offLimits:!0}))())=>{if(void 0===i?.[t]?.[o])return!0;const a=i[t][o];return i[t][o]={...a,...r},!0},l=(e,t)=>{n(e-1,t-1),n(e,t-1)},c=(e,t,o,r)=>{if("vertical"===o)for(let o=0;o<r;o++){const r=a(e,t+o);if(r&&!0===r.isShip&&!0===r.offLimits)return!0}if("horizontal"===o)for(let o=0;o<r;o++){const r=a(e+o,t);if(r&&!0===r.isShip&&!0===r.offLimits)return!0}return!1},s=(e,t,o,r)=>{if(i[e][t].isShip||i[e][t].offLimits)return!1;const s=r.getLength();if(c(a(e,t)))return!1;if("vertical"===o){if(((e,t)=>e>=0&&e+t-1<i.length)(t,s)){for(let o=0;o<s;o+=1)n(e,t+o,{...r,position:o}),n(e+1,t+o),n(e-1,t+o);return((e,t,o)=>{l(e,t),n(e,t+o),n(e+1,t+o),n(e-1,t+o),console.log(e-1,t+o),n(e+1,t-1)})(e,t,s),!0}}else if("horizontal"===o&&((e,t)=>e>=0&&e+t-1<i.length)(e,s)){for(let o=0;o<s;o+=1)n(e+o,t,{...r,position:o}),n(e+o,t+1),n(e+o,t-1);return((e,t,o)=>{l(e,t),n(e+o,t),n(e-1,t+1),n(e+o,t+1),n(e+o,t-1),n(e-1,t)})(e,t,s),!0}return!1},d=()=>{const e=0===Math.floor(2*Math.random())?"vertical":"horizontal",t=Math.floor(100*Math.random()),o=(()=>{const e=[...i.flat()];return e.forEach((e=>{!0===e.hasBeenHit?e.availability=!1:e.availability=!0})),e})()[t];return!1===o.availability?d():{elementColumn:o.column,elementRow:o.row,randomDirection:e}};let h=e=>{let t=Math.floor(10*Math.random()),o=Math.floor(10*Math.random()),i=Math.round(Math.random());return(0!==i||(i="horizontal",0!=s(t,o,i,r(e))))&&(1!==i||(i="vertical",0!=s(t,o,i,r(e))))&&void 0};return{clearBoard:()=>{i=o()},checkIfLocationIsAShipOrOffLimits:c,checkIfOffLimitZoneWasCorrectlyImplemented:e=>i.flat().filter((e=>!0===e.offLimits)).length===e+2,getLocation:a,receiveAttack:(e,t)=>{i[e][t].hasBeenHit=!0},checkIfAllShipsHaveSunk:()=>{let e=!0;for(let t=0;t<10;t++)for(let o=0;o<10;o++){const r=a(t,o);if(!1!==r.isShip&&r.isShip&&!1===r.isSunk()){e=!1;break}}return e},placeShip:s,randomlyPlaceShips:()=>{switch(i.clearBoard(),clearBoardDOM(),Math.floor(4*Math.random())){case 0:i.placeShip(9,1,"vertical",r(5)),i.placeShip(0,3,"horizontal",r(3)),i.placeShip(3,6,"horizontal",r(2)),i.placeShip(6,5,"horizontal",r(3)),i.placeShip(3,9,"horizontal",r(4));break;case 1:i.placeShip(0,2,"horizontal",r(5)),i.placeShip(4,5,"horizontal",r(3)),i.placeShip(8,7,"horizontal",r(2)),i.placeShip(5,9,"horizontal",r(3)),i.placeShip(6,3,"horizontal",r(4));break;case 2:i.placeShip(5,1,"horizontal",r(5)),i.placeShip(3,3,"vertical",r(3)),i.placeShip(0,0,"vertical",r(2)),i.placeShip(6,5,"horizontal",r(3)),i.placeShip(5,9,"horizontal",r(4));break;default:i.placeShip(0,0,"horizontal",r(5)),i.placeShip(3,4,"horizontal",r(3)),i.placeShip(6,7,"horizontal",r(2)),i.placeShip(9,1,"vertical",r(3)),i.placeShip(5,9,"horizontal",r(4))}},makeRandomCoordinates:d,checkIfBoardHasBeenFullyPopulated:()=>{const e=i.flat();let t=0;return e.forEach((e=>{e.isShip&&t++})),20===t},randomFleet:()=>{for(let e=0;e<2;)0!=h(1)&&e++;for(let e=0;e<2;)0!=h(2)&&e++;for(let e=0;e<2;)0!=h(3)&&e++;for(let e=0;e<2;)0!=h(4)&&e++;t=!0},gameBoard:i,isStartAllowed:{get:function(){return t},set:function(e){t=e}}}}},61:e=>{e.exports=(e="player")=>({getName:()=>e,attack:(e,t,{getLocation:o,receiveAttack:r})=>{const i=o(e,t);return!1===i.hasBeenHit||i.isShip&&!1===i.getStatus().includes("unhit")?(r(e,t),i.hit?(i.hit(i.position),"You hit a ship!"):"It's a hit!"):"You have already hit this spot!"},randomPos:()=>[Math.floor(10*Math.random()),Math.floor(10*Math.random())]})},585:e=>{e.exports=(e,t="ship")=>{const o=Array(e).fill("unhit");return{getName:()=>t,getLength:()=>o.length,isSunk:()=>o.every((e=>"hit"===e)),hit:t=>{t<e&&(o[t]="hit")},getStatus:()=>o,domTargets:[],hasBeenHit:!1,offLimits:!0,isShip:!0}}}},t={};function o(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,o),a.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=o(653),t=o.n(e),r=o(585),i=o.n(r);let a,n=!1,l=!1,c=[],s=[],d=[],h=[];function u(e,t,o,r){n=e,void 0!==t&&(l=t),void 0!==o&&(c=[o,r]),0==s.length&&void 0!==o?s=[o,r]:0!==s.length&&0==d.length&&void 0!==o&&(d=[o,r])}function p(e,t){return h=[],0!==t&&h.push([e,t-1]),9!==t&&h.push([e,t+1]),0!==e&&h.push([e-1,t]),9!==e&&h.push([e+1,t]),h}function f(e,t,o,r,i,u){let f;if(!0===r&&(c=[],s=[],d=[],h=[],n=!1,l=!1,a=""),!l&&!n)return f=t.randomPos(),v(t,o,f[0],f[1],i,u);if(0!==d.length&&n&&!e){let e;if(s[0]==d[0]-1&&(e=m("down")),s[0]==d[0]+1&&(e=m("up")),s[1]==d[1]-1&&(e=m("right")),s[1]==d[1]+1&&(e=m("left")),e[0]>=0&&e[0]<=9&&e[1]>=0&&e[1]<=9)return v(t,o,e[0],e[1],i,u)}else if(0!==d.length&&l&&!n){let e;if(c=s,d=[],"up"===a&&(e=m("down")),"down"===a&&(e=m("up")),"right"===a&&(e=m("left")),"left"===a&&(e=m("right")),e[0]>=0&&e[0]<=9&&e[1]>=0&&e[1]<=9)return v(t,o,e[0],e[1],i,u)}else if(l){0==h.length&&p(c[0],c[1]),0==h.length&&1==l&&p(s[0],s[1]);const e=h.pop();return v(t,o,e[0],e[1],i,u)}}function m(e){return"left"===e?(a="left",[c[0],c[1]-1]):"right"===e?(a="right",[c[0],c[1]+1]):"down"===e?(a="down",[c[0]+1,c[1]]):"up"===e?(a="up",[c[0]-1,c[1]]):void 0}let S=0;function y(e,t){let o=2;const r=document.querySelector(e),a=document.querySelector("body"),n=document.querySelectorAll(".player-board > .cell"),l=r.childNodes;let c,s,d="horizontal";l[0]&&l[0].addEventListener("mouseenter",(()=>s=0)),l[1]&&l[1].addEventListener("mouseenter",(()=>s=-1)),l[2]&&l[2].addEventListener("mouseenter",(()=>s=-2)),l[3]&&l[3].addEventListener("mouseenter",(()=>s=-3)),r.addEventListener("click",(e=>function(e){"horizontal"===d?(d="vertical",e.target.parentNode.classList.toggle("rotated")):(d="horizontal",e.target.parentNode.classList.toggle("rotated"))}(e))),r.addEventListener("dragstart",(e=>{for(let e=0;e<10;e++)t.gameBoard[e].forEach(((e,t)=>{(e.offLimits||e.isShip)&&document.querySelector(`.player-board > .cell[column='${e.column}'][row='${e.row}']`).classList.toggle("not-available")}))})),r.addEventListener("dragend",((a,n)=>{if(document.querySelectorAll(".not-available").forEach((e=>e.classList.remove("not-available"))),-1===c)return;let l,h,u=`${c}`;c<10?(l=0,h=c):(u=u.split(""),l=1*u[0],h=1*u[1]),"horizontal"===d&&(h+=s),"vertical"===d&&(l+=s),h<0||".ship-1"===e&&!1===t.placeShip(h,l,d,i()(1))||".ship-2"===e&&!1===t.placeShip(h,l,d,i()(2))||".ship-3"===e&&!1===t.placeShip(h,l,d,i()(3))||".ship-4"===e&&!1===t.placeShip(h,l,d,i()(4))||(L(t),o-=1,S++,8===S&&t.isStartAllowed.set(!0),r.parentNode.firstChild.textContent=`${o}x`,0===o&&(r.parentNode.style.display="none"),!t.checkIfBoardHasBeenFullyPopulated())||(document.querySelector("body > main > div.player > div:nth-child(4)").style.display="none",document.querySelector(".randomize").style.display="none",t.isStartAllowed.set(!0))})),n.forEach(((e,t)=>{e.addEventListener("dragover",(e=>{e.preventDefault(),c=t}))})),a.addEventListener("dragenter",(()=>{c=-1}))}async function v(e,t,o,r,i,a){let n=!1;const l=document.querySelector(`.player-board > .cell[column='${o}'][row='${r}']`),c=t.attack(o,r,i);if("You have already hit this spot!"===c&&f(!0,e,t,void 0,i,a),"It's a hit!"===c&&(u(!1),l.classList.add("miss")),"You hit a ship!"===c)return u(!0,!0,o,r),l.classList.add("hit"),i.getLocation(o,r).domTargets.push(l),i.getLocation(o,r).isSunk()&&(i.getLocation(o,r).domTargets.forEach((e=>e.classList.add("sunk"))),n=!0,!0===i.checkIfAllShipsHaveSunk())?b(i,a):(await g(1e3),f(!1,e,t,n,i,a))}function g(e){return new Promise((t=>{setTimeout((()=>{t(2)}),e)}))}const L=({getLocation:e})=>{const t=document.querySelector("div.player-board");for(let o=0;o<10;o+=1)for(let r=0;r<10;r+=1){const i=t.querySelector(`.cell:nth-child(${10*r+o+1})`);i.setAttribute("column",o),i.setAttribute("row",r);const a=e(o,r);a.isShip&&(i.classList.add("ship"),i.setAttribute("ship-name",a.getName()))}},b=(e,t)=>{if(e.checkIfAllShipsHaveSunk()){const e=document.querySelector(".modal"),t=document.querySelector(".modal-content > p"),o=document.querySelector(".modal-content > button");e.style.display="block",o.addEventListener("click",(()=>{location.reload()})),t.textContent="You lose!"}if(t.checkIfAllShipsHaveSunk()){const e=document.querySelector(".modal"),t=document.querySelector(".modal-content > p"),o=document.querySelector(".modal-content > button");e.style.display="block",t.textContent="You win!",o.addEventListener("click",(()=>{location.reload()}))}};var k=o(61),z=o.n(k);const A=t()(),E=t()(),w=z()(),q=z()();document.querySelector("button.randomize").addEventListener("click",(()=>{A.randomlyPlaceShips(),document.querySelectorAll(".player-board > .cell").forEach((e=>{e.classList.remove("ship"),e.classList.remove("hit"),e.classList.remove("miss")}))})),document.querySelector("button.reset").addEventListener("click",(()=>{location.reload()})),function(e){function t(e,t){const o=document.querySelector("body > main > div.player > div:nth-child(4)"),r=document.createElement("div");r.classList.add("ship-container"),o.appendChild(r);const i=document.createElement("span");i.classList.add(`info-${e}`),i.textContent="2x",r.appendChild(i);const a=document.createElement("div");a.classList.add("ship"),a.classList.add(`ship-${e}`),a.setAttribute("draggable","true"),r.appendChild(a);for(let e=0;e<t;e++){const e=document.createElement("div");e.classList.add("cell"),a.appendChild(e)}}t(1,1),t(2,2),t(3,3),t(4,4);for(let t=1;t<5;t++)y(`.ship-${t}`,e)}(A),E.placeShip(0,0,"horizontal",i()(5)),E.placeShip(3,4,"horizontal",i()(3)),E.placeShip(6,7,"horizontal",i()(2)),E.placeShip(9,1,"vertical",i()(3)),E.placeShip(5,9,"horizontal",i()(4));const B=(()=>{const e={};return{publish:function(t,o){Array.isArray(e[t])&&e[t].forEach((e=>{e(o)}))},subscribe:function t(o,r){Array.isArray(t[o])||(e[o]=[]),e[o].push(r);const i=e[o].length-1;return{unsubscribe(){e[o].splice(i,1)}}}}})();((e,t,o,r,i)=>{const a=document.querySelector("div.enemy-board");for(let n=0;n<10;n+=1)for(let l=0;l<10;l+=1){const c=a.querySelector(`.cell:nth-child(${10*l+n+1})`);c.setAttribute("column",n),c.setAttribute("row",l),c.addEventListener("click",(()=>{!1!==e.isStartAllowed.get()&&i.publish("click",{cell:c,column:n,row:l,playerBoard:e,enemyBoard:t,player:o,enemy:r})}),{once:!0})}})(A,E,w,q,B),B.subscribe("click",(({cell:e,column:t,row:o,playerBoard:r,enemyBoard:i,player:a,enemy:n})=>{(async(e,t,o,r,i,a)=>{((e,t,o,r)=>{r.attack(e,t,o)})(e,t,o,i),((e,t,o,r)=>{const i=document.querySelector(`.enemy-board > .cell[column='${t}'][row='${o}']`);r.getLocation(t,o)?.isShip&&(r.getLocation(t,o).domTargets.push(i),r.getLocation(t,o).isSunk()&&r.getLocation(t,o).domTargets.forEach((e=>e.classList.add("sunk")))),r.getLocation(t,o).isShip?i.classList.add("hit"):i.classList.add("miss")})(0,e,t,o),await g(700),o.checkIfAllShipsHaveSunk()?b(r,o):f(!1,i,a,void 0,r,o)})(t,o,i,r,a,n)})),L(A)})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFTQyxjQUNsQixnQ0FBb0NwSCxZQUFpQkMsT0FHdER3RyxFQUFXdkcsWUFBWUYsRUFBUUMsSUFBTVQsU0FFcENpSCxFQUFXdkcsWUFBWUYsRUFBUUMsR0FBS29FLFdBQVc4QixLQUFLaUQsR0FDakQzQyxFQUFXdkcsWUFBWUYsRUFBUUMsR0FBS2tELFVBRW5Dc0QsRUFBV3ZHLFlBQVlGLEVBQVFDLEdBQUtvRSxXQUFXcEMsU0FBUzRGLEdBQU1BLEVBQUVHLFVBQVVZLElBQUksV0FJckVuQyxFQUFXdkcsWUFBWUYsRUFBUUMsR0FDbkNULE9BQ1Q0SixFQUFLcEIsVUFBVVksSUFBSSxPQUVuQlEsRUFBS3BCLFVBQVVZLElBQUksU0FZdkJ3QyxDQUFjLEVBQVNwTCxFQUFRQyxFQUFLd0csU0FDOUJxQyxFQUFNLEtBQ0xyQyxFQUFXekQsMEJBQTRCNkYsRUFBZ0JyQyxFQUFhQyxHQUFjTCxHQUFPLEVBQU8wRSxFQUFRQyxPQUFPdkssRUFBV2dHLEVBQWFDLElBNlM5STRFLENBQWdCckwsRUFBUUMsRUFBS3dHLEVBQVlELEVBQWFzRSxFQUFRQyxNQzFTbEUxQyxFQUFrQjdCLEkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90b3AtYmF0dGxlc2hpcC8uL3NyYy9nYW1lYm9hcmQvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL3RvcC1iYXR0bGVzaGlwLy4vc3JjL3BsYXllci9wbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vdG9wLWJhdHRsZXNoaXAvLi9zcmMvc2hpcC9zaGlwLmpzIiwid2VicGFjazovL3RvcC1iYXR0bGVzaGlwL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3RvcC1iYXR0bGVzaGlwL3dlYnBhY2svcnVudGltZS9jb21wYXQgZ2V0IGRlZmF1bHQgZXhwb3J0Iiwid2VicGFjazovL3RvcC1iYXR0bGVzaGlwL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly90b3AtYmF0dGxlc2hpcC93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3RvcC1iYXR0bGVzaGlwLy4vc3JjL2JvdC5qcyIsIndlYnBhY2s6Ly90b3AtYmF0dGxlc2hpcC8uL3NyYy9kcmFnLWFuZC1kcm9wLmpzIiwid2VicGFjazovL3RvcC1iYXR0bGVzaGlwLy4vc3JjL2RvbS5qcyIsIndlYnBhY2s6Ly90b3AtYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcbi8qIGVzbGludC1kaXNhYmxlIG5vLW11bHRpLWFzc2lnbiAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLWV4cHJlc3Npb25zICovXG5jb25zdCBjcmVhdGVTaGlwID0gcmVxdWlyZSgnLi4vc2hpcC9zaGlwJylcblxuLyogZXNsaW50LWRpc2FibGUgbm8tcGFyYW0tcmVhc3NpZ24gKi9cbmNvbnN0IGNyZWF0ZUdhbWVCb2FyZCA9ICgpID0+IHtcbiAgICBjb25zdCBlbXB0eUNlbGwgPSB7IGhhc0JlZW5IaXQ6IGZhbHNlLCBpc1NoaXA6IGZhbHNlLCBvZmZMaW1pdHM6IGZhbHNlIH1cblxuICAgIGxldCBpc1N0YXJ0QWxsb3dlZCA9IGZhbHNlXG4gICAgXG4gICAgY29uc3QgaW5pdGlhbGl6ZUJvYXJkID0gKCkgPT4ge1xuICAgICAgICBjb25zdCBnYW1lQm9hcmQgPSBBcnJheSgxMCkuZmlsbCgpLm1hcCgoKSA9PiBBcnJheSgxMCkuZmlsbCgpKVxuICAgICAgICBmb3IobGV0IGNvbHVtbj0gMDsgY29sdW1uIDwgMTA7IGNvbHVtbisrKXtcbiAgICAgICAgICAgIGZvcihsZXQgcm93PSAwOyByb3cgPCAxMDsgcm93Kyspe1xuICAgICAgICAgICAgICAgIGdhbWVCb2FyZFtjb2x1bW5dW3Jvd10gPSB7Li4uZW1wdHlDZWxsLCBjb2x1bW4sIHJvd31cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZ2FtZUJvYXJkXG4gICAgXG4gICAgfVxuXG4gICAgbGV0IGdhbWVCb2FyZCA9IGluaXRpYWxpemVCb2FyZCgpXG5cbiAgICBjb25zdCBzaGlwcyA9IFtcbiAgICAgICAgY3JlYXRlU2hpcCg1LCAnQ2FycmllcicpLFxuICAgICAgICBjcmVhdGVTaGlwKDQsICdCYXR0bGVzaGlwJyksXG4gICAgICAgIGNyZWF0ZVNoaXAoMywgJ0Rlc3Ryb3llcicpLFxuICAgICAgICBjcmVhdGVTaGlwKDMsICdTdWJtYXJpbmUnKSxcbiAgICAgICAgY3JlYXRlU2hpcCgyLCAnUGF0cm9sIEJvYXQnKSxcbiAgICBdXG5cblxuICAgIGNvbnN0IGNyZWF0ZU9mZkxpbWl0TG9jYXRpb24gPSAoKSA9PlxuICAgICAgICBPYmplY3QuYXNzaWduKGVtcHR5Q2VsbCwgeyBvZmZMaW1pdHM6IHRydWUgfSlcblxuICAgIGNvbnN0IGdldExvY2F0aW9uID0gKGNvbHVtbiwgcm93KSA9PiBnYW1lQm9hcmQ/Lltjb2x1bW5dPy5bcm93XVxuXG4gICAgY29uc3Qgc2V0TG9jYXRpb24gPSAoY29sdW1uLCByb3csIHNoaXAgPSBjcmVhdGVPZmZMaW1pdExvY2F0aW9uKCkpID0+IHtcbiAgICAgICAgaWYgKGdhbWVCb2FyZD8uW2NvbHVtbl0/Lltyb3ddID09PSB1bmRlZmluZWQpIHJldHVybiB0cnVlXG4gICAgICAgIGNvbnN0IGxvY2F0aW9uID0gZ2FtZUJvYXJkW2NvbHVtbl1bcm93XVxuXG4gICAgICAgIGdhbWVCb2FyZFtjb2x1bW5dW3Jvd10gPSB7Li4ubG9jYXRpb24sIC4uLnNoaXB9XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICAgIGNvbnN0IGNoZWNrSWZBbGxTaGlwc0hhdmVTdW5rID0gKCkgPT4ge1xuXG4gICAgICAgIGxldCBoYXZlQWxsU2hpcHNTdW5rID10cnVlICBcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTA7IGorKykge1xuICAgICAgICBjb25zdCBsb2NhdGlvbiA9IGdldExvY2F0aW9uKGksIGopXG4gICAgICAgIGlmKGxvY2F0aW9uLmlzU2hpcCA9PT0gZmFsc2UpIGNvbnRpbnVlXG4gICAgICAgIGlmKGxvY2F0aW9uLmlzU2hpcCAmJiBsb2NhdGlvbi5pc1N1bmsoKSA9PT0gZmFsc2Upe1xuICAgICAgICAgICBoYXZlQWxsU2hpcHNTdW5rID0gZmFsc2UgXG4gICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBoYXZlQWxsU2hpcHNTdW5rIFxuICAgIH1cblxuICAgIGNvbnN0IGFkZE9mZkxpbWl0QXJlYUZvclNoaXBzID0gKGNvbHVtbiwgcm93KSA9PiB7XG4gICAgICAgIC8vIHRvcC1sZWZ0XG4gICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiAtIDEsIHJvdyAtIDEpXG4gICAgICAgIC8vIHRvcFxuICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4sIHJvdyAtIDEpXG4gICAgfVxuXG4gICAgY29uc3QgYWRkT2ZmTGltaXRBcmVhRm9ySG9yaXpvbnRhbGx5UG9zaXRpb25lZFNoaXAgPSAoXG4gICAgICAgIGNvbHVtbixcbiAgICAgICAgcm93LFxuICAgICAgICBzaGlwTGVuZ3RoXG4gICAgKSA9PiB7XG4gICAgICAgIC8vIHBvc2l0aW9ucyByZWxhdGl2ZSB0byB0aGUgc2hpcCBpdHNlbGYoaWUuIGEgaG9yaXpvbnRhbCBzaGlwJ3MgYm90dG9tIGlzIHRvIHRoZSByaWdodClcblxuICAgICAgICBhZGRPZmZMaW1pdEFyZWFGb3JTaGlwcyhjb2x1bW4sIHJvdylcbiAgICAgICAgLy8gYm90dG9tXG4gICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIHNoaXBMZW5ndGgsIHJvdylcbiAgICAgICAgLy8gYm90dG9tLWxlZnRcbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uIC0gMSwgcm93ICsgMSlcbiAgICAgICAgLy8gYm90dG9tLXJpZ2h0XG4gICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIHNoaXBMZW5ndGgsIHJvdyArIDEpXG4gICAgICAgIC8vIHRvcC1yaWdodFxuICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gKyBzaGlwTGVuZ3RoLCByb3cgLSAxKVxuICAgICAgICAvL2xlZnRcbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uIC0xLCByb3cpXG4gICAgfVxuXG4gICAgY29uc3QgYWRkT2ZmTGltaXRBcmVhRm9yVmVydGljYWxseVBvc2l0aW9uZWRTaGlwID0gKFxuICAgICAgICBjb2x1bW4sXG4gICAgICAgIHJvdyxcbiAgICAgICAgc2hpcExlbmd0aFxuICAgICkgPT4ge1xuICAgICAgICAvLyBwb3NpdGlvbnMgcmVsYXRpdmUgdG8gaG93IHRoZSB1c2VyIHNlZXMgaXQoaWUuIGEgdmVydGljYWwgc2hpcCdzIGJvdHRvbSBpcyB0byB0aGUgYm90dG9tKVxuXG4gICAgICAgIGFkZE9mZkxpbWl0QXJlYUZvclNoaXBzKGNvbHVtbiwgcm93KVxuICAgICAgICAvLyBib3R0b21cbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uLCByb3cgKyBzaGlwTGVuZ3RoKVxuICAgICAgICAvLyBib3R0b20tcmlnaHRcbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uICsgMSwgcm93ICsgc2hpcExlbmd0aClcbiAgICAgICAgLy8gYm90dG9tLWxlZnRcbiAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uIC0gMSwgcm93ICsgc2hpcExlbmd0aClcbiAgICAgICAgY29uc29sZS5sb2coY29sdW1uIC0xLCByb3crc2hpcExlbmd0aClcbiAgICAgICAgLy8gdG9wLXJpZ2h0XG4gICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIDEsIHJvdyAtIDEpXG4gICAgfVxuXG4gICAgY29uc3QgY2hlY2tJZkNvbHVtbkNvb3JkaW5hdGVJc1ZhbGlkID0gKGNvbHVtbiwgc2hpcExlbmd0aCkgPT5cbiAgICAgICAgY29sdW1uID49IDAgJiYgY29sdW1uICsgc2hpcExlbmd0aCAtIDEgPCBnYW1lQm9hcmQubGVuZ3RoXG5cbiAgICBjb25zdCBjaGVja0lmUm93Q29vcmRpbmF0ZUlzVmFsaWQgPSAocm93LCBzaGlwTGVuZ3RoKSA9PlxuICAgICAgICByb3cgPj0gMCAmJiByb3cgKyBzaGlwTGVuZ3RoIC0gMSA8IGdhbWVCb2FyZC5sZW5ndGhcblxuXG4gICAgY29uc3QgY2hlY2tJZkxvY2F0aW9uSXNBU2hpcE9yT2ZmTGltaXRzID0gKFxuICAgICAgICBjb2x1bW4sXG4gICAgICAgIHJvdyxcbiAgICAgICAgZGlyZWN0aW9uLFxuICAgICAgICBzaGlwTGVuZ3RoXG4gICAgKSA9PiB7XG4gICAgICAgIGlmIChkaXJlY3Rpb24gPT09ICd2ZXJ0aWNhbCcpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcExlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbG9jYXRpb24gPSBnZXRMb2NhdGlvbihjb2x1bW4sIHJvdyArIGkpXG4gICAgICAgICAgICAgICAgaWYgKGxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmlzU2hpcCA9PT0gdHJ1ZSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24ub2ZmTGltaXRzID09PSB0cnVlXG4gICAgICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkaXJlY3Rpb24gPT09ICdob3Jpem9udGFsJykge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsb2NhdGlvbiA9IGdldExvY2F0aW9uKGNvbHVtbiArIGksIHJvdylcbiAgICAgICAgICAgICAgICBpZiAobG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uaXNTaGlwID09PSB0cnVlICYmXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5vZmZMaW1pdHMgPT09IHRydWVcbiAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZSBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cblxuICAgICAgLy8gbWFrZXMgdGlsZXMgYXJvdW5kIHNoaXAgXCJyZXNlcnZlZFwiXG4gIGxldCByZXNlcnZlQXJvdW5kID0gKHBvczEsIHBvczIpID0+IHtcbiAgICBmdW5jdGlvbiBjZWxsKG4xLCBuMikge1xuICAgICAgaWYgKHBvczEgKyBuMSA+IDkgfHwgcG9zMSArIG4xIDwgMCkgcmV0dXJuO1xuICAgICAgaWYgKE9iamVjdC5pcyhnYW1lQm9hcmRbcG9zMSArIG4xXVtwb3MyICsgbjJdLCBlbXB0eUNlbGwpKVxuICAgICAgICBnYW1lQm9hcmRbcG9zMSArIG4xXVtwb3MyICsgbjJdLm9mZkxpbWl0cyA9IHRydWU7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHJlc2VydmVDZWxsKHJvdykge1xuICAgICAgY2VsbChyb3csIC0xKTtcbiAgICAgIGNlbGwocm93LCAwKTtcbiAgICAgIGNlbGwocm93LCAxKTtcbiAgICB9XG4gICAgcmVzZXJ2ZUNlbGwoLTEpO1xuICAgIHJlc2VydmVDZWxsKDApO1xuICAgIHJlc2VydmVDZWxsKDEpO1xuICB9O1xuXG5jb25zdCBwbGFjZVNoaXAgPSAoY29sdW1uLCByb3csIGRpcmVjdGlvbiwgc2hpcCkgPT4ge1xuICAgIGlmKGdhbWVCb2FyZFtjb2x1bW5dW3Jvd10uaXNTaGlwIHx8IGdhbWVCb2FyZFtjb2x1bW5dW3Jvd10ub2ZmTGltaXRzKSByZXR1cm4gZmFsc2VcbiAgICAgICAgY29uc3Qgc2hpcExlbmd0aCA9IHNoaXAuZ2V0TGVuZ3RoKClcbiAgICAgICAgaWYgKGNoZWNrSWZMb2NhdGlvbklzQVNoaXBPck9mZkxpbWl0cyhnZXRMb2NhdGlvbihjb2x1bW4sIHJvdywgZGlyZWN0aW9uLCBzaGlwTGVuZ3RoKSkpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gJ3ZlcnRpY2FsJykge1xuICAgICAgICAgICAgaWYgKGNoZWNrSWZSb3dDb29yZGluYXRlSXNWYWxpZChyb3csIHNoaXBMZW5ndGgpKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwTGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0TG9jYXRpb24oY29sdW1uLCByb3cgKyBpLCB7Li4uc2hpcCwgcG9zaXRpb246IGl9KVxuICAgICAgICAgICAgICAgICAgICAvL3Jlc2VydmVBcm91bmQoY29sdW1uLCByb3cgKyBpKVxuICAgICAgICAgICAgICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gKyAxLCByb3cgKyBpKVxuICAgICAgICAgICAgICAgICAgICBzZXRMb2NhdGlvbihjb2x1bW4gLSAxLCByb3cgKyBpKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhZGRPZmZMaW1pdEFyZWFGb3JWZXJ0aWNhbGx5UG9zaXRpb25lZFNoaXAoXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbixcbiAgICAgICAgICAgICAgICAgICAgcm93LFxuICAgICAgICAgICAgICAgICAgICBzaGlwTGVuZ3RoXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAnaG9yaXpvbnRhbCcpIHtcbiAgICAgICAgICAgIGlmIChjaGVja0lmQ29sdW1uQ29vcmRpbmF0ZUlzVmFsaWQoY29sdW1uLCBzaGlwTGVuZ3RoKSkge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2hpcExlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIGkgLCByb3csIHsuLi5zaGlwLCBwb3NpdGlvbjogaX0pXG4gICAgICAgICAgICAgICAgICAgIC8vcmVzZXJ2ZUFyb3VuZChjb2x1bW4gKyBpLCByb3cpXG4gICAgICAgICAgICAgICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIGksIHJvdyArIDEpXG4gICAgICAgICAgICAgICAgICAgIHNldExvY2F0aW9uKGNvbHVtbiArIGksIHJvdyAtIDEpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFkZE9mZkxpbWl0QXJlYUZvckhvcml6b250YWxseVBvc2l0aW9uZWRTaGlwKFxuICAgICAgICAgICAgICAgICAgICBjb2x1bW4sXG4gICAgICAgICAgICAgICAgICAgIHJvdyxcbiAgICAgICAgICAgICAgICAgICAgc2hpcExlbmd0aFxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgICAgICAgY29uc3QgYXZhaWxhYmxlU3BhY2VzID0gKCkgPT57XG5cbiAgICAgICAgY29uc3QgZmxhdHRlbmVkR2FtZUJvYXJkID0gWy4uLmdhbWVCb2FyZC5mbGF0KCldXG5cbiAgICAgICAgICAgIGZsYXR0ZW5lZEdhbWVCb2FyZC5mb3JFYWNoKChlbGVtZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYoZWxlbWVudC5oYXNCZWVuSGl0ID09PSB0cnVlKXtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hdmFpbGFiaWxpdHkgPSBmYWxzZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmF2YWlsYWJpbGl0eSA9dHJ1ZSAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgcmV0dXJuIGZsYXR0ZW5lZEdhbWVCb2FyZFxuXG4gICAgICAgIH1cbiAgICBjb25zdCBtYWtlUmFuZG9tQ29vcmRpbmF0ZXMgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHJhbmRvbURpcmVjdGlvbiA9XG4gICAgICAgICAgICBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKSA9PT0gMCA/ICd2ZXJ0aWNhbCcgOiAnaG9yaXpvbnRhbCdcbiAgICAgICAgY29uc3QgcmFuZG9tTG9jYXRpb24gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDApXG4gICAgICAgIGNvbnN0IGZsYXR0ZW5lZEdhbWVCb2FyZCA9IGF2YWlsYWJsZVNwYWNlcygpXG5cbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSBmbGF0dGVuZWRHYW1lQm9hcmRbcmFuZG9tTG9jYXRpb25dXG5cbiAgICAgICAgaWYobG9jYXRpb24uYXZhaWxhYmlsaXR5ID09PSBmYWxzZSl7XG4gICAgICAgICAgICByZXR1cm4gbWFrZVJhbmRvbUNvb3JkaW5hdGVzKClcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGVsZW1lbnRDb2x1bW4gPSBsb2NhdGlvbi5jb2x1bW5cbiAgICAgICAgY29uc3QgZWxlbWVudFJvdyA9IGxvY2F0aW9uLnJvd1xuXG5cbiAgICAgICAgcmV0dXJuIHsgZWxlbWVudENvbHVtbiwgZWxlbWVudFJvdywgcmFuZG9tRGlyZWN0aW9uIH1cbiAgICB9XG4gICAgICBsZXQgcmFuZG9tUG9zID0gKCkgPT4ge1xuICAgIGxldCBwb3MxID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgIGxldCBwb3MyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApO1xuICAgIHJldHVybiBbcG9zMSwgcG9zMl07XG4gIH07XG4gIC8vIGNyZWF0ZXMgYSBzaGlwIHdpdGggcmFuZG9tIHBvcyBhbmQgb3JpZW50YXRpb25cbiAgbGV0IHJhbmRvbVNoaXAgPSAobGVuZ3RoKSA9PiB7XG4gICAgbGV0IHBvczEgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgbGV0IHBvczIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgbGV0IGRpciA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSk7XG5cbiAgICBpZiAoZGlyID09PSAwKSB7XG4gICAgICBkaXIgPSBcImhvcml6b250YWxcIjtcbiAgICAgIGlmIChwbGFjZVNoaXAocG9zMSwgcG9zMiwgZGlyLCBjcmVhdGVTaGlwKGxlbmd0aCkpID09IGZhbHNlKSByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgaWYgKGRpciA9PT0gMSkge1xuICAgICAgZGlyID0gXCJ2ZXJ0aWNhbFwiO1xuICAgICAgaWYgKHBsYWNlU2hpcChwb3MxLCBwb3MyLCBkaXIsIGNyZWF0ZVNoaXAobGVuZ3RoKSkgPT0gZmFsc2UpIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG4gIC8vY3JlYXRlcyBhIHJhbmRvbSBmbGVldCBvZiA4IHNoaXBzXG4gIGxldCByYW5kb21GbGVldCA9ICgpID0+IHtcbiAgICAvLyBjcmVhdGUgMiBzaGlwcyBvZiBsZW5ndGggMVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjsgKSB7XG4gICAgICBpZiAocmFuZG9tU2hpcCgxKSA9PSBmYWxzZSkgY29udGludWU7XG4gICAgICBpKys7XG4gICAgfVxuICAgIC8vIGNyZWF0ZSAyIHNoaXBzIG9mIGxlbmd0aCAyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyOyApIHtcbiAgICAgIGlmIChyYW5kb21TaGlwKDIpID09IGZhbHNlKSBjb250aW51ZTtcbiAgICAgIGkrKztcbiAgICB9XG4gICAgLy8gY3JlYXRlIDIgc2hpcHMgb2YgbGVuZ3RoIDNcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDI7ICkge1xuICAgICAgaWYgKHJhbmRvbVNoaXAoMykgPT0gZmFsc2UpIGNvbnRpbnVlO1xuICAgICAgaSsrO1xuICAgIH1cbiAgICAvLyBjcmVhdGUgMSBzaGlwIG9mIGxlbmd0aCA0XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyOyApIHtcbiAgICAgIGlmIChyYW5kb21TaGlwKDQpID09IGZhbHNlKSBjb250aW51ZTtcbiAgICAgIGkrKztcbiAgICB9XG4gICAgaXNTdGFydEFsbG93ZWQgPSB0cnVlXG4gIH07XG5cbiAgICBjb25zdCByYW5kb21seVBsYWNlU2hpcHMgPSAoKSA9PiB7XG5cbiAgICBnYW1lQm9hcmQuY2xlYXJCb2FyZCgpXG4gICAgY2xlYXJCb2FyZERPTSgpXG5cbiAgICBjb25zdCByYW5kb21Qb3NzaWJpbGl0eSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpXG4gICAgc3dpdGNoKHJhbmRvbVBvc3NpYmlsaXR5KXtcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDksIDEsICd2ZXJ0aWNhbCcsIGNyZWF0ZVNoaXAoNSkpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoMCwgMywgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDMpKVxuICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDMsIDYsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgyKSlcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCg2LCA1LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMykpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoMywgOSwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDQpKVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCgwLCAyLCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoNSkpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoNCwgNSwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDMpKVxuICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDgsIDcsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgyKSlcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCg1LCA5LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMykpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoNiwgMywgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDQpKVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgMjpcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCg1LCAxLCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoNSkpXG4gICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoMywgMywgJ3ZlcnRpY2FsJywgY3JlYXRlU2hpcCgzKSlcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCgwLCAwLCAndmVydGljYWwnLCBjcmVhdGVTaGlwKDIpKVxuICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDYsIDUsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgzKSlcbiAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCg1LCA5LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoNCkpXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoMCwgMCwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDUpKVxuICAgICAgICAgICAgZ2FtZUJvYXJkLnBsYWNlU2hpcCgzLCA0LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoMykpXG4gICAgICAgICAgICBnYW1lQm9hcmQucGxhY2VTaGlwKDYsIDcsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgyKSlcbiAgICAgICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoOSwgMSwgJ3ZlcnRpY2FsJywgY3JlYXRlU2hpcCgzKSlcbiAgICAgICAgICAgIGdhbWVCb2FyZC5wbGFjZVNoaXAoNSwgOSwgJ2hvcml6b250YWwnLCBjcmVhdGVTaGlwKDQpKVxuICAgICAgICAgICAgYnJlYWs7XG5cbn1cbiAgICB9XG5cbiAgICBjb25zdCByZWNlaXZlQXR0YWNrID0gKGNvbHVtbiwgcm93KSA9PiB7XG4gICAgICAgIGdhbWVCb2FyZFtjb2x1bW5dW3Jvd10uaGFzQmVlbkhpdCA9IHRydWVcbiAgICB9XG5cbiAgICBjb25zdCBjaGVja0lmT2ZmTGltaXRab25lV2FzQ29ycmVjdGx5SW1wbGVtZW50ZWQgPSAoc2hpcExlbmd0aCkgPT5cbiAgICAgICAgZ2FtZUJvYXJkLmZsYXQoKS5maWx0ZXIoKGVsZW1lbnQpID0+IGVsZW1lbnQub2ZmTGltaXRzID09PSB0cnVlKVxuICAgICAgICAgICAgLmxlbmd0aCA9PT1cbiAgICAgICAgc2hpcExlbmd0aCArIDJcbiAgICAvLyBhZGRpbmcgc2hpcExlbmd0aCBwbHVzIHR3byBiZWNhdXNlIGZvciBldmVyeSBpbmNyZWFzZSBpbiB0aGUgc2l6ZSBvZiBzaGlwLCB0aGUgem9uZXMgY292ZXJlZCBpbmNyZWFzZSBieSAyIHVuaXRzXG5cbiAgICBjb25zdCBjbGVhckJvYXJkICA9ICgpID0+IHtcbiAgICAgICAgZ2FtZUJvYXJkID0gaW5pdGlhbGl6ZUJvYXJkKClcbiAgICB9XG4gICAgIFxuICAgIGNvbnN0IGNoZWNrSWZCb2FyZEhhc0JlZW5GdWxseVBvcHVsYXRlZCA9ICgpID0+IHtcblxuICAgICAgICBjb25zdCBmbGF0dGVuZWRHYW1lQm9hcmQgPSBnYW1lQm9hcmQuZmxhdCgpXG5cbiAgICAgICAgbGV0IG51bU9mU2hpcENlbGxzID0gMFxuXG4gICAgICAgIGZsYXR0ZW5lZEdhbWVCb2FyZC5mb3JFYWNoKChsb2NhdGlvbikgPT4ge1xuXG4gICAgICAgICAgICBpZihsb2NhdGlvbi5pc1NoaXApe1xuICAgICAgICAgICAgICAgIG51bU9mU2hpcENlbGxzKytcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICByZXR1cm4gbnVtT2ZTaGlwQ2VsbHMgPT09IDIwXG4gICAgfVxuXG4gICAgY29uc3QgZ2V0Qm9hcmQgPSAoKSA9PiBnYW1lQm9hcmRcblxuICAgIHJldHVybiB7XG4gICAgICAgIGNsZWFyQm9hcmQsXG4gICAgICAgIGNoZWNrSWZMb2NhdGlvbklzQVNoaXBPck9mZkxpbWl0cyxcbiAgICAgICAgY2hlY2tJZk9mZkxpbWl0Wm9uZVdhc0NvcnJlY3RseUltcGxlbWVudGVkLFxuICAgICAgICBnZXRMb2NhdGlvbixcbiAgICAgICAgcmVjZWl2ZUF0dGFjayxcbiAgICAgICAgY2hlY2tJZkFsbFNoaXBzSGF2ZVN1bmssXG4gICAgICAgIHBsYWNlU2hpcCxcbiAgICAgICAgcmFuZG9tbHlQbGFjZVNoaXBzLFxuICAgICAgICBtYWtlUmFuZG9tQ29vcmRpbmF0ZXMsXG4gICAgICAgIGNoZWNrSWZCb2FyZEhhc0JlZW5GdWxseVBvcHVsYXRlZCxcbiAgICAgICAgcmFuZG9tRmxlZXQsXG4gICAgICAgIGdhbWVCb2FyZCxcbiAgICAgICAgaXNTdGFydEFsbG93ZWQgOiB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpc1N0YXJ0QWxsb3dlZFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpc1N0YXJ0QWxsb3dlZCA9IHZhbHVlXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZUdhbWVCb2FyZCIsImNvbnN0IGNyZWF0ZVBsYXllciA9IChuYW1lID0gJ3BsYXllcicpID0+IHtcbiAgICBjb25zdCBnZXROYW1lID0gKCkgPT4gbmFtZVxuXG4gICAgY29uc3QgYXR0YWNrID0gKGNvbHVtbiwgcm93LCB7IGdldExvY2F0aW9uLCByZWNlaXZlQXR0YWNrIH0pID0+IHtcbiAgICAgICAgY29uc3QgbG9jYXRpb24gPSBnZXRMb2NhdGlvbihjb2x1bW4sIHJvdylcbiAgICAgICAgaWYgKGxvY2F0aW9uLmhhc0JlZW5IaXQgPT09IGZhbHNlIHx8IChsb2NhdGlvbi5pc1NoaXAgJiYgbG9jYXRpb24uZ2V0U3RhdHVzKCkuaW5jbHVkZXMoJ3VuaGl0JykgPT09IGZhbHNlKSkge1xuICAgICAgICAgICAgcmVjZWl2ZUF0dGFjayhjb2x1bW4sIHJvdylcbiAgICAgICAgICAgIGlmKGxvY2F0aW9uLmhpdCl7XG5cbiAgICAgICAgICAgICAgICBsb2NhdGlvbi5oaXQobG9jYXRpb24ucG9zaXRpb24pXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiWW91IGhpdCBhIHNoaXAhXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBcIkl0J3MgYSBoaXQhXCJcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAnWW91IGhhdmUgYWxyZWFkeSBoaXQgdGhpcyBzcG90ISdcbiAgICB9XG5cbiAgICAgIGxldCByYW5kb21Qb3MgPSAoKSA9PiB7XG4gICAgbGV0IHBvczEgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgbGV0IHBvczIgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gICAgcmV0dXJuIFtwb3MxLCBwb3MyXTtcbiAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIGdldE5hbWUsXG4gICAgICAgIGF0dGFjayxcbiAgICAgICAgcmFuZG9tUG9zLFxuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVQbGF5ZXJcbiIsImNvbnN0IGNyZWF0ZVNoaXAgPSAobGVuZ3RoLCBuYW1lID0gJ3NoaXAnKSA9PiB7XG5cbiAgICBsZXQgZG9tVGFyZ2V0cyA9IFtdXG5cbiAgICBjb25zdCBzdGF0dXMgPSBBcnJheShsZW5ndGgpLmZpbGwoJ3VuaGl0JylcblxuICAgIGNvbnN0IGdldExlbmd0aCA9ICgpID0+IHN0YXR1cy5sZW5ndGhcblxuICAgIGNvbnN0IGdldFN0YXR1cyA9ICgpID0+IHN0YXR1c1xuXG4gICAgY29uc3QgaGl0ID0gKHBvc2l0aW9uKSA9PiB7XG4gICAgICAgIGlmIChwb3NpdGlvbiA8IGxlbmd0aCkge1xuICAgICAgICAgICAgc3RhdHVzW3Bvc2l0aW9uXSA9ICdoaXQnXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBnZXROYW1lID0gKCkgPT4gIG5hbWVcblxuICAgIGNvbnN0IGlzU3VuayA9ICgpID0+IHN0YXR1cy5ldmVyeSgocG9zaXRpb24pID0+IHBvc2l0aW9uID09PSAnaGl0JylcblxuICAgIHJldHVybiB7XG4gICAgICAgIGdldE5hbWUsXG4gICAgICAgIGdldExlbmd0aCxcbiAgICAgICAgaXNTdW5rLFxuICAgICAgICBoaXQsXG4gICAgICAgIGdldFN0YXR1cyxcbiAgICAgICAgZG9tVGFyZ2V0cyxcbiAgICAgICAgaGFzQmVlbkhpdDogZmFsc2UsXG4gICAgICAgIG9mZkxpbWl0czogdHJ1ZSxcbiAgICAgICAgaXNTaGlwOiB0cnVlLFxuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVTaGlwXG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbl9fd2VicGFja19yZXF1aXJlX18ubiA9IChtb2R1bGUpID0+IHtcblx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG5cdFx0KCkgPT4gKG1vZHVsZVsnZGVmYXVsdCddKSA6XG5cdFx0KCkgPT4gKG1vZHVsZSk7XG5cdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsIHsgYTogZ2V0dGVyIH0pO1xuXHRyZXR1cm4gZ2V0dGVyO1xufTsiLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLyogZXNsaW50LWRpc2FibGUgbm8tZWxzZS1yZXR1cm4gKi9cbmltcG9ydCB7cmVuZGVyQXR0YWNrUDIgfSBmcm9tICcuL2RvbSdcblxubGV0IHdhc0hpdCA9IGZhbHNlO1xubGV0IHN0YXR1cyA9IGZhbHNlO1xubGV0IGxhc3RIaXRQb3MgPSBbXTtcbmxldCBmaXJzdEhpdFBvcyA9IFtdO1xubGV0IHNlY29uZEhpdFBvcyA9IFtdO1xubGV0IHN1cnJvdW5kaW5nUG9zID0gW107XG5sZXQgYXR0YWNrRGlyZWN0aW9uO1xuXG5mdW5jdGlvbiBzZXRXYXNIaXQodmFsdWUsIHN0YXQsIHBvczEsIHBvczIpIHtcbiAgd2FzSGl0ID0gdmFsdWU7XG4gIGlmIChzdGF0ICE9PSB1bmRlZmluZWQpIHN0YXR1cyA9IHN0YXQ7XG4gIGlmIChwb3MxICE9PSB1bmRlZmluZWQpIGxhc3RIaXRQb3MgPSBbcG9zMSwgcG9zMl07XG4gIGlmIChmaXJzdEhpdFBvcy5sZW5ndGggPT0gMCAmJiBwb3MxICE9PSB1bmRlZmluZWQpIGZpcnN0SGl0UG9zID0gW3BvczEsIHBvczJdO1xuICBlbHNlIGlmIChcbiAgICBmaXJzdEhpdFBvcy5sZW5ndGggIT09IDAgJiZcbiAgICBzZWNvbmRIaXRQb3MubGVuZ3RoID09IDAgJiZcbiAgICBwb3MxICE9PSB1bmRlZmluZWRcbiAgKVxuICAgIHNlY29uZEhpdFBvcyA9IFtwb3MxLCBwb3MyXTtcbn1cbmZ1bmN0aW9uIGdldFdhc0hpdCgpIHtcbiAgcmV0dXJuIFt3YXNIaXQsIGxhc3RIaXRQb3MsIHN0YXR1c107XG59XG5cbmZ1bmN0aW9uIHJlZ2lzdGVyU3Vycm91bmRpbmdQb3MocG9zMSwgcG9zMikge1xuICBzdXJyb3VuZGluZ1BvcyA9IFtdO1xuICBpZiAocG9zMiAhPT0gMCkgc3Vycm91bmRpbmdQb3MucHVzaChbcG9zMSwgcG9zMiAtIDFdKTtcbiAgaWYgKHBvczIgIT09IDkpIHN1cnJvdW5kaW5nUG9zLnB1c2goW3BvczEsIHBvczIgKyAxXSk7XG4gIGlmIChwb3MxICE9PSAwKSBzdXJyb3VuZGluZ1Bvcy5wdXNoKFtwb3MxIC0gMSwgcG9zMl0pO1xuICBpZiAocG9zMSAhPT0gOSkgc3Vycm91bmRpbmdQb3MucHVzaChbcG9zMSArIDEsIHBvczJdKTtcbiAgcmV0dXJuIHN1cnJvdW5kaW5nUG9zO1xufVxuXG5mdW5jdGlvbiBhaVBsYXkocmVwZWF0LCBwMSwgcDIsIGlzU3VuaywgcGxheWVyQm9hcmQsIGVuZW15Qm9hcmQpIHtcbiAgbGV0IHBvczsgbGV0IHBvczE7IGxldCBwb3MyO1xuICBpZiAoaXNTdW5rID09PSB0cnVlKSB7XG4gICAgbGFzdEhpdFBvcyA9IFtdO1xuICAgIGZpcnN0SGl0UG9zID0gW107XG4gICAgc2Vjb25kSGl0UG9zID0gW107XG4gICAgc3Vycm91bmRpbmdQb3MgPSBbXTtcbiAgICB3YXNIaXQgPSBmYWxzZTtcbiAgICBzdGF0dXMgPSBmYWxzZTtcbiAgICBhdHRhY2tEaXJlY3Rpb24gPSBcIlwiO1xuICB9XG4gIGlmICghc3RhdHVzICYmICF3YXNIaXQpIHtcbiAgICBwb3MgPSBwMS5yYW5kb21Qb3MoKTtcblxuICAgIHJldHVybiByZW5kZXJBdHRhY2tQMihwMSwgcDIsIHBvc1swXSwgcG9zWzFdLCBwbGF5ZXJCb2FyZCwgZW5lbXlCb2FyZCk7XG4gIH0gZWxzZSBpZiAoc2Vjb25kSGl0UG9zLmxlbmd0aCAhPT0gMCAmJiB3YXNIaXQgJiYgIXJlcGVhdCkge1xuICAgIGxldCBuZXdQb3M7XG4gICAgaWYgKGZpcnN0SGl0UG9zWzBdID09IHNlY29uZEhpdFBvc1swXSAtIDEpIG5ld1BvcyA9IGF0dGFja1Rvd2FyZHMoXCJkb3duXCIpO1xuICAgIGlmIChmaXJzdEhpdFBvc1swXSA9PSBzZWNvbmRIaXRQb3NbMF0gKyAxKSBuZXdQb3MgPSBhdHRhY2tUb3dhcmRzKFwidXBcIik7XG4gICAgaWYgKGZpcnN0SGl0UG9zWzFdID09IHNlY29uZEhpdFBvc1sxXSAtIDEpIG5ld1BvcyA9IGF0dGFja1Rvd2FyZHMoXCJyaWdodFwiKTtcbiAgICBpZiAoZmlyc3RIaXRQb3NbMV0gPT0gc2Vjb25kSGl0UG9zWzFdICsgMSkgbmV3UG9zID0gYXR0YWNrVG93YXJkcyhcImxlZnRcIik7XG4gICAgaWYgKG5ld1Bvc1swXSA+PSAwICYmIG5ld1Bvc1swXSA8PSA5ICYmIG5ld1Bvc1sxXSA+PSAwICYmIG5ld1Bvc1sxXSA8PSA5KVxuICAgICAgcmV0dXJuIHJlbmRlckF0dGFja1AyKHAxLCBwMiwgbmV3UG9zWzBdLCBuZXdQb3NbMV0sIHBsYXllckJvYXJkLCBlbmVteUJvYXJkKTtcbiAgfSBlbHNlIGlmIChzZWNvbmRIaXRQb3MubGVuZ3RoICE9PSAwICYmIHN0YXR1cyAmJiAhd2FzSGl0KSB7XG4gICAgbGFzdEhpdFBvcyA9IGZpcnN0SGl0UG9zO1xuICAgIHNlY29uZEhpdFBvcyA9IFtdO1xuICAgIGxldCBuZXdQb3M7XG4gICAgaWYgKGF0dGFja0RpcmVjdGlvbiA9PT0gXCJ1cFwiKSBuZXdQb3MgPSBhdHRhY2tUb3dhcmRzKFwiZG93blwiKTtcbiAgICBpZiAoYXR0YWNrRGlyZWN0aW9uID09PSBcImRvd25cIikgbmV3UG9zID0gYXR0YWNrVG93YXJkcyhcInVwXCIpO1xuICAgIGlmIChhdHRhY2tEaXJlY3Rpb24gPT09IFwicmlnaHRcIikgbmV3UG9zID0gYXR0YWNrVG93YXJkcyhcImxlZnRcIik7XG4gICAgaWYgKGF0dGFja0RpcmVjdGlvbiA9PT0gXCJsZWZ0XCIpIG5ld1BvcyA9IGF0dGFja1Rvd2FyZHMoXCJyaWdodFwiKTtcbiAgICBpZiAobmV3UG9zWzBdID49IDAgJiYgbmV3UG9zWzBdIDw9IDkgJiYgbmV3UG9zWzFdID49IDAgJiYgbmV3UG9zWzFdIDw9IDkpXG4gICAgICByZXR1cm4gcmVuZGVyQXR0YWNrUDIocDEsIHAyLCBuZXdQb3NbMF0sIG5ld1Bvc1sxXSwgcGxheWVyQm9hcmQsIGVuZW15Qm9hcmQpO1xuICB9IGVsc2UgaWYgKHN0YXR1cykge1xuICAgIGlmIChzdXJyb3VuZGluZ1Bvcy5sZW5ndGggPT0gMClcbiAgICAgIHJlZ2lzdGVyU3Vycm91bmRpbmdQb3MobGFzdEhpdFBvc1swXSwgbGFzdEhpdFBvc1sxXSk7XG4gICAgaWYgKHN1cnJvdW5kaW5nUG9zLmxlbmd0aCA9PSAwICYmIHN0YXR1cyA9PSB0cnVlKVxuICAgICAgcmVnaXN0ZXJTdXJyb3VuZGluZ1BvcyhmaXJzdEhpdFBvc1swXSwgZmlyc3RIaXRQb3NbMV0pO1xuICAgIGNvbnN0IG5ld1BvcyA9IHN1cnJvdW5kaW5nUG9zLnBvcCgpO1xuICAgIHJldHVybiByZW5kZXJBdHRhY2tQMihwMSwgcDIsIG5ld1Bvc1swXSwgbmV3UG9zWzFdLCBwbGF5ZXJCb2FyZCwgZW5lbXlCb2FyZCk7XG4gIH1cbn1cbi8vIGdldCBwb3Mgb2YgYXR0YWNrIGJhc2VkIG9uIGRpcmVjdGlvblxuZnVuY3Rpb24gYXR0YWNrVG93YXJkcyhkaXIpIHtcbiAgaWYgKGRpciA9PT0gXCJsZWZ0XCIpIHtcbiAgICBhdHRhY2tEaXJlY3Rpb24gPSBcImxlZnRcIjtcbiAgICByZXR1cm4gW2xhc3RIaXRQb3NbMF0sIGxhc3RIaXRQb3NbMV0gLSAxXTtcbiAgfVxuICBpZiAoZGlyID09PSBcInJpZ2h0XCIpIHtcbiAgICBhdHRhY2tEaXJlY3Rpb24gPSBcInJpZ2h0XCI7XG4gICAgcmV0dXJuIFtsYXN0SGl0UG9zWzBdLCBsYXN0SGl0UG9zWzFdICsgMV07XG4gIH1cbiAgaWYgKGRpciA9PT0gXCJkb3duXCIpIHtcbiAgICBhdHRhY2tEaXJlY3Rpb24gPSBcImRvd25cIjtcbiAgICByZXR1cm4gW2xhc3RIaXRQb3NbMF0gKyAxLCBsYXN0SGl0UG9zWzFdXTtcbiAgfVxuICBpZiAoZGlyID09PSBcInVwXCIpIHtcbiAgICBhdHRhY2tEaXJlY3Rpb24gPSBcInVwXCI7XG4gICAgcmV0dXJuIFtsYXN0SGl0UG9zWzBdIC0gMSwgbGFzdEhpdFBvc1sxXV07XG4gIH1cbn1cblxuZXhwb3J0IHsgYWlQbGF5LCBnZXRXYXNIaXQsIHNldFdhc0hpdCwgbGFzdEhpdFBvcywgc3Vycm91bmRpbmdQb3MgfTtcblxuIiwiaW1wb3J0IHtyZW5kZXJQbGF5ZXJTaGlwc30gZnJvbSAnLi9kb20nXG5pbXBvcnQgY3JlYXRlU2hpcCBmcm9tICcuL3NoaXAvc2hpcCdcblxubGV0IHRvdGFsQW1vdW50U2hpcHMgPSAwXG5cbmZ1bmN0aW9uIHNoaXBEcmFnKHNoaXBOYW1lLCBwbGF5ZXJCb2FyZCkge1xuICAgIGxldCBhbW91bnRMZWZ0ID0gMlxuXG4gICAgY29uc3Qgc2hpcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2hpcE5hbWUpXG4gICAgY29uc3QgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKVxuICAgIGNvbnN0IGNlbGxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBsYXllci1ib2FyZCA+IC5jZWxsJylcbiAgICBjb25zdCBjaGlsZCA9IHNoaXAuY2hpbGROb2Rlc1xuICAgIGxldCBkcmFnU2VsZWN0aW9uO1xuICAgIGxldCBvZmZzZXQ7XG4gICAgbGV0IGRpciA9IFwiaG9yaXpvbnRhbFwiXG5cbiAgICBpZihjaGlsZFswXSkgY2hpbGRbMF0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IChvZmZzZXQgPSAwKSlcbiAgICBpZihjaGlsZFsxXSkgY2hpbGRbMV0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsICgpID0+IChvZmZzZXQgPSAtMSkpXG4gICAgaWYoY2hpbGRbMl0pIGNoaWxkWzJdLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKSA9PiAob2Zmc2V0ID0gLTIpKVxuICAgIGlmKGNoaWxkWzNdKSBjaGlsZFszXS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgKCkgPT4gKG9mZnNldCA9IC0zKSlcblxuICAgIHNoaXAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiBjaGFuZ2VEaXIoZSkpXG5cbiAgICBzaGlwLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnc3RhcnRcIiwgKGUpID0+IHtcbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IDEwOyBpKyspe1xuICAgICAgICAgICAgcGxheWVyQm9hcmQuZ2FtZUJvYXJkW2ldLmZvckVhY2goKGUsIGopID0+IHtcbiAgICAgICAgICAgICAgICBpZihlLm9mZkxpbWl0cyB8fCBlLmlzU2hpcClcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAucGxheWVyLWJvYXJkID4gLmNlbGxbY29sdW1uPScke2UuY29sdW1ufSddW3Jvdz0nJHtlLnJvd30nXWApLmNsYXNzTGlzdC50b2dnbGUoXCJub3QtYXZhaWxhYmxlXCIpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfSlcblxuICAgIHNoaXAuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIChlLCBpKSA9PiB7XG5cbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5ub3QtYXZhaWxhYmxlXCIpLmZvckVhY2goKGUpID0+IGUuY2xhc3NMaXN0LnJlbW92ZShcIm5vdC1hdmFpbGFibGVcIikpXG5cbiAgICAgICAgaWYoZHJhZ1NlbGVjdGlvbiA9PT0gLTEpIHJldHVyblxuXG4gICAgICAgIGxldCBwb3MxO1xuICAgICAgICBsZXQgcG9zMjtcbiAgICAgICAgbGV0IHBvcyA9IGAkeyAgZHJhZ1NlbGVjdGlvbn1gXG5cbiAgICAgICAgaWYoZHJhZ1NlbGVjdGlvbiA8IDEwKSB7XG4gICAgICAgICAgICBwb3MxID0gMDtcbiAgICAgICAgICAgIHBvczIgPSBkcmFnU2VsZWN0aW9uXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwb3MgPSBwb3Muc3BsaXQoXCJcIilcbiAgICAgICAgICAgIHBvczEgPSBwb3NbMF0gKiAxXG4gICAgICAgICAgICBwb3MyID0gcG9zWzFdICogMVxuICAgICAgICB9XG5cbiAgICAgICAgaWYoZGlyID09PSBcImhvcml6b250YWxcIikgcG9zMiArPSBvZmZzZXRcbiAgICAgICAgaWYoZGlyID09PSBcInZlcnRpY2FsXCIpIHBvczEgKz0gb2Zmc2V0XG5cbiAgICAgICAgaWYocG9zMiA8IDApIHJldHVyblxuXG4gICAgICAgIGlmKHNoaXBOYW1lID09PSBcIi5zaGlwLTFcIil7XG4gICAgICAgICAgICBpZihwbGF5ZXJCb2FyZC5wbGFjZVNoaXAocG9zMiwgcG9zMSwgZGlyLCBjcmVhdGVTaGlwKDEpKSA9PT0gZmFsc2UpIHJldHVyblxuICAgICAgICAgICAgfVxuICAgICAgICBpZihzaGlwTmFtZSA9PT0gXCIuc2hpcC0yXCIpe1xuXG4gICAgICAgICAgICBpZihwbGF5ZXJCb2FyZC5wbGFjZVNoaXAocG9zMiwgcG9zMSwgZGlyLCBjcmVhdGVTaGlwKDIpKSA9PT0gZmFsc2UpIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIGlmKHNoaXBOYW1lID09PSBcIi5zaGlwLTNcIikge1xuXG4gICAgICAgICAgICBpZihwbGF5ZXJCb2FyZC5wbGFjZVNoaXAocG9zMiwgcG9zMSwgZGlyLCBjcmVhdGVTaGlwKDMpKSA9PT0gZmFsc2UpIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIGlmKHNoaXBOYW1lID09PSBcIi5zaGlwLTRcIikge1xuXG4gICAgICAgICAgICBpZihwbGF5ZXJCb2FyZC5wbGFjZVNoaXAocG9zMiwgcG9zMSwgZGlyLCBjcmVhdGVTaGlwKDQpKSA9PT0gZmFsc2UpIHJldHVyblxuICAgICAgICB9XG5cbiAgICAgICAgcmVuZGVyUGxheWVyU2hpcHMocGxheWVyQm9hcmQpXG5cbiAgICAgICAgYW1vdW50TGVmdCAtPSAxXG4gICAgICAgIHRvdGFsQW1vdW50U2hpcHMrK1xuXG4gICAgICAgIGlmKHRvdGFsQW1vdW50U2hpcHMgPT09IDgpIHBsYXllckJvYXJkLmlzU3RhcnRBbGxvd2VkLnNldCh0cnVlKVxuICAgICAgICBzaGlwLnBhcmVudE5vZGUuZmlyc3RDaGlsZC50ZXh0Q29udGVudCA9IGAke2Ftb3VudExlZnR9eGBcbiAgICAgICAgaWYoYW1vdW50TGVmdCA9PT0gMCkgc2hpcC5wYXJlbnROb2RlLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIiBcbiAgICAgICAgaWYocGxheWVyQm9hcmQuY2hlY2tJZkJvYXJkSGFzQmVlbkZ1bGx5UG9wdWxhdGVkKCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJib2R5ID4gbWFpbiA+IGRpdi5wbGF5ZXIgPiBkaXY6bnRoLWNoaWxkKDQpXCIpXG4gICAgICAgICAgICBjb250YWluZXIuc3R5bGUuZGlzcGxheSA9XCJub25lXCJcbiAgICAgICAgICAgIGNvbnN0IHJhbmRvbUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yYW5kb21pemUnKVxuICAgICAgICAgICAgcmFuZG9tQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIlxuICAgICAgICAgICAgcGxheWVyQm9hcmQuaXNTdGFydEFsbG93ZWQuc2V0KHRydWUpXG4gICAgICAgIH1cbiAgICB9KVxuXG4gICAgY2VsbHMuZm9yRWFjaCgoZSwgaSkgPT4ge1xuICAgICAgICBlLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCAoZSkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgICAgICBkcmFnU2VsZWN0aW9uID0gaSBcbiAgICAgICAgfSlcbiAgICB9KVxuXG4gICAgYm9keS5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2VudGVyXCIsICgpID0+IHtcbiAgICAgICAgZHJhZ1NlbGVjdGlvbiA9IC0xXG4gICAgfSlcblxuICAgIGZ1bmN0aW9uIGNoYW5nZURpcihlKSB7XG4gICAgICAgIGlmKGRpciA9PT0gXCJob3Jpem9udGFsXCIpIHtcbiAgICAgICAgICAgIGRpciA9IFwidmVydGljYWxcIlxuICAgICAgICAgICAgZS50YXJnZXQucGFyZW50Tm9kZS5jbGFzc0xpc3QudG9nZ2xlKFwicm90YXRlZFwiKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZGlyID0gXCJob3Jpem9udGFsXCI7XG4gICAgICAgICAgICBlLnRhcmdldC5wYXJlbnROb2RlLmNsYXNzTGlzdC50b2dnbGUoXCJyb3RhdGVkXCIpXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCB7c2hpcERyYWcsIHRvdGFsQW1vdW50U2hpcHN9IiwiaW1wb3J0IGNyZWF0ZUdhbWVCb2FyZCBmcm9tIFwiLi9nYW1lYm9hcmQvZ2FtZWJvYXJkXCJcbmltcG9ydCBjcmVhdGVTaGlwIGZyb20gXCIuL3NoaXAvc2hpcFwiXG5pbXBvcnQgeyBhaVBsYXksIGdldFdhc0hpdCwgc2V0V2FzSGl0LCBzdXJyb3VuZGluZ1BvcyB9IGZyb20gXCIuL2JvdFwiO1xuaW1wb3J0IHsgc2hpcERyYWcgfSBmcm9tIFwiLi9kcmFnLWFuZC1kcm9wXCI7XG5cbmNvbnN0IHJlbmRlckF0dGFja3MgPSAocGxheWVyLCBjb2x1bW4sIHJvdywgZW5lbXlCb2FyZCkgPT4ge1xuICAgIGNvbnN0IGNlbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICBgLiR7cGxheWVyfS1ib2FyZCA+IC5jZWxsW2NvbHVtbj0nJHtjb2x1bW59J11bcm93PScke3Jvd30nXWBcbiAgICApXG5cbiAgICBpZihlbmVteUJvYXJkLmdldExvY2F0aW9uKGNvbHVtbiwgcm93KT8uaXNTaGlwKXtcblxuICAgICAgICBlbmVteUJvYXJkLmdldExvY2F0aW9uKGNvbHVtbiwgcm93KS5kb21UYXJnZXRzLnB1c2goY2VsbClcbiAgICAgICAgaWYoZW5lbXlCb2FyZC5nZXRMb2NhdGlvbihjb2x1bW4sIHJvdykuaXNTdW5rKCkpe1xuXG4gICAgICAgICAgICBlbmVteUJvYXJkLmdldExvY2F0aW9uKGNvbHVtbiwgcm93KS5kb21UYXJnZXRzLmZvckVhY2goKGUpID0+IGUuY2xhc3NMaXN0LmFkZCgnc3VuaycpKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgbG9jYXRpb24gPSBlbmVteUJvYXJkLmdldExvY2F0aW9uKGNvbHVtbiwgcm93KVxuICAgIGlmIChsb2NhdGlvbi5pc1NoaXApIHtcbiAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdoaXQnKVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCgnbWlzcycpXG4gICAgfVxuXG59XG5cbmNvbnN0IGhhbmRsZUF0dGFjayA9IChjb2x1bW4sIHJvdywgZW5lbXlCb2FyZCwgcGxheWVyKSA9PlxuICAgIHBsYXllci5hdHRhY2soY29sdW1uLCByb3csIGVuZW15Qm9hcmQpXG5cbmNvbnN0IGF0dGFja0VuZW15Q2VsbCA9IGFzeW5jIChjb2x1bW4sIHJvdywgZW5lbXlCb2FyZCwgcGxheWVyQm9hcmQsIHBsYXllciwgZW5lbXkpID0+IHtcblxuXG4gICAgaGFuZGxlQXR0YWNrKGNvbHVtbiwgcm93LCBlbmVteUJvYXJkLCBwbGF5ZXIpXG4gICAgcmVuZGVyQXR0YWNrcygnZW5lbXknLCBjb2x1bW4sIHJvdywgZW5lbXlCb2FyZClcbiAgICBhd2FpdCBkZWxheSg3MDApXG4gICAgcmV0dXJuIGVuZW15Qm9hcmQuY2hlY2tJZkFsbFNoaXBzSGF2ZVN1bmsoKSA/IGNoZWNrSWZHYW1lT3ZlcihwbGF5ZXJCb2FyZCwgZW5lbXlCb2FyZCkgOiBhaVBsYXkoZmFsc2UsIHBsYXllciwgZW5lbXksIHVuZGVmaW5lZCwgcGxheWVyQm9hcmQsIGVuZW15Qm9hcmQpXG59XG5cbmNvbnN0IGlzU3BhY2VBcm91bmRIaXQgPSAoY29sdW1uLCByb3csIHBsYXllckJvYXJkKSA9PiB7XG5cbiAgICBjb25zdCBuZXh0Q29sdW1uID0gcGxheWVyQm9hcmQuZ2V0TG9jYXRpb24oY29sdW1uICsgMSwgcm93KVxuICAgIGNvbnN0IHByZXZpb3VzQ29sdW1uID0gcGxheWVyQm9hcmQuZ2V0TG9jYXRpb24oY29sdW1uIC0gMSwgcm93KVxuICAgIGNvbnN0IG5leHRSb3cgPSBwbGF5ZXJCb2FyZC5nZXRMb2NhdGlvbihjb2x1bW4sIHJvdyArIDEpXG4gICAgY29uc3QgcHJldmlvdXNSb3cgPSBwbGF5ZXJCb2FyZC5nZXRMb2NhdGlvbihjb2x1bW4sIHJvdyAtIDEpXG5cbiAgICBjb25zdCBzcGFjZXNIaXQgPSBbXVxuXG4gICAgaWYobmV4dENvbHVtbiAmJiAhbmV4dENvbHVtbi5oYXNCZWVuSGl0KXtcbiAgICAgICAgc3BhY2VzSGl0LnB1c2gobmV4dENvbHVtbilcbiAgICB9XG4gICAgaWYocHJldmlvdXNDb2x1bW4gJiYgIXByZXZpb3VzQ29sdW1uLmhhc0JlZW5IaXQpe1xuICAgICAgICBzcGFjZXNIaXQucHVzaChwcmV2aW91c0NvbHVtbilcbiAgICB9XG4gICAgaWYobmV4dFJvdyAmJiAhbmV4dFJvdy5oYXNCZWVuSGl0KXtcbiAgICAgICAgc3BhY2VzSGl0LnB1c2gobmV4dFJvdylcbiAgICB9XG4gICAgaWYocHJldmlvdXNSb3cgJiYgIXByZXZpb3VzUm93Lmhhc0JlZW5IaXQpe1xuICAgICAgICBzcGFjZXNIaXQucHVzaChwcmV2aW91c1JvdylcbiAgICB9XG5cbiAgICByZXR1cm4gc3BhY2VzSGl0XG5cbn1cblxuY29uc3QgcmFuZG9tRGlyZWN0aW9uQXR0YWNrID0gKGNvbHVtbiwgcm93LCBwbGF5ZXJCb2FyZCkgPT4ge1xuXG4gICAgY29uc3Qgc3BhY2VzSGl0ID0gaXNTcGFjZUFyb3VuZEhpdChjb2x1bW4sIHJvdywgcGxheWVyQm9hcmQpXG5cbiAgICBjb25zdCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHNwYWNlc0hpdC5sZW5ndGgpXG5cbiAgICBpZighc3BhY2VzSGl0W3JhbmRvbUluZGV4XSkgcmV0dXJuIHJhbmRvbURpcmVjdGlvbkF0dGFjayhjb2x1bW4sIHJvdyAsIHBsYXllckJvYXJkKVxuXG4gICAgcmV0dXJuIHNwYWNlc0hpdFtyYW5kb21JbmRleF1cbn1cblxuY29uc3QgaXNSYW5kb21Db2x1bW5HcmVhdGVyVGhhbkN1cnJlbnRDb2x1bW4gPSAoY29sdW1uLCByYW5kb21Db2x1bW4pID0+IFxuICAgIHJhbmRvbUNvbHVtbiA+IGNvbHVtblxuXG5jb25zdCBpc1JhbmRvbVJvd0dyZWF0ZXJUaGFuQ3VycmVudENvbHVtbiA9IChyb3csIHJhbmRvbVJvdykgPT4gXG4gICAgcmFuZG9tUm93ID4gcm93XG5cbmNvbnN0IGxpc3RPZlJhbmRvbUNvb3JkaW5hdGVzID0gKGNvbHVtbiwgcm93LCBwbGF5ZXJCb2FyZCkgPT4ge1xuXG4gICAgICAgIGNvbnN0IGxvY2F0aW9uUHJvdG90eXBlID0ge1xuICAgICAgICAgICAgbG9jYXRpb24oKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHBsYXllckJvYXJkLmdldExvY2F0aW9uKHRoaXMuY29sdW1uLCB0aGlzLnJvdylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRvcCA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShsb2NhdGlvblByb3RvdHlwZSksIHtcbiAgICAgICAgICAgIGNvbHVtbixcbiAgICAgICAgICAgIHJvdzogcm93IC0gMSxcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgYm90dG9tID0gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKGxvY2F0aW9uUHJvdG90eXBlKSwge1xuICAgICAgICAgICAgY29sdW1uLFxuICAgICAgICAgICAgcm93OiByb3cgKyAxLFxuICAgICAgICB9KVxuICAgICAgICBjb25zdCByaWdodCA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShsb2NhdGlvblByb3RvdHlwZSksIHtcbiAgICAgICAgICAgIGNvbHVtbjogY29sdW1uICsgMSxcbiAgICAgICAgICAgIHJvdyxcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgbGVmdCA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShsb2NhdGlvblByb3RvdHlwZSksIHtcbiAgICAgICAgICAgIGNvbHVtbjogY29sdW1uIC0gMSxcbiAgICAgICAgICAgIHJvdyxcbiAgICAgICAgfSlcbiAgICAgICAgY29uc3QgZGlyZWN0aW9ucyA9IFtdXG5cbiAgICAgICAgZGlyZWN0aW9ucy5wdXNoKHRvcClcbiAgICAgICAgZGlyZWN0aW9ucy5wdXNoKGJvdHRvbSlcbiAgICAgICAgZGlyZWN0aW9ucy5wdXNoKHJpZ2h0KVxuICAgICAgICBkaXJlY3Rpb25zLnB1c2gobGVmdClcblxuICAgICAgICByZXR1cm4gZGlyZWN0aW9uc1xufVxuXG4vLyByZW5kZXJzIGF0dGFjayBmb3IgcDIgKEFJKVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbmRlckF0dGFja1AyKHAxLCBwMiwgcG9zMSwgcG9zMiwgcGxheWVyQm9hcmQsIGVuZW15Qm9hcmQpIHtcbiAgbGV0IGlzU3VuayA9IGZhbHNlO1xuICBjb25zdCBlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgYC5wbGF5ZXItYm9hcmQgPiAuY2VsbFtjb2x1bW49JyR7cG9zMX0nXVtyb3c9JyR7cG9zMn0nXWBcbiAgICApXG5cbiAgY29uc3QgYXR0YWNrID0gcDIuYXR0YWNrKHBvczEsIHBvczIsIHBsYXllckJvYXJkKTtcblxuICBpZiAoYXR0YWNrID09PSBcIllvdSBoYXZlIGFscmVhZHkgaGl0IHRoaXMgc3BvdCFcIikge1xuICAgIGNvbnN0IHJlcGVhdCA9IHRydWU7XG4gICAgYWlQbGF5KHJlcGVhdCwgcDEsIHAyLCB1bmRlZmluZWQsIHBsYXllckJvYXJkLCBlbmVteUJvYXJkKTtcbiAgfVxuICBpZiAoYXR0YWNrID09PSBcIkl0J3MgYSBoaXQhXCIpIHtcbiAgICBzZXRXYXNIaXQoZmFsc2UpO1xuICAgIGUuY2xhc3NMaXN0LmFkZChcIm1pc3NcIik7XG4gIH1cbiAgaWYgKGF0dGFjayA9PT0gXCJZb3UgaGl0IGEgc2hpcCFcIikge1xuICAgIHNldFdhc0hpdCh0cnVlLCB0cnVlLCBwb3MxLCBwb3MyKTtcbiAgICBlLmNsYXNzTGlzdC5hZGQoXCJoaXRcIik7XG4gICAgcGxheWVyQm9hcmQuZ2V0TG9jYXRpb24ocG9zMSwgcG9zMikuZG9tVGFyZ2V0cy5wdXNoKGUpXG4gICAgLy8gaWYgc2hpcCBpcyBzdW5rLCBhZGQgXCJzdW5rXCIgY2xhc3NcbiAgICBpZiAocGxheWVyQm9hcmQuZ2V0TG9jYXRpb24ocG9zMSwgcG9zMikuaXNTdW5rKCkpIHtcbiAgICAgIHBsYXllckJvYXJkLmdldExvY2F0aW9uKHBvczEsIHBvczIpLmRvbVRhcmdldHMuZm9yRWFjaCgoZSkgPT5cbiAgICAgICAgZS5jbGFzc0xpc3QuYWRkKFwic3Vua1wiKVxuICAgICAgKTtcbiAgICAgIGlzU3VuayA9IHRydWU7XG4gICAgICBpZiAocGxheWVyQm9hcmQuY2hlY2tJZkFsbFNoaXBzSGF2ZVN1bmsoKSA9PT0gdHJ1ZSkgcmV0dXJuIGNoZWNrSWZHYW1lT3ZlcihwbGF5ZXJCb2FyZCwgZW5lbXlCb2FyZCk7XG4gICAgfVxuICAgIGF3YWl0IGRlbGF5KDEwMDApXG4gICAgcmV0dXJuIGFpUGxheShmYWxzZSwgcDEsIHAyLCBpc1N1bmssIHBsYXllckJvYXJkLCBlbmVteUJvYXJkKTtcbiAgfVxuXG4gIC8vIHAxLmlzVHVybihwMik7IC8vIGdpdmVzIHR1cm4gdG8gUDFcbn1cbi8vIGh0dHBzOi8vanNtYW5pZmVzdC5jb20vdGhlLXB1Ymxpc2gtc3Vic2NyaWJlLXBhdHRlcm4taW4tamF2YXNjcmlwdC9cblxuZXhwb3J0IGNvbnN0IHB1YlN1YiA9ICgpID0+IHtcbiAgICBjb25zdCBzdWJzY3JpYmVycyA9IHt9XG5cbiAgICBmdW5jdGlvbiBwdWJsaXNoKGV2ZW50TmFtZSwgZGF0YSkge1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoc3Vic2NyaWJlcnNbZXZlbnROYW1lXSkpIHtcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIHN1YnNjcmliZXJzW2V2ZW50TmFtZV0uZm9yRWFjaCgoY2FsbGJhY2spID0+IHtcbiAgICAgICAgICAgIGNhbGxiYWNrKGRhdGEpXG4gICAgICAgIH0pXG4gICAgfVxuICAgIGZ1bmN0aW9uIHN1YnNjcmliZShldmVudE5hbWUsIGNhbGxiYWNrKSB7XG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShzdWJzY3JpYmVbZXZlbnROYW1lXSkpIHtcbiAgICAgICAgICAgIHN1YnNjcmliZXJzW2V2ZW50TmFtZV0gPSBbXVxuICAgICAgICB9XG4gICAgICAgIHN1YnNjcmliZXJzW2V2ZW50TmFtZV0ucHVzaChjYWxsYmFjaylcbiAgICAgICAgY29uc3QgaW5kZXggPSBzdWJzY3JpYmVyc1tldmVudE5hbWVdLmxlbmd0aCAtIDFcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdW5zdWJzY3JpYmUoKSB7XG4gICAgICAgICAgICAgICAgc3Vic2NyaWJlcnNbZXZlbnROYW1lXS5zcGxpY2UoaW5kZXgsIDEpXG4gICAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHVibGlzaCxcbiAgICAgICAgc3Vic2NyaWJlLFxuICAgIH1cbn1cblxuLy8gY3JlYXRlcyBhIGRlbGF5IHRvIGJlIHVzZWQgaW4gYW4gYXN5bmMgZnVuY3Rpb25cbmZ1bmN0aW9uIGRlbGF5KGRlbGF5SW5Ncykge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHJlc29sdmUoMik7XG4gICAgfSwgZGVsYXlJbk1zKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBjb25zdCByZW5kZXJQbGF5ZXJTaGlwcyA9ICh7IGdldExvY2F0aW9uIH0pID0+IHtcbiAgICBjb25zdCBwbGF5ZXJCb2FyZEFyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdkaXYucGxheWVyLWJvYXJkJylcblxuICAgIGZvciAobGV0IGNvbHVtbiA9IDA7IGNvbHVtbiA8IDEwOyBjb2x1bW4gKz0gMSkge1xuICAgICAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCAxMDsgcm93ICs9IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBwbGF5ZXJCb2FyZEFyZWEucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICAgICBgLmNlbGw6bnRoLWNoaWxkKCR7cm93ICogMTAgKyBjb2x1bW4gKyAxfSlgXG4gICAgICAgICAgICApXG4gICAgICAgICAgICBjZWxsLnNldEF0dHJpYnV0ZSgnY29sdW1uJywgY29sdW1uKVxuICAgICAgICAgICAgY2VsbC5zZXRBdHRyaWJ1dGUoJ3JvdycsIHJvdylcbiAgICAgICAgICAgIGNvbnN0IGxvY2F0aW9uID0gZ2V0TG9jYXRpb24oY29sdW1uLCByb3cpXG4gICAgICAgICAgICBpZiAobG9jYXRpb24uaXNTaGlwKSB7XG4gICAgICAgICAgICAgICAgY2VsbC5jbGFzc0xpc3QuYWRkKCdzaGlwJylcbiAgICAgICAgICAgICAgICBjZWxsLnNldEF0dHJpYnV0ZSgnc2hpcC1uYW1lJywgbG9jYXRpb24uZ2V0TmFtZSgpKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5jb25zdCBjaGVja0lmR2FtZU92ZXIgPSAocGxheWVyQm9hcmQsIGVuZW15Qm9hcmQpID0+IHtcbiAgICBpZiAocGxheWVyQm9hcmQuY2hlY2tJZkFsbFNoaXBzSGF2ZVN1bmsoKSkge1xuICAgICAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbCcpXG4gICAgICAgIGNvbnN0IG1vZGFsV2lubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWNvbnRlbnQgPiBwJylcbiAgICAgICAgY29uc3QgcGxheUFnYWluQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICcubW9kYWwtY29udGVudCA+IGJ1dHRvbidcbiAgICAgICAgKVxuXG4gICAgICAgIG1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snXG4gICAgICAgIHBsYXlBZ2FpbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpXG4gICAgICAgIH0pXG5cbiAgICAgICAgbW9kYWxXaW5uZXIudGV4dENvbnRlbnQgPSAnWW91IGxvc2UhJ1xuICAgIH1cbiAgICBpZiAoZW5lbXlCb2FyZC5jaGVja0lmQWxsU2hpcHNIYXZlU3VuaygpKSB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsJylcbiAgICAgICAgY29uc3QgbW9kYWxXaW5uZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtY29udGVudCA+IHAnKVxuICAgICAgICBjb25zdCBwbGF5QWdhaW5CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgJy5tb2RhbC1jb250ZW50ID4gYnV0dG9uJ1xuICAgICAgICApXG5cbiAgICAgICAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdibG9jaydcbiAgICAgICAgbW9kYWxXaW5uZXIudGV4dENvbnRlbnQgPSAnWW91IHdpbiEnXG4gICAgICAgIHBsYXlBZ2FpbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpXG4gICAgICAgIH0pXG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRHJhZ0FuZERyb3BGbGVldChwbGF5ZXJCb2FyZCkge1xuICAgIHJlbmRlclNoaXBTZWxlY3QoMSwgMSlcbiAgICByZW5kZXJTaGlwU2VsZWN0KDIsIDIpXG4gICAgcmVuZGVyU2hpcFNlbGVjdCgzLCAzKVxuICAgIHJlbmRlclNoaXBTZWxlY3QoNCwgNClcblxuICAgIGZ1bmN0aW9uIHJlbmRlclNoaXBTZWxlY3QoaSwgbGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJib2R5ID4gbWFpbiA+IGRpdi5wbGF5ZXIgPiBkaXY6bnRoLWNoaWxkKDQpXCIpXG4gICAgICAgIGNvbnN0IHNoaXBDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgICAgICBzaGlwQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3NoaXAtY29udGFpbmVyJylcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHNoaXBDb250YWluZXIpXG5cbiAgICAgICAgY29uc3Qgc2hpcEluZm8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKVxuICAgICAgICBzaGlwSW5mby5jbGFzc0xpc3QuYWRkKGBpbmZvLSR7aX1gKVxuICAgICAgICBzaGlwSW5mby50ZXh0Q29udGVudCA9IFwiMnhcIlxuICAgICAgICBzaGlwQ29udGFpbmVyLmFwcGVuZENoaWxkKHNoaXBJbmZvKVxuXG4gICAgICAgIGNvbnN0IHNoaXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXG4gICAgICAgIHNoaXAuY2xhc3NMaXN0LmFkZChcInNoaXBcIilcbiAgICAgICAgc2hpcC5jbGFzc0xpc3QuYWRkKGBzaGlwLSR7aX1gKVxuICAgICAgICBzaGlwLnNldEF0dHJpYnV0ZShcImRyYWdnYWJsZVwiLCBcInRydWVcIilcbiAgICAgICAgc2hpcENvbnRhaW5lci5hcHBlbmRDaGlsZChzaGlwKVxuXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgY2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgICAgICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZChcImNlbGxcIilcbiAgICAgICAgICAgIHNoaXAuYXBwZW5kQ2hpbGQoY2VsbClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZvcihsZXQgaSA9IDE7IGkgPCA1OyBpKyspIHNoaXBEcmFnKGAuc2hpcC0ke2l9YCwgcGxheWVyQm9hcmQpXG59XG5cbmV4cG9ydCBjb25zdCBhZGRMaXN0ZW5lcnNUb0VuZW15Qm9hcmQgPSAoXG4gICAgcGxheWVyQm9hcmQsXG4gICAgZW5lbXlCb2FyZCxcbiAgICBwbGF5ZXIsXG4gICAgZW5lbXksXG4gICAgcHNcbikgPT4ge1xuICAgIGNvbnN0IGVuZW15Qm9hcmRBcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZGl2LmVuZW15LWJvYXJkJylcblxuICAgIGZvciAobGV0IGNvbHVtbiA9IDA7IGNvbHVtbiA8IDEwOyBjb2x1bW4gKz0gMSkge1xuICAgICAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCAxMDsgcm93ICs9IDEpIHtcbiAgICAgICAgICAgIC8vIENyZWRpdGluZyBmb3JtdWxhIHRvIGNhbGN1bGF0ZSBudGgtY2hpbGQgdXNpbmcgbmVzdGVkIGxvb3A6IGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzg4NzI2NjIvbWF0aC10by1kZXRlcm1pbmUtaXRlbS1pbmRleC1iYXNlZC1vbi1jb2wtcm93LXNlbGVjdGlvbi1pbi1ncmlkXG4gICAgICAgICAgICBjb25zdCBjZWxsID0gZW5lbXlCb2FyZEFyZWEucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICAgICBgLmNlbGw6bnRoLWNoaWxkKCR7cm93ICogMTAgKyBjb2x1bW4gKyAxfSlgXG4gICAgICAgICAgICApXG4gICAgICAgICAgICBjZWxsLnNldEF0dHJpYnV0ZSgnY29sdW1uJywgY29sdW1uKVxuICAgICAgICAgICAgY2VsbC5zZXRBdHRyaWJ1dGUoJ3JvdycsIHJvdylcblxuICAgICAgICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgICAgICAgICAgICdjbGljaycsXG4gICAgICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZihwbGF5ZXJCb2FyZC5pc1N0YXJ0QWxsb3dlZC5nZXQoKSA9PT0gZmFsc2UpIHJldHVyblxuICAgICAgICAgICAgICAgICAgICBwcy5wdWJsaXNoKCdjbGljaycsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNlbGwsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW4sXG4gICAgICAgICAgICAgICAgICAgICAgICByb3csXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJCb2FyZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZW15Qm9hcmQsXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbmVteSxcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHsgb25jZTogdHJ1ZSB9XG4gICAgICAgICAgICApXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBjb25zdCBjbGVhckJvYXJkRE9NID0gKCkgPT4ge1xuICAgIGNvbnN0IGNlbGxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBsYXllci1ib2FyZCA+IC5jZWxsJylcblxuICAgIGNlbGxzLmZvckVhY2goY2VsbCA9PiB7XG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LnJlbW92ZSgnc2hpcCcpXG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LnJlbW92ZSgnaGl0JylcbiAgICAgICAgY2VsbC5jbGFzc0xpc3QucmVtb3ZlKCdtaXNzJylcbiAgICB9KVxuXG59XG5cblxuXG5leHBvcnQgY29uc3QgYXR0YWNrID0gKHtcbiAgICBjZWxsLFxuICAgIGNvbHVtbixcbiAgICByb3csXG4gICAgcGxheWVyQm9hcmQsXG4gICAgZW5lbXlCb2FyZCxcbiAgICBwbGF5ZXIsXG4gICAgZW5lbXksXG59KSA9PiB7XG5cbiAgICAvLyBodW1hbiBwbGF5ZXIgYXR0YWNraW5nIGNvbXB1dGVyXG4gICAgYXR0YWNrRW5lbXlDZWxsKGNvbHVtbiwgcm93LCBlbmVteUJvYXJkLCBwbGF5ZXJCb2FyZCwgcGxheWVyLCBlbmVteSlcbiAgICAvLyBjb21wdXRlciBhdHRhY2tpbmcgaHVtYW5cbiAgICAvLyBjb25zdCB7IGVsZW1lbnRDb2x1bW4sIGVsZW1lbnRSb3cgfSA9IHBsYXllckJvYXJkLm1ha2VSYW5kb21Db29yZGluYXRlcygpXG4gICAgLy8gcmVuZGVyQXR0YWNrUDIocGxheWVyLCBlbmVteSwgZWxlbWVudENvbHVtbiwgZWxlbWVudFJvdywgcGxheWVyQm9hcmQsIGVuZW15Qm9hcmQpXG4gICAgLy8gYWlQbGF5KGZhbHNlLCBwbGF5ZXIsIGVuZW15LCB1bmRlZmluZWQsIHBsYXllckJvYXJkLCBlbmVteUJvYXJkKVxufVxuIiwiaW1wb3J0IHsgYWRkTGlzdGVuZXJzVG9FbmVteUJvYXJkLCByZW5kZXJQbGF5ZXJTaGlwcyxwdWJTdWIsIHJhbmRvbWl6ZUxpc3RlbmVyLCBhdHRhY2ssIGNyZWF0ZURyYWdBbmREcm9wRmxlZXQsIGNsZWFyQm9hcmRET019IGZyb20gJy4vZG9tJ1xuXG5pbXBvcnQgY3JlYXRlR2FtZUJvYXJkIGZyb20gJy4vZ2FtZWJvYXJkL2dhbWVib2FyZCdcbmltcG9ydCBjcmVhdGVTaGlwIGZyb20gJy4vc2hpcC9zaGlwJ1xuaW1wb3J0IGNyZWF0ZVBsYXllciBmcm9tICcuL3BsYXllci9wbGF5ZXInXG5cbmNvbnN0IHBsYXllckJvYXJkID0gY3JlYXRlR2FtZUJvYXJkKClcbmNvbnN0IGVuZW15Qm9hcmQgPSBjcmVhdGVHYW1lQm9hcmQoKVxuY29uc3QgcGxheWVyID0gY3JlYXRlUGxheWVyKClcbmNvbnN0IGNvbXB1dGVyID0gY3JlYXRlUGxheWVyKClcblxuY29uc3QgcmFuZG9taXplQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYnV0dG9uLnJhbmRvbWl6ZScpXG5cbnJhbmRvbWl6ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblxuICAgIHBsYXllckJvYXJkLnJhbmRvbWx5UGxhY2VTaGlwcygpXG4gICAgY2xlYXJCb2FyZERPTSgpXG59KVxuXG5jb25zdCByZXNldEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbi5yZXNldCcpXG5cbnJlc2V0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuXG4gICAgbG9jYXRpb24ucmVsb2FkKClcbn0pXG5cbmNyZWF0ZURyYWdBbmREcm9wRmxlZXQocGxheWVyQm9hcmQpXG5cbmVuZW15Qm9hcmQucGxhY2VTaGlwKDAsIDAsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCg1KSlcbmVuZW15Qm9hcmQucGxhY2VTaGlwKDMsIDQsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgzKSlcbmVuZW15Qm9hcmQucGxhY2VTaGlwKDYsIDcsICdob3Jpem9udGFsJywgY3JlYXRlU2hpcCgyKSlcbmVuZW15Qm9hcmQucGxhY2VTaGlwKDksIDEsICd2ZXJ0aWNhbCcsIGNyZWF0ZVNoaXAoMykpXG5lbmVteUJvYXJkLnBsYWNlU2hpcCg1LCA5LCAnaG9yaXpvbnRhbCcsIGNyZWF0ZVNoaXAoNCkpXG5cbmNvbnN0IHBzID0gcHViU3ViKClcblxuYWRkTGlzdGVuZXJzVG9FbmVteUJvYXJkKHBsYXllckJvYXJkLCBlbmVteUJvYXJkLCBwbGF5ZXIsIGNvbXB1dGVyLCBwcylcblxucHMuc3Vic2NyaWJlKCdjbGljaycsIGF0dGFjaylcblxucmVuZGVyUGxheWVyU2hpcHMocGxheWVyQm9hcmQpIl0sIm5hbWVzIjpbImNyZWF0ZVNoaXAiLCJtb2R1bGUiLCJleHBvcnRzIiwiZW1wdHlDZWxsIiwiaGFzQmVlbkhpdCIsImlzU2hpcCIsIm9mZkxpbWl0cyIsImlzU3RhcnRBbGxvd2VkIiwiaW5pdGlhbGl6ZUJvYXJkIiwiZ2FtZUJvYXJkIiwiQXJyYXkiLCJmaWxsIiwibWFwIiwiY29sdW1uIiwicm93IiwiZ2V0TG9jYXRpb24iLCJzZXRMb2NhdGlvbiIsInNoaXAiLCJPYmplY3QiLCJhc3NpZ24iLCJjcmVhdGVPZmZMaW1pdExvY2F0aW9uIiwidW5kZWZpbmVkIiwibG9jYXRpb24iLCJhZGRPZmZMaW1pdEFyZWFGb3JTaGlwcyIsImNoZWNrSWZMb2NhdGlvbklzQVNoaXBPck9mZkxpbWl0cyIsImRpcmVjdGlvbiIsInNoaXBMZW5ndGgiLCJpIiwicGxhY2VTaGlwIiwiZ2V0TGVuZ3RoIiwibGVuZ3RoIiwiY2hlY2tJZlJvd0Nvb3JkaW5hdGVJc1ZhbGlkIiwicG9zaXRpb24iLCJjb25zb2xlIiwibG9nIiwiYWRkT2ZmTGltaXRBcmVhRm9yVmVydGljYWxseVBvc2l0aW9uZWRTaGlwIiwiY2hlY2tJZkNvbHVtbkNvb3JkaW5hdGVJc1ZhbGlkIiwiYWRkT2ZmTGltaXRBcmVhRm9ySG9yaXpvbnRhbGx5UG9zaXRpb25lZFNoaXAiLCJtYWtlUmFuZG9tQ29vcmRpbmF0ZXMiLCJyYW5kb21EaXJlY3Rpb24iLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJyYW5kb21Mb2NhdGlvbiIsImZsYXR0ZW5lZEdhbWVCb2FyZCIsImZsYXQiLCJmb3JFYWNoIiwiZWxlbWVudCIsImF2YWlsYWJpbGl0eSIsImF2YWlsYWJsZVNwYWNlcyIsImVsZW1lbnRDb2x1bW4iLCJlbGVtZW50Um93IiwicmFuZG9tU2hpcCIsInBvczEiLCJwb3MyIiwiZGlyIiwicm91bmQiLCJjbGVhckJvYXJkIiwiY2hlY2tJZk9mZkxpbWl0Wm9uZVdhc0NvcnJlY3RseUltcGxlbWVudGVkIiwiZmlsdGVyIiwicmVjZWl2ZUF0dGFjayIsImNoZWNrSWZBbGxTaGlwc0hhdmVTdW5rIiwiaGF2ZUFsbFNoaXBzU3VuayIsImoiLCJpc1N1bmsiLCJyYW5kb21seVBsYWNlU2hpcHMiLCJjbGVhckJvYXJkRE9NIiwiY2hlY2tJZkJvYXJkSGFzQmVlbkZ1bGx5UG9wdWxhdGVkIiwibnVtT2ZTaGlwQ2VsbHMiLCJyYW5kb21GbGVldCIsImdldCIsInNldCIsInZhbHVlIiwibmFtZSIsImdldE5hbWUiLCJhdHRhY2siLCJnZXRTdGF0dXMiLCJpbmNsdWRlcyIsImhpdCIsInJhbmRvbVBvcyIsInN0YXR1cyIsImV2ZXJ5IiwiZG9tVGFyZ2V0cyIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJuIiwiZ2V0dGVyIiwiX19lc01vZHVsZSIsImQiLCJhIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiYXR0YWNrRGlyZWN0aW9uIiwid2FzSGl0IiwibGFzdEhpdFBvcyIsImZpcnN0SGl0UG9zIiwic2Vjb25kSGl0UG9zIiwic3Vycm91bmRpbmdQb3MiLCJzZXRXYXNIaXQiLCJzdGF0IiwicmVnaXN0ZXJTdXJyb3VuZGluZ1BvcyIsInB1c2giLCJhaVBsYXkiLCJyZXBlYXQiLCJwMSIsInAyIiwicGxheWVyQm9hcmQiLCJlbmVteUJvYXJkIiwicG9zIiwicmVuZGVyQXR0YWNrUDIiLCJuZXdQb3MiLCJhdHRhY2tUb3dhcmRzIiwicG9wIiwidG90YWxBbW91bnRTaGlwcyIsInNoaXBEcmFnIiwic2hpcE5hbWUiLCJhbW91bnRMZWZ0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYm9keSIsImNlbGxzIiwicXVlcnlTZWxlY3RvckFsbCIsImNoaWxkIiwiY2hpbGROb2RlcyIsImRyYWdTZWxlY3Rpb24iLCJvZmZzZXQiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInRhcmdldCIsInBhcmVudE5vZGUiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJjaGFuZ2VEaXIiLCJyZW1vdmUiLCJzcGxpdCIsInJlbmRlclBsYXllclNoaXBzIiwiZmlyc3RDaGlsZCIsInRleHRDb250ZW50Iiwic3R5bGUiLCJkaXNwbGF5IiwicHJldmVudERlZmF1bHQiLCJhc3luYyIsImFkZCIsImNoZWNrSWZHYW1lT3ZlciIsImRlbGF5IiwiZGVsYXlJbk1zIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwicGxheWVyQm9hcmRBcmVhIiwiY2VsbCIsInNldEF0dHJpYnV0ZSIsIm1vZGFsIiwibW9kYWxXaW5uZXIiLCJwbGF5QWdhaW5CdXR0b24iLCJyZWxvYWQiLCJjb21wdXRlciIsInJlbmRlclNoaXBTZWxlY3QiLCJjb250YWluZXIiLCJzaGlwQ29udGFpbmVyIiwiY3JlYXRlRWxlbWVudCIsImFwcGVuZENoaWxkIiwic2hpcEluZm8iLCJjcmVhdGVEcmFnQW5kRHJvcEZsZWV0IiwicHMiLCJzdWJzY3JpYmVycyIsInB1Ymxpc2giLCJldmVudE5hbWUiLCJkYXRhIiwiaXNBcnJheSIsImNhbGxiYWNrIiwic3Vic2NyaWJlIiwiaW5kZXgiLCJ1bnN1YnNjcmliZSIsInNwbGljZSIsInB1YlN1YiIsInBsYXllciIsImVuZW15IiwiZW5lbXlCb2FyZEFyZWEiLCJvbmNlIiwiYWRkTGlzdGVuZXJzVG9FbmVteUJvYXJkIiwiaGFuZGxlQXR0YWNrIiwicmVuZGVyQXR0YWNrcyIsImF0dGFja0VuZW15Q2VsbCJdLCJzb3VyY2VSb290IjoiIn0=